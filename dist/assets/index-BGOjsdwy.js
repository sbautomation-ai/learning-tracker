var X2=Object.defineProperty;var q2=(t,e,r)=>e in t?X2(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var ke=(t,e,r)=>q2(t,typeof e!="symbol"?e+"":e,r);function J2(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function Q2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Z2(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var q1={exports:{}},vc={},J1={exports:{}},Ee={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yo=Symbol.for("react.element"),eS=Symbol.for("react.portal"),tS=Symbol.for("react.fragment"),rS=Symbol.for("react.strict_mode"),nS=Symbol.for("react.profiler"),iS=Symbol.for("react.provider"),sS=Symbol.for("react.context"),aS=Symbol.for("react.forward_ref"),oS=Symbol.for("react.suspense"),lS=Symbol.for("react.memo"),uS=Symbol.for("react.lazy"),gp=Symbol.iterator;function cS(t){return t===null||typeof t!="object"?null:(t=gp&&t[gp]||t["@@iterator"],typeof t=="function"?t:null)}var Q1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Z1=Object.assign,ev={};function ua(t,e,r){this.props=t,this.context=e,this.refs=ev,this.updater=r||Q1}ua.prototype.isReactComponent={};ua.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ua.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function tv(){}tv.prototype=ua.prototype;function yd(t,e,r){this.props=t,this.context=e,this.refs=ev,this.updater=r||Q1}var wd=yd.prototype=new tv;wd.constructor=yd;Z1(wd,ua.prototype);wd.isPureReactComponent=!0;var mp=Array.isArray,rv=Object.prototype.hasOwnProperty,Sd={current:null},nv={key:!0,ref:!0,__self:!0,__source:!0};function iv(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)rv.call(e,n)&&!nv.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Yo,type:t,key:s,ref:a,props:i,_owner:Sd.current}}function hS(t,e){return{$$typeof:Yo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ed(t){return typeof t=="object"&&t!==null&&t.$$typeof===Yo}function fS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var vp=/\/+/g;function Qc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?fS(""+t.key):e.toString(36)}function ru(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Yo:case eS:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+Qc(a,0):n,mp(i)?(r="",t!=null&&(r=t.replace(vp,"$&/")+"/"),ru(i,e,r,"",function(u){return u})):i!=null&&(Ed(i)&&(i=hS(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(vp,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",mp(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+Qc(s,o);a+=ru(s,e,r,l,i)}else if(l=cS(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+Qc(s,o++),a+=ru(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function ul(t,e,r){if(t==null)return t;var n=[],i=0;return ru(t,n,"","",function(s){return e.call(r,s,i++)}),n}function dS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Xt={current:null},nu={transition:null},pS={ReactCurrentDispatcher:Xt,ReactCurrentBatchConfig:nu,ReactCurrentOwner:Sd};function sv(){throw Error("act(...) is not supported in production builds of React.")}Ee.Children={map:ul,forEach:function(t,e,r){ul(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return ul(t,function(){e++}),e},toArray:function(t){return ul(t,function(e){return e})||[]},only:function(t){if(!Ed(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ee.Component=ua;Ee.Fragment=tS;Ee.Profiler=nS;Ee.PureComponent=yd;Ee.StrictMode=rS;Ee.Suspense=oS;Ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pS;Ee.act=sv;Ee.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Z1({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Sd.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)rv.call(e,l)&&!nv.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Yo,type:t.type,key:i,ref:s,props:n,_owner:a}};Ee.createContext=function(t){return t={$$typeof:sS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:iS,_context:t},t.Consumer=t};Ee.createElement=iv;Ee.createFactory=function(t){var e=iv.bind(null,t);return e.type=t,e};Ee.createRef=function(){return{current:null}};Ee.forwardRef=function(t){return{$$typeof:aS,render:t}};Ee.isValidElement=Ed;Ee.lazy=function(t){return{$$typeof:uS,_payload:{_status:-1,_result:t},_init:dS}};Ee.memo=function(t,e){return{$$typeof:lS,type:t,compare:e===void 0?null:e}};Ee.startTransition=function(t){var e=nu.transition;nu.transition={};try{t()}finally{nu.transition=e}};Ee.unstable_act=sv;Ee.useCallback=function(t,e){return Xt.current.useCallback(t,e)};Ee.useContext=function(t){return Xt.current.useContext(t)};Ee.useDebugValue=function(){};Ee.useDeferredValue=function(t){return Xt.current.useDeferredValue(t)};Ee.useEffect=function(t,e){return Xt.current.useEffect(t,e)};Ee.useId=function(){return Xt.current.useId()};Ee.useImperativeHandle=function(t,e,r){return Xt.current.useImperativeHandle(t,e,r)};Ee.useInsertionEffect=function(t,e){return Xt.current.useInsertionEffect(t,e)};Ee.useLayoutEffect=function(t,e){return Xt.current.useLayoutEffect(t,e)};Ee.useMemo=function(t,e){return Xt.current.useMemo(t,e)};Ee.useReducer=function(t,e,r){return Xt.current.useReducer(t,e,r)};Ee.useRef=function(t){return Xt.current.useRef(t)};Ee.useState=function(t){return Xt.current.useState(t)};Ee.useSyncExternalStore=function(t,e,r){return Xt.current.useSyncExternalStore(t,e,r)};Ee.useTransition=function(){return Xt.current.useTransition()};Ee.version="18.3.1";J1.exports=Ee;var lr=J1.exports;const Ue=Q2(lr);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gS=lr,mS=Symbol.for("react.element"),vS=Symbol.for("react.fragment"),xS=Object.prototype.hasOwnProperty,_S=gS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yS={key:!0,ref:!0,__self:!0,__source:!0};function av(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)xS.call(e,n)&&!yS.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:mS,type:t,key:s,ref:a,props:i,_owner:_S.current}}vc.Fragment=vS;vc.jsx=av;vc.jsxs=av;q1.exports=vc;var z=q1.exports,ef={},ov={exports:{}},_r={},lv={exports:{}},uv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Y,q){var he=Y.length;Y.push(q);e:for(;0<he;){var xe=he-1>>>1,C=Y[xe];if(0<i(C,q))Y[xe]=q,Y[he]=C,he=xe;else break e}}function r(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var q=Y[0],he=Y.pop();if(he!==q){Y[0]=he;e:for(var xe=0,C=Y.length,L=C>>>1;xe<L;){var I=2*(xe+1)-1,D=Y[I],G=I+1,le=Y[G];if(0>i(D,he))G<C&&0>i(le,D)?(Y[xe]=le,Y[G]=he,xe=G):(Y[xe]=D,Y[I]=he,xe=I);else if(G<C&&0>i(le,he))Y[xe]=le,Y[G]=he,xe=G;else break e}}return q}function i(Y,q){var he=Y.sortIndex-q.sortIndex;return he!==0?he:Y.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],c=1,h=null,f=3,d=!1,g=!1,p=!1,m=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(Y){for(var q=r(u);q!==null;){if(q.callback===null)n(u);else if(q.startTime<=Y)n(u),q.sortIndex=q.expirationTime,e(l,q);else break;q=r(u)}}function w(Y){if(p=!1,_(Y),!g)if(r(l)!==null)g=!0,we(O);else{var q=r(u);q!==null&&_e(w,q.startTime-Y)}}function O(Y,q){g=!1,p&&(p=!1,v(P),P=-1),d=!0;var he=f;try{for(_(q),h=r(l);h!==null&&(!(h.expirationTime>q)||Y&&!U());){var xe=h.callback;if(typeof xe=="function"){h.callback=null,f=h.priorityLevel;var C=xe(h.expirationTime<=q);q=t.unstable_now(),typeof C=="function"?h.callback=C:h===r(l)&&n(l),_(q)}else n(l);h=r(l)}if(h!==null)var L=!0;else{var I=r(u);I!==null&&_e(w,I.startTime-q),L=!1}return L}finally{h=null,f=he,d=!1}}var R=!1,T=null,P=-1,F=5,N=-1;function U(){return!(t.unstable_now()-N<F)}function H(){if(T!==null){var Y=t.unstable_now();N=Y;var q=!0;try{q=T(!0,Y)}finally{q?Z():(R=!1,T=null)}}else R=!1}var Z;if(typeof x=="function")Z=function(){x(H)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,oe=ve.port2;ve.port1.onmessage=H,Z=function(){oe.postMessage(null)}}else Z=function(){m(H,0)};function we(Y){T=Y,R||(R=!0,Z())}function _e(Y,q){P=m(function(){Y(t.unstable_now())},q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Y){Y.callback=null},t.unstable_continueExecution=function(){g||d||(g=!0,we(O))},t.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<Y?Math.floor(1e3/Y):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(Y){switch(f){case 1:case 2:case 3:var q=3;break;default:q=f}var he=f;f=q;try{return Y()}finally{f=he}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Y,q){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var he=f;f=Y;try{return q()}finally{f=he}},t.unstable_scheduleCallback=function(Y,q,he){var xe=t.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?xe+he:xe):he=xe,Y){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=he+C,Y={id:c++,callback:q,priorityLevel:Y,startTime:he,expirationTime:C,sortIndex:-1},he>xe?(Y.sortIndex=he,e(u,Y),r(l)===null&&Y===r(u)&&(p?(v(P),P=-1):p=!0,_e(w,he-xe))):(Y.sortIndex=C,e(l,Y),g||d||(g=!0,we(O))),Y},t.unstable_shouldYield=U,t.unstable_wrapCallback=function(Y){var q=f;return function(){var he=f;f=q;try{return Y.apply(this,arguments)}finally{f=he}}}})(uv);lv.exports=uv;var wS=lv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SS=lr,vr=wS;function Q(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var cv=new Set,mo={};function is(t,e){Qs(t,e),Qs(t+"Capture",e)}function Qs(t,e){for(mo[t]=e,t=0;t<e.length;t++)cv.add(e[t])}var Pn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tf=Object.prototype.hasOwnProperty,ES=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,xp={},_p={};function TS(t){return tf.call(_p,t)?!0:tf.call(xp,t)?!1:ES.test(t)?_p[t]=!0:(xp[t]=!0,!1)}function kS(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function bS(t,e,r,n){if(e===null||typeof e>"u"||kS(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function qt(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Rt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Rt[t]=new qt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Rt[e]=new qt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Rt[t]=new qt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Rt[t]=new qt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Rt[t]=new qt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Rt[t]=new qt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Rt[t]=new qt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Rt[t]=new qt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Rt[t]=new qt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Td=/[\-:]([a-z])/g;function kd(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Td,kd);Rt[e]=new qt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Td,kd);Rt[e]=new qt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Td,kd);Rt[e]=new qt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Rt[t]=new qt(t,1,!1,t.toLowerCase(),null,!1,!1)});Rt.xlinkHref=new qt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Rt[t]=new qt(t,1,!1,t.toLowerCase(),null,!0,!0)});function bd(t,e,r,n){var i=Rt.hasOwnProperty(e)?Rt[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(bS(e,r,i,n)&&(r=null),n||i===null?TS(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Ln=SS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,cl=Symbol.for("react.element"),ks=Symbol.for("react.portal"),bs=Symbol.for("react.fragment"),Ad=Symbol.for("react.strict_mode"),rf=Symbol.for("react.profiler"),hv=Symbol.for("react.provider"),fv=Symbol.for("react.context"),Od=Symbol.for("react.forward_ref"),nf=Symbol.for("react.suspense"),sf=Symbol.for("react.suspense_list"),Cd=Symbol.for("react.memo"),zn=Symbol.for("react.lazy"),dv=Symbol.for("react.offscreen"),yp=Symbol.iterator;function Ta(t){return t===null||typeof t!="object"?null:(t=yp&&t[yp]||t["@@iterator"],typeof t=="function"?t:null)}var tt=Object.assign,Zc;function Ba(t){if(Zc===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Zc=e&&e[1]||""}return`
`+Zc+t}var eh=!1;function th(t,e){if(!t||eh)return"";eh=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{eh=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Ba(t):""}function AS(t){switch(t.tag){case 5:return Ba(t.type);case 16:return Ba("Lazy");case 13:return Ba("Suspense");case 19:return Ba("SuspenseList");case 0:case 2:case 15:return t=th(t.type,!1),t;case 11:return t=th(t.type.render,!1),t;case 1:return t=th(t.type,!0),t;default:return""}}function af(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case bs:return"Fragment";case ks:return"Portal";case rf:return"Profiler";case Ad:return"StrictMode";case nf:return"Suspense";case sf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case fv:return(t.displayName||"Context")+".Consumer";case hv:return(t._context.displayName||"Context")+".Provider";case Od:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Cd:return e=t.displayName||null,e!==null?e:af(t.type)||"Memo";case zn:e=t._payload,t=t._init;try{return af(t(e))}catch{}}return null}function OS(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return af(e);case 8:return e===Ad?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function hi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function pv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function CS(t){var e=pv(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function hl(t){t._valueTracker||(t._valueTracker=CS(t))}function gv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=pv(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function _u(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function of(t,e){var r=e.checked;return tt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function wp(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=hi(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function mv(t,e){e=e.checked,e!=null&&bd(t,"checked",e,!1)}function lf(t,e){mv(t,e);var r=hi(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?uf(t,e.type,r):e.hasOwnProperty("defaultValue")&&uf(t,e.type,hi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Sp(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function uf(t,e,r){(e!=="number"||_u(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var ja=Array.isArray;function js(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+hi(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function cf(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Q(91));return tt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ep(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Q(92));if(ja(r)){if(1<r.length)throw Error(Q(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:hi(r)}}function vv(t,e){var r=hi(e.value),n=hi(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Tp(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function xv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function hf(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?xv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var fl,_v=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(fl=fl||document.createElement("div"),fl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=fl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function vo(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Ka={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},PS=["Webkit","ms","Moz","O"];Object.keys(Ka).forEach(function(t){PS.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ka[e]=Ka[t]})});function yv(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Ka.hasOwnProperty(t)&&Ka[t]?(""+e).trim():e+"px"}function wv(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=yv(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var RS=tt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ff(t,e){if(e){if(RS[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Q(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Q(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Q(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Q(62))}}function df(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pf=null;function Pd(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var gf=null,Us=null,$s=null;function kp(t){if(t=Jo(t)){if(typeof gf!="function")throw Error(Q(280));var e=t.stateNode;e&&(e=Sc(e),gf(t.stateNode,t.type,e))}}function Sv(t){Us?$s?$s.push(t):$s=[t]:Us=t}function Ev(){if(Us){var t=Us,e=$s;if($s=Us=null,kp(t),e)for(t=0;t<e.length;t++)kp(e[t])}}function Tv(t,e){return t(e)}function kv(){}var rh=!1;function bv(t,e,r){if(rh)return t(e,r);rh=!0;try{return Tv(t,e,r)}finally{rh=!1,(Us!==null||$s!==null)&&(kv(),Ev())}}function xo(t,e){var r=t.stateNode;if(r===null)return null;var n=Sc(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Q(231,e,typeof r));return r}var mf=!1;if(Pn)try{var ka={};Object.defineProperty(ka,"passive",{get:function(){mf=!0}}),window.addEventListener("test",ka,ka),window.removeEventListener("test",ka,ka)}catch{mf=!1}function FS(t,e,r,n,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(c){this.onError(c)}}var Ya=!1,yu=null,wu=!1,vf=null,IS={onError:function(t){Ya=!0,yu=t}};function DS(t,e,r,n,i,s,a,o,l){Ya=!1,yu=null,FS.apply(IS,arguments)}function NS(t,e,r,n,i,s,a,o,l){if(DS.apply(this,arguments),Ya){if(Ya){var u=yu;Ya=!1,yu=null}else throw Error(Q(198));wu||(wu=!0,vf=u)}}function ss(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Av(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function bp(t){if(ss(t)!==t)throw Error(Q(188))}function LS(t){var e=t.alternate;if(!e){if(e=ss(t),e===null)throw Error(Q(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return bp(i),t;if(s===n)return bp(i),e;s=s.sibling}throw Error(Q(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(Q(189))}}if(r.alternate!==n)throw Error(Q(190))}if(r.tag!==3)throw Error(Q(188));return r.stateNode.current===r?t:e}function Ov(t){return t=LS(t),t!==null?Cv(t):null}function Cv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Cv(t);if(e!==null)return e;t=t.sibling}return null}var Pv=vr.unstable_scheduleCallback,Ap=vr.unstable_cancelCallback,MS=vr.unstable_shouldYield,BS=vr.unstable_requestPaint,st=vr.unstable_now,jS=vr.unstable_getCurrentPriorityLevel,Rd=vr.unstable_ImmediatePriority,Rv=vr.unstable_UserBlockingPriority,Su=vr.unstable_NormalPriority,US=vr.unstable_LowPriority,Fv=vr.unstable_IdlePriority,xc=null,fn=null;function $S(t){if(fn&&typeof fn.onCommitFiberRoot=="function")try{fn.onCommitFiberRoot(xc,t,void 0,(t.current.flags&128)===128)}catch{}}var Qr=Math.clz32?Math.clz32:HS,zS=Math.log,WS=Math.LN2;function HS(t){return t>>>=0,t===0?32:31-(zS(t)/WS|0)|0}var dl=64,pl=4194304;function Ua(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Eu(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Ua(o):(s&=a,s!==0&&(n=Ua(s)))}else a=r&~i,a!==0?n=Ua(a):s!==0&&(n=Ua(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Qr(e),i=1<<r,n|=t[r],e&=~i;return n}function VS(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function GS(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Qr(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=VS(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function xf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Iv(){var t=dl;return dl<<=1,!(dl&4194240)&&(dl=64),t}function nh(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Xo(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Qr(e),t[e]=r}function KS(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Qr(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function Fd(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Qr(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Me=0;function Dv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Nv,Id,Lv,Mv,Bv,_f=!1,gl=[],ei=null,ti=null,ri=null,_o=new Map,yo=new Map,Hn=[],YS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Op(t,e){switch(t){case"focusin":case"focusout":ei=null;break;case"dragenter":case"dragleave":ti=null;break;case"mouseover":case"mouseout":ri=null;break;case"pointerover":case"pointerout":_o.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":yo.delete(e.pointerId)}}function ba(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Jo(e),e!==null&&Id(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function XS(t,e,r,n,i){switch(e){case"focusin":return ei=ba(ei,t,e,r,n,i),!0;case"dragenter":return ti=ba(ti,t,e,r,n,i),!0;case"mouseover":return ri=ba(ri,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return _o.set(s,ba(_o.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,yo.set(s,ba(yo.get(s)||null,t,e,r,n,i)),!0}return!1}function jv(t){var e=Ui(t.target);if(e!==null){var r=ss(e);if(r!==null){if(e=r.tag,e===13){if(e=Av(r),e!==null){t.blockedOn=e,Bv(t.priority,function(){Lv(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function iu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=yf(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);pf=n,r.target.dispatchEvent(n),pf=null}else return e=Jo(r),e!==null&&Id(e),t.blockedOn=r,!1;e.shift()}return!0}function Cp(t,e,r){iu(t)&&r.delete(e)}function qS(){_f=!1,ei!==null&&iu(ei)&&(ei=null),ti!==null&&iu(ti)&&(ti=null),ri!==null&&iu(ri)&&(ri=null),_o.forEach(Cp),yo.forEach(Cp)}function Aa(t,e){t.blockedOn===e&&(t.blockedOn=null,_f||(_f=!0,vr.unstable_scheduleCallback(vr.unstable_NormalPriority,qS)))}function wo(t){function e(i){return Aa(i,t)}if(0<gl.length){Aa(gl[0],t);for(var r=1;r<gl.length;r++){var n=gl[r];n.blockedOn===t&&(n.blockedOn=null)}}for(ei!==null&&Aa(ei,t),ti!==null&&Aa(ti,t),ri!==null&&Aa(ri,t),_o.forEach(e),yo.forEach(e),r=0;r<Hn.length;r++)n=Hn[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Hn.length&&(r=Hn[0],r.blockedOn===null);)jv(r),r.blockedOn===null&&Hn.shift()}var zs=Ln.ReactCurrentBatchConfig,Tu=!0;function JS(t,e,r,n){var i=Me,s=zs.transition;zs.transition=null;try{Me=1,Dd(t,e,r,n)}finally{Me=i,zs.transition=s}}function QS(t,e,r,n){var i=Me,s=zs.transition;zs.transition=null;try{Me=4,Dd(t,e,r,n)}finally{Me=i,zs.transition=s}}function Dd(t,e,r,n){if(Tu){var i=yf(t,e,r,n);if(i===null)dh(t,e,n,ku,r),Op(t,n);else if(XS(i,t,e,r,n))n.stopPropagation();else if(Op(t,n),e&4&&-1<YS.indexOf(t)){for(;i!==null;){var s=Jo(i);if(s!==null&&Nv(s),s=yf(t,e,r,n),s===null&&dh(t,e,n,ku,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else dh(t,e,n,null,r)}}var ku=null;function yf(t,e,r,n){if(ku=null,t=Pd(n),t=Ui(t),t!==null)if(e=ss(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Av(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ku=t,null}function Uv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(jS()){case Rd:return 1;case Rv:return 4;case Su:case US:return 16;case Fv:return 536870912;default:return 16}default:return 16}}var Kn=null,Nd=null,su=null;function $v(){if(su)return su;var t,e=Nd,r=e.length,n,i="value"in Kn?Kn.value:Kn.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return su=i.slice(t,1<n?1-n:void 0)}function au(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ml(){return!0}function Pp(){return!1}function yr(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ml:Pp,this.isPropagationStopped=Pp,this}return tt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ml)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ml)},persist:function(){},isPersistent:ml}),e}var ca={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ld=yr(ca),qo=tt({},ca,{view:0,detail:0}),ZS=yr(qo),ih,sh,Oa,_c=tt({},qo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Md,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Oa&&(Oa&&t.type==="mousemove"?(ih=t.screenX-Oa.screenX,sh=t.screenY-Oa.screenY):sh=ih=0,Oa=t),ih)},movementY:function(t){return"movementY"in t?t.movementY:sh}}),Rp=yr(_c),eE=tt({},_c,{dataTransfer:0}),tE=yr(eE),rE=tt({},qo,{relatedTarget:0}),ah=yr(rE),nE=tt({},ca,{animationName:0,elapsedTime:0,pseudoElement:0}),iE=yr(nE),sE=tt({},ca,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),aE=yr(sE),oE=tt({},ca,{data:0}),Fp=yr(oE),lE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=cE[t])?!!e[t]:!1}function Md(){return hE}var fE=tt({},qo,{key:function(t){if(t.key){var e=lE[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=au(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?uE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Md,charCode:function(t){return t.type==="keypress"?au(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?au(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),dE=yr(fE),pE=tt({},_c,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ip=yr(pE),gE=tt({},qo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Md}),mE=yr(gE),vE=tt({},ca,{propertyName:0,elapsedTime:0,pseudoElement:0}),xE=yr(vE),_E=tt({},_c,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),yE=yr(_E),wE=[9,13,27,32],Bd=Pn&&"CompositionEvent"in window,Xa=null;Pn&&"documentMode"in document&&(Xa=document.documentMode);var SE=Pn&&"TextEvent"in window&&!Xa,zv=Pn&&(!Bd||Xa&&8<Xa&&11>=Xa),Dp=" ",Np=!1;function Wv(t,e){switch(t){case"keyup":return wE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hv(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var As=!1;function EE(t,e){switch(t){case"compositionend":return Hv(e);case"keypress":return e.which!==32?null:(Np=!0,Dp);case"textInput":return t=e.data,t===Dp&&Np?null:t;default:return null}}function TE(t,e){if(As)return t==="compositionend"||!Bd&&Wv(t,e)?(t=$v(),su=Nd=Kn=null,As=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return zv&&e.locale!=="ko"?null:e.data;default:return null}}var kE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!kE[t.type]:e==="textarea"}function Vv(t,e,r,n){Sv(n),e=bu(e,"onChange"),0<e.length&&(r=new Ld("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var qa=null,So=null;function bE(t){rx(t,0)}function yc(t){var e=Ps(t);if(gv(e))return t}function AE(t,e){if(t==="change")return e}var Gv=!1;if(Pn){var oh;if(Pn){var lh="oninput"in document;if(!lh){var Mp=document.createElement("div");Mp.setAttribute("oninput","return;"),lh=typeof Mp.oninput=="function"}oh=lh}else oh=!1;Gv=oh&&(!document.documentMode||9<document.documentMode)}function Bp(){qa&&(qa.detachEvent("onpropertychange",Kv),So=qa=null)}function Kv(t){if(t.propertyName==="value"&&yc(So)){var e=[];Vv(e,So,t,Pd(t)),bv(bE,e)}}function OE(t,e,r){t==="focusin"?(Bp(),qa=e,So=r,qa.attachEvent("onpropertychange",Kv)):t==="focusout"&&Bp()}function CE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return yc(So)}function PE(t,e){if(t==="click")return yc(e)}function RE(t,e){if(t==="input"||t==="change")return yc(e)}function FE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var tn=typeof Object.is=="function"?Object.is:FE;function Eo(t,e){if(tn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!tf.call(e,i)||!tn(t[i],e[i]))return!1}return!0}function jp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Up(t,e){var r=jp(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=jp(r)}}function Yv(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Yv(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Xv(){for(var t=window,e=_u();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=_u(t.document)}return e}function jd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function IE(t){var e=Xv(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Yv(r.ownerDocument.documentElement,r)){if(n!==null&&jd(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Up(r,s);var a=Up(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var DE=Pn&&"documentMode"in document&&11>=document.documentMode,Os=null,wf=null,Ja=null,Sf=!1;function $p(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Sf||Os==null||Os!==_u(n)||(n=Os,"selectionStart"in n&&jd(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ja&&Eo(Ja,n)||(Ja=n,n=bu(wf,"onSelect"),0<n.length&&(e=new Ld("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Os)))}function vl(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Cs={animationend:vl("Animation","AnimationEnd"),animationiteration:vl("Animation","AnimationIteration"),animationstart:vl("Animation","AnimationStart"),transitionend:vl("Transition","TransitionEnd")},uh={},qv={};Pn&&(qv=document.createElement("div").style,"AnimationEvent"in window||(delete Cs.animationend.animation,delete Cs.animationiteration.animation,delete Cs.animationstart.animation),"TransitionEvent"in window||delete Cs.transitionend.transition);function wc(t){if(uh[t])return uh[t];if(!Cs[t])return t;var e=Cs[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in qv)return uh[t]=e[r];return t}var Jv=wc("animationend"),Qv=wc("animationiteration"),Zv=wc("animationstart"),ex=wc("transitionend"),tx=new Map,zp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xi(t,e){tx.set(t,e),is(e,[t])}for(var ch=0;ch<zp.length;ch++){var hh=zp[ch],NE=hh.toLowerCase(),LE=hh[0].toUpperCase()+hh.slice(1);xi(NE,"on"+LE)}xi(Jv,"onAnimationEnd");xi(Qv,"onAnimationIteration");xi(Zv,"onAnimationStart");xi("dblclick","onDoubleClick");xi("focusin","onFocus");xi("focusout","onBlur");xi(ex,"onTransitionEnd");Qs("onMouseEnter",["mouseout","mouseover"]);Qs("onMouseLeave",["mouseout","mouseover"]);Qs("onPointerEnter",["pointerout","pointerover"]);Qs("onPointerLeave",["pointerout","pointerover"]);is("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));is("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));is("onBeforeInput",["compositionend","keypress","textInput","paste"]);is("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));is("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));is("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $a="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ME=new Set("cancel close invalid load scroll toggle".split(" ").concat($a));function Wp(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,NS(n,e,void 0,t),t.currentTarget=null}function rx(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Wp(i,o,u),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Wp(i,o,u),s=l}}}if(wu)throw t=vf,wu=!1,vf=null,t}function He(t,e){var r=e[Af];r===void 0&&(r=e[Af]=new Set);var n=t+"__bubble";r.has(n)||(nx(e,t,2,!1),r.add(n))}function fh(t,e,r){var n=0;e&&(n|=4),nx(r,t,n,e)}var xl="_reactListening"+Math.random().toString(36).slice(2);function To(t){if(!t[xl]){t[xl]=!0,cv.forEach(function(r){r!=="selectionchange"&&(ME.has(r)||fh(r,!1,t),fh(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[xl]||(e[xl]=!0,fh("selectionchange",!1,e))}}function nx(t,e,r,n){switch(Uv(e)){case 1:var i=JS;break;case 4:i=QS;break;default:i=Dd}r=i.bind(null,e,r,t),i=void 0,!mf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function dh(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Ui(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}bv(function(){var u=s,c=Pd(r),h=[];e:{var f=tx.get(t);if(f!==void 0){var d=Ld,g=t;switch(t){case"keypress":if(au(r)===0)break e;case"keydown":case"keyup":d=dE;break;case"focusin":g="focus",d=ah;break;case"focusout":g="blur",d=ah;break;case"beforeblur":case"afterblur":d=ah;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=Rp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=tE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=mE;break;case Jv:case Qv:case Zv:d=iE;break;case ex:d=xE;break;case"scroll":d=ZS;break;case"wheel":d=yE;break;case"copy":case"cut":case"paste":d=aE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=Ip}var p=(e&4)!==0,m=!p&&t==="scroll",v=p?f!==null?f+"Capture":null:f;p=[];for(var x=u,_;x!==null;){_=x;var w=_.stateNode;if(_.tag===5&&w!==null&&(_=w,v!==null&&(w=xo(x,v),w!=null&&p.push(ko(x,w,_)))),m)break;x=x.return}0<p.length&&(f=new d(f,g,null,r,c),h.push({event:f,listeners:p}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",d=t==="mouseout"||t==="pointerout",f&&r!==pf&&(g=r.relatedTarget||r.fromElement)&&(Ui(g)||g[Rn]))break e;if((d||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,d?(g=r.relatedTarget||r.toElement,d=u,g=g?Ui(g):null,g!==null&&(m=ss(g),g!==m||g.tag!==5&&g.tag!==6)&&(g=null)):(d=null,g=u),d!==g)){if(p=Rp,w="onMouseLeave",v="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(p=Ip,w="onPointerLeave",v="onPointerEnter",x="pointer"),m=d==null?f:Ps(d),_=g==null?f:Ps(g),f=new p(w,x+"leave",d,r,c),f.target=m,f.relatedTarget=_,w=null,Ui(c)===u&&(p=new p(v,x+"enter",g,r,c),p.target=_,p.relatedTarget=m,w=p),m=w,d&&g)t:{for(p=d,v=g,x=0,_=p;_;_=fs(_))x++;for(_=0,w=v;w;w=fs(w))_++;for(;0<x-_;)p=fs(p),x--;for(;0<_-x;)v=fs(v),_--;for(;x--;){if(p===v||v!==null&&p===v.alternate)break t;p=fs(p),v=fs(v)}p=null}else p=null;d!==null&&Hp(h,f,d,p,!1),g!==null&&m!==null&&Hp(h,m,g,p,!0)}}e:{if(f=u?Ps(u):window,d=f.nodeName&&f.nodeName.toLowerCase(),d==="select"||d==="input"&&f.type==="file")var O=AE;else if(Lp(f))if(Gv)O=RE;else{O=CE;var R=OE}else(d=f.nodeName)&&d.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(O=PE);if(O&&(O=O(t,u))){Vv(h,O,r,c);break e}R&&R(t,f,u),t==="focusout"&&(R=f._wrapperState)&&R.controlled&&f.type==="number"&&uf(f,"number",f.value)}switch(R=u?Ps(u):window,t){case"focusin":(Lp(R)||R.contentEditable==="true")&&(Os=R,wf=u,Ja=null);break;case"focusout":Ja=wf=Os=null;break;case"mousedown":Sf=!0;break;case"contextmenu":case"mouseup":case"dragend":Sf=!1,$p(h,r,c);break;case"selectionchange":if(DE)break;case"keydown":case"keyup":$p(h,r,c)}var T;if(Bd)e:{switch(t){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else As?Wv(t,r)&&(P="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(zv&&r.locale!=="ko"&&(As||P!=="onCompositionStart"?P==="onCompositionEnd"&&As&&(T=$v()):(Kn=c,Nd="value"in Kn?Kn.value:Kn.textContent,As=!0)),R=bu(u,P),0<R.length&&(P=new Fp(P,t,null,r,c),h.push({event:P,listeners:R}),T?P.data=T:(T=Hv(r),T!==null&&(P.data=T)))),(T=SE?EE(t,r):TE(t,r))&&(u=bu(u,"onBeforeInput"),0<u.length&&(c=new Fp("onBeforeInput","beforeinput",null,r,c),h.push({event:c,listeners:u}),c.data=T))}rx(h,e)})}function ko(t,e,r){return{instance:t,listener:e,currentTarget:r}}function bu(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=xo(t,r),s!=null&&n.unshift(ko(t,s,i)),s=xo(t,e),s!=null&&n.push(ko(t,s,i))),t=t.return}return n}function fs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Hp(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,i?(l=xo(r,s),l!=null&&a.unshift(ko(r,l,o))):i||(l=xo(r,s),l!=null&&a.push(ko(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var BE=/\r\n?/g,jE=/\u0000|\uFFFD/g;function Vp(t){return(typeof t=="string"?t:""+t).replace(BE,`
`).replace(jE,"")}function _l(t,e,r){if(e=Vp(e),Vp(t)!==e&&r)throw Error(Q(425))}function Au(){}var Ef=null,Tf=null;function kf(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var bf=typeof setTimeout=="function"?setTimeout:void 0,UE=typeof clearTimeout=="function"?clearTimeout:void 0,Gp=typeof Promise=="function"?Promise:void 0,$E=typeof queueMicrotask=="function"?queueMicrotask:typeof Gp<"u"?function(t){return Gp.resolve(null).then(t).catch(zE)}:bf;function zE(t){setTimeout(function(){throw t})}function ph(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),wo(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);wo(e)}function ni(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Kp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var ha=Math.random().toString(36).slice(2),hn="__reactFiber$"+ha,bo="__reactProps$"+ha,Rn="__reactContainer$"+ha,Af="__reactEvents$"+ha,WE="__reactListeners$"+ha,HE="__reactHandles$"+ha;function Ui(t){var e=t[hn];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Rn]||r[hn]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Kp(t);t!==null;){if(r=t[hn])return r;t=Kp(t)}return e}t=r,r=t.parentNode}return null}function Jo(t){return t=t[hn]||t[Rn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ps(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Q(33))}function Sc(t){return t[bo]||null}var Of=[],Rs=-1;function _i(t){return{current:t}}function Ge(t){0>Rs||(t.current=Of[Rs],Of[Rs]=null,Rs--)}function We(t,e){Rs++,Of[Rs]=t.current,t.current=e}var fi={},zt=_i(fi),tr=_i(!1),Xi=fi;function Zs(t,e){var r=t.type.contextTypes;if(!r)return fi;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function rr(t){return t=t.childContextTypes,t!=null}function Ou(){Ge(tr),Ge(zt)}function Yp(t,e,r){if(zt.current!==fi)throw Error(Q(168));We(zt,e),We(tr,r)}function ix(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Q(108,OS(t)||"Unknown",i));return tt({},r,n)}function Cu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||fi,Xi=zt.current,We(zt,t),We(tr,tr.current),!0}function Xp(t,e,r){var n=t.stateNode;if(!n)throw Error(Q(169));r?(t=ix(t,e,Xi),n.__reactInternalMemoizedMergedChildContext=t,Ge(tr),Ge(zt),We(zt,t)):Ge(tr),We(tr,r)}var Sn=null,Ec=!1,gh=!1;function sx(t){Sn===null?Sn=[t]:Sn.push(t)}function VE(t){Ec=!0,sx(t)}function yi(){if(!gh&&Sn!==null){gh=!0;var t=0,e=Me;try{var r=Sn;for(Me=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Sn=null,Ec=!1}catch(i){throw Sn!==null&&(Sn=Sn.slice(t+1)),Pv(Rd,yi),i}finally{Me=e,gh=!1}}return null}var Fs=[],Is=0,Pu=null,Ru=0,Ar=[],Or=0,qi=null,Tn=1,kn="";function Fi(t,e){Fs[Is++]=Ru,Fs[Is++]=Pu,Pu=t,Ru=e}function ax(t,e,r){Ar[Or++]=Tn,Ar[Or++]=kn,Ar[Or++]=qi,qi=t;var n=Tn;t=kn;var i=32-Qr(n)-1;n&=~(1<<i),r+=1;var s=32-Qr(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Tn=1<<32-Qr(e)+i|r<<i|n,kn=s+t}else Tn=1<<s|r<<i|n,kn=t}function Ud(t){t.return!==null&&(Fi(t,1),ax(t,1,0))}function $d(t){for(;t===Pu;)Pu=Fs[--Is],Fs[Is]=null,Ru=Fs[--Is],Fs[Is]=null;for(;t===qi;)qi=Ar[--Or],Ar[Or]=null,kn=Ar[--Or],Ar[Or]=null,Tn=Ar[--Or],Ar[Or]=null}var mr=null,gr=null,Xe=!1,Gr=null;function ox(t,e){var r=Cr(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function qp(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,mr=t,gr=ni(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,mr=t,gr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=qi!==null?{id:Tn,overflow:kn}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Cr(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,mr=t,gr=null,!0):!1;default:return!1}}function Cf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Pf(t){if(Xe){var e=gr;if(e){var r=e;if(!qp(t,e)){if(Cf(t))throw Error(Q(418));e=ni(r.nextSibling);var n=mr;e&&qp(t,e)?ox(n,r):(t.flags=t.flags&-4097|2,Xe=!1,mr=t)}}else{if(Cf(t))throw Error(Q(418));t.flags=t.flags&-4097|2,Xe=!1,mr=t}}}function Jp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;mr=t}function yl(t){if(t!==mr)return!1;if(!Xe)return Jp(t),Xe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!kf(t.type,t.memoizedProps)),e&&(e=gr)){if(Cf(t))throw lx(),Error(Q(418));for(;e;)ox(t,e),e=ni(e.nextSibling)}if(Jp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Q(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){gr=ni(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}gr=null}}else gr=mr?ni(t.stateNode.nextSibling):null;return!0}function lx(){for(var t=gr;t;)t=ni(t.nextSibling)}function ea(){gr=mr=null,Xe=!1}function zd(t){Gr===null?Gr=[t]:Gr.push(t)}var GE=Ln.ReactCurrentBatchConfig;function Ca(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Q(309));var n=r.stateNode}if(!n)throw Error(Q(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(Q(284));if(!r._owner)throw Error(Q(290,t))}return t}function wl(t,e){throw t=Object.prototype.toString.call(e),Error(Q(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Qp(t){var e=t._init;return e(t._payload)}function ux(t){function e(v,x){if(t){var _=v.deletions;_===null?(v.deletions=[x],v.flags|=16):_.push(x)}}function r(v,x){if(!t)return null;for(;x!==null;)e(v,x),x=x.sibling;return null}function n(v,x){for(v=new Map;x!==null;)x.key!==null?v.set(x.key,x):v.set(x.index,x),x=x.sibling;return v}function i(v,x){return v=oi(v,x),v.index=0,v.sibling=null,v}function s(v,x,_){return v.index=_,t?(_=v.alternate,_!==null?(_=_.index,_<x?(v.flags|=2,x):_):(v.flags|=2,x)):(v.flags|=1048576,x)}function a(v){return t&&v.alternate===null&&(v.flags|=2),v}function o(v,x,_,w){return x===null||x.tag!==6?(x=Sh(_,v.mode,w),x.return=v,x):(x=i(x,_),x.return=v,x)}function l(v,x,_,w){var O=_.type;return O===bs?c(v,x,_.props.children,w,_.key):x!==null&&(x.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===zn&&Qp(O)===x.type)?(w=i(x,_.props),w.ref=Ca(v,x,_),w.return=v,w):(w=du(_.type,_.key,_.props,null,v.mode,w),w.ref=Ca(v,x,_),w.return=v,w)}function u(v,x,_,w){return x===null||x.tag!==4||x.stateNode.containerInfo!==_.containerInfo||x.stateNode.implementation!==_.implementation?(x=Eh(_,v.mode,w),x.return=v,x):(x=i(x,_.children||[]),x.return=v,x)}function c(v,x,_,w,O){return x===null||x.tag!==7?(x=Gi(_,v.mode,w,O),x.return=v,x):(x=i(x,_),x.return=v,x)}function h(v,x,_){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Sh(""+x,v.mode,_),x.return=v,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case cl:return _=du(x.type,x.key,x.props,null,v.mode,_),_.ref=Ca(v,null,x),_.return=v,_;case ks:return x=Eh(x,v.mode,_),x.return=v,x;case zn:var w=x._init;return h(v,w(x._payload),_)}if(ja(x)||Ta(x))return x=Gi(x,v.mode,_,null),x.return=v,x;wl(v,x)}return null}function f(v,x,_,w){var O=x!==null?x.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return O!==null?null:o(v,x,""+_,w);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case cl:return _.key===O?l(v,x,_,w):null;case ks:return _.key===O?u(v,x,_,w):null;case zn:return O=_._init,f(v,x,O(_._payload),w)}if(ja(_)||Ta(_))return O!==null?null:c(v,x,_,w,null);wl(v,_)}return null}function d(v,x,_,w,O){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(_)||null,o(x,v,""+w,O);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case cl:return v=v.get(w.key===null?_:w.key)||null,l(x,v,w,O);case ks:return v=v.get(w.key===null?_:w.key)||null,u(x,v,w,O);case zn:var R=w._init;return d(v,x,_,R(w._payload),O)}if(ja(w)||Ta(w))return v=v.get(_)||null,c(x,v,w,O,null);wl(x,w)}return null}function g(v,x,_,w){for(var O=null,R=null,T=x,P=x=0,F=null;T!==null&&P<_.length;P++){T.index>P?(F=T,T=null):F=T.sibling;var N=f(v,T,_[P],w);if(N===null){T===null&&(T=F);break}t&&T&&N.alternate===null&&e(v,T),x=s(N,x,P),R===null?O=N:R.sibling=N,R=N,T=F}if(P===_.length)return r(v,T),Xe&&Fi(v,P),O;if(T===null){for(;P<_.length;P++)T=h(v,_[P],w),T!==null&&(x=s(T,x,P),R===null?O=T:R.sibling=T,R=T);return Xe&&Fi(v,P),O}for(T=n(v,T);P<_.length;P++)F=d(T,v,P,_[P],w),F!==null&&(t&&F.alternate!==null&&T.delete(F.key===null?P:F.key),x=s(F,x,P),R===null?O=F:R.sibling=F,R=F);return t&&T.forEach(function(U){return e(v,U)}),Xe&&Fi(v,P),O}function p(v,x,_,w){var O=Ta(_);if(typeof O!="function")throw Error(Q(150));if(_=O.call(_),_==null)throw Error(Q(151));for(var R=O=null,T=x,P=x=0,F=null,N=_.next();T!==null&&!N.done;P++,N=_.next()){T.index>P?(F=T,T=null):F=T.sibling;var U=f(v,T,N.value,w);if(U===null){T===null&&(T=F);break}t&&T&&U.alternate===null&&e(v,T),x=s(U,x,P),R===null?O=U:R.sibling=U,R=U,T=F}if(N.done)return r(v,T),Xe&&Fi(v,P),O;if(T===null){for(;!N.done;P++,N=_.next())N=h(v,N.value,w),N!==null&&(x=s(N,x,P),R===null?O=N:R.sibling=N,R=N);return Xe&&Fi(v,P),O}for(T=n(v,T);!N.done;P++,N=_.next())N=d(T,v,P,N.value,w),N!==null&&(t&&N.alternate!==null&&T.delete(N.key===null?P:N.key),x=s(N,x,P),R===null?O=N:R.sibling=N,R=N);return t&&T.forEach(function(H){return e(v,H)}),Xe&&Fi(v,P),O}function m(v,x,_,w){if(typeof _=="object"&&_!==null&&_.type===bs&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case cl:e:{for(var O=_.key,R=x;R!==null;){if(R.key===O){if(O=_.type,O===bs){if(R.tag===7){r(v,R.sibling),x=i(R,_.props.children),x.return=v,v=x;break e}}else if(R.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===zn&&Qp(O)===R.type){r(v,R.sibling),x=i(R,_.props),x.ref=Ca(v,R,_),x.return=v,v=x;break e}r(v,R);break}else e(v,R);R=R.sibling}_.type===bs?(x=Gi(_.props.children,v.mode,w,_.key),x.return=v,v=x):(w=du(_.type,_.key,_.props,null,v.mode,w),w.ref=Ca(v,x,_),w.return=v,v=w)}return a(v);case ks:e:{for(R=_.key;x!==null;){if(x.key===R)if(x.tag===4&&x.stateNode.containerInfo===_.containerInfo&&x.stateNode.implementation===_.implementation){r(v,x.sibling),x=i(x,_.children||[]),x.return=v,v=x;break e}else{r(v,x);break}else e(v,x);x=x.sibling}x=Eh(_,v.mode,w),x.return=v,v=x}return a(v);case zn:return R=_._init,m(v,x,R(_._payload),w)}if(ja(_))return g(v,x,_,w);if(Ta(_))return p(v,x,_,w);wl(v,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,x!==null&&x.tag===6?(r(v,x.sibling),x=i(x,_),x.return=v,v=x):(r(v,x),x=Sh(_,v.mode,w),x.return=v,v=x),a(v)):r(v,x)}return m}var ta=ux(!0),cx=ux(!1),Fu=_i(null),Iu=null,Ds=null,Wd=null;function Hd(){Wd=Ds=Iu=null}function Vd(t){var e=Fu.current;Ge(Fu),t._currentValue=e}function Rf(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Ws(t,e){Iu=t,Wd=Ds=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(er=!0),t.firstContext=null)}function Fr(t){var e=t._currentValue;if(Wd!==t)if(t={context:t,memoizedValue:e,next:null},Ds===null){if(Iu===null)throw Error(Q(308));Ds=t,Iu.dependencies={lanes:0,firstContext:t}}else Ds=Ds.next=t;return e}var $i=null;function Gd(t){$i===null?$i=[t]:$i.push(t)}function hx(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,Gd(e)):(r.next=i.next,i.next=r),e.interleaved=r,Fn(t,n)}function Fn(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Wn=!1;function Kd(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function fx(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function bn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ii(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,be&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,Fn(t,r)}return i=n.interleaved,i===null?(e.next=e,Gd(n)):(e.next=i.next,i.next=e),n.interleaved=e,Fn(t,r)}function ou(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Fd(t,r)}}function Zp(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Du(t,e,r,n){var i=t.updateQueue;Wn=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var c=t.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==a&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,c=u=l=null,o=s;do{var f=o.lane,d=o.eventTime;if((n&f)===f){c!==null&&(c=c.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=t,p=o;switch(f=e,d=r,p.tag){case 1:if(g=p.payload,typeof g=="function"){h=g.call(d,h,f);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=p.payload,f=typeof g=="function"?g.call(d,h,f):g,f==null)break e;h=tt({},h,f);break e;case 2:Wn=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[o]:f.push(o))}else d={eventTime:d,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=d,l=h):c=c.next=d,a|=f;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;f=o,o=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(c===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Qi|=a,t.lanes=a,t.memoizedState=h}}function eg(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Q(191,i));i.call(n)}}}var Qo={},dn=_i(Qo),Ao=_i(Qo),Oo=_i(Qo);function zi(t){if(t===Qo)throw Error(Q(174));return t}function Yd(t,e){switch(We(Oo,e),We(Ao,t),We(dn,Qo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:hf(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=hf(e,t)}Ge(dn),We(dn,e)}function ra(){Ge(dn),Ge(Ao),Ge(Oo)}function dx(t){zi(Oo.current);var e=zi(dn.current),r=hf(e,t.type);e!==r&&(We(Ao,t),We(dn,r))}function Xd(t){Ao.current===t&&(Ge(dn),Ge(Ao))}var Ze=_i(0);function Nu(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var mh=[];function qd(){for(var t=0;t<mh.length;t++)mh[t]._workInProgressVersionPrimary=null;mh.length=0}var lu=Ln.ReactCurrentDispatcher,vh=Ln.ReactCurrentBatchConfig,Ji=0,et=null,pt=null,vt=null,Lu=!1,Qa=!1,Co=0,KE=0;function Dt(){throw Error(Q(321))}function Jd(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!tn(t[r],e[r]))return!1;return!0}function Qd(t,e,r,n,i,s){if(Ji=s,et=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,lu.current=t===null||t.memoizedState===null?JE:QE,t=r(n,i),Qa){s=0;do{if(Qa=!1,Co=0,25<=s)throw Error(Q(301));s+=1,vt=pt=null,e.updateQueue=null,lu.current=ZE,t=r(n,i)}while(Qa)}if(lu.current=Mu,e=pt!==null&&pt.next!==null,Ji=0,vt=pt=et=null,Lu=!1,e)throw Error(Q(300));return t}function Zd(){var t=Co!==0;return Co=0,t}function un(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?et.memoizedState=vt=t:vt=vt.next=t,vt}function Ir(){if(pt===null){var t=et.alternate;t=t!==null?t.memoizedState:null}else t=pt.next;var e=vt===null?et.memoizedState:vt.next;if(e!==null)vt=e,pt=t;else{if(t===null)throw Error(Q(310));pt=t,t={memoizedState:pt.memoizedState,baseState:pt.baseState,baseQueue:pt.baseQueue,queue:pt.queue,next:null},vt===null?et.memoizedState=vt=t:vt=vt.next=t}return vt}function Po(t,e){return typeof e=="function"?e(t):e}function xh(t){var e=Ir(),r=e.queue;if(r===null)throw Error(Q(311));r.lastRenderedReducer=t;var n=pt,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,u=s;do{var c=u.lane;if((Ji&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,et.lanes|=c,Qi|=c}u=u.next}while(u!==null&&u!==s);l===null?a=n:l.next=o,tn(n,e.memoizedState)||(er=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,et.lanes|=s,Qi|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function _h(t){var e=Ir(),r=e.queue;if(r===null)throw Error(Q(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);tn(s,e.memoizedState)||(er=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function px(){}function gx(t,e){var r=et,n=Ir(),i=e(),s=!tn(n.memoizedState,i);if(s&&(n.memoizedState=i,er=!0),n=n.queue,e0(xx.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||vt!==null&&vt.memoizedState.tag&1){if(r.flags|=2048,Ro(9,vx.bind(null,r,n,i,e),void 0,null),wt===null)throw Error(Q(349));Ji&30||mx(r,e,i)}return i}function mx(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=et.updateQueue,e===null?(e={lastEffect:null,stores:null},et.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function vx(t,e,r,n){e.value=r,e.getSnapshot=n,_x(e)&&yx(t)}function xx(t,e,r){return r(function(){_x(e)&&yx(t)})}function _x(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!tn(t,r)}catch{return!0}}function yx(t){var e=Fn(t,1);e!==null&&Zr(e,t,1,-1)}function tg(t){var e=un();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Po,lastRenderedState:t},e.queue=t,t=t.dispatch=qE.bind(null,et,t),[e.memoizedState,t]}function Ro(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=et.updateQueue,e===null?(e={lastEffect:null,stores:null},et.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function wx(){return Ir().memoizedState}function uu(t,e,r,n){var i=un();et.flags|=t,i.memoizedState=Ro(1|e,r,void 0,n===void 0?null:n)}function Tc(t,e,r,n){var i=Ir();n=n===void 0?null:n;var s=void 0;if(pt!==null){var a=pt.memoizedState;if(s=a.destroy,n!==null&&Jd(n,a.deps)){i.memoizedState=Ro(e,r,s,n);return}}et.flags|=t,i.memoizedState=Ro(1|e,r,s,n)}function rg(t,e){return uu(8390656,8,t,e)}function e0(t,e){return Tc(2048,8,t,e)}function Sx(t,e){return Tc(4,2,t,e)}function Ex(t,e){return Tc(4,4,t,e)}function Tx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function kx(t,e,r){return r=r!=null?r.concat([t]):null,Tc(4,4,Tx.bind(null,e,t),r)}function t0(){}function bx(t,e){var r=Ir();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Jd(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Ax(t,e){var r=Ir();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Jd(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Ox(t,e,r){return Ji&21?(tn(r,e)||(r=Iv(),et.lanes|=r,Qi|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,er=!0),t.memoizedState=r)}function YE(t,e){var r=Me;Me=r!==0&&4>r?r:4,t(!0);var n=vh.transition;vh.transition={};try{t(!1),e()}finally{Me=r,vh.transition=n}}function Cx(){return Ir().memoizedState}function XE(t,e,r){var n=ai(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Px(t))Rx(e,r);else if(r=hx(t,e,r,n),r!==null){var i=Kt();Zr(r,t,n,i),Fx(r,e,n)}}function qE(t,e,r){var n=ai(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Px(t))Rx(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,tn(o,a)){var l=e.interleaved;l===null?(i.next=i,Gd(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=hx(t,e,i,n),r!==null&&(i=Kt(),Zr(r,t,n,i),Fx(r,e,n))}}function Px(t){var e=t.alternate;return t===et||e!==null&&e===et}function Rx(t,e){Qa=Lu=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Fx(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Fd(t,r)}}var Mu={readContext:Fr,useCallback:Dt,useContext:Dt,useEffect:Dt,useImperativeHandle:Dt,useInsertionEffect:Dt,useLayoutEffect:Dt,useMemo:Dt,useReducer:Dt,useRef:Dt,useState:Dt,useDebugValue:Dt,useDeferredValue:Dt,useTransition:Dt,useMutableSource:Dt,useSyncExternalStore:Dt,useId:Dt,unstable_isNewReconciler:!1},JE={readContext:Fr,useCallback:function(t,e){return un().memoizedState=[t,e===void 0?null:e],t},useContext:Fr,useEffect:rg,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,uu(4194308,4,Tx.bind(null,e,t),r)},useLayoutEffect:function(t,e){return uu(4194308,4,t,e)},useInsertionEffect:function(t,e){return uu(4,2,t,e)},useMemo:function(t,e){var r=un();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=un();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=XE.bind(null,et,t),[n.memoizedState,t]},useRef:function(t){var e=un();return t={current:t},e.memoizedState=t},useState:tg,useDebugValue:t0,useDeferredValue:function(t){return un().memoizedState=t},useTransition:function(){var t=tg(!1),e=t[0];return t=YE.bind(null,t[1]),un().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=et,i=un();if(Xe){if(r===void 0)throw Error(Q(407));r=r()}else{if(r=e(),wt===null)throw Error(Q(349));Ji&30||mx(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,rg(xx.bind(null,n,s,t),[t]),n.flags|=2048,Ro(9,vx.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=un(),e=wt.identifierPrefix;if(Xe){var r=kn,n=Tn;r=(n&~(1<<32-Qr(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Co++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=KE++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},QE={readContext:Fr,useCallback:bx,useContext:Fr,useEffect:e0,useImperativeHandle:kx,useInsertionEffect:Sx,useLayoutEffect:Ex,useMemo:Ax,useReducer:xh,useRef:wx,useState:function(){return xh(Po)},useDebugValue:t0,useDeferredValue:function(t){var e=Ir();return Ox(e,pt.memoizedState,t)},useTransition:function(){var t=xh(Po)[0],e=Ir().memoizedState;return[t,e]},useMutableSource:px,useSyncExternalStore:gx,useId:Cx,unstable_isNewReconciler:!1},ZE={readContext:Fr,useCallback:bx,useContext:Fr,useEffect:e0,useImperativeHandle:kx,useInsertionEffect:Sx,useLayoutEffect:Ex,useMemo:Ax,useReducer:_h,useRef:wx,useState:function(){return _h(Po)},useDebugValue:t0,useDeferredValue:function(t){var e=Ir();return pt===null?e.memoizedState=t:Ox(e,pt.memoizedState,t)},useTransition:function(){var t=_h(Po)[0],e=Ir().memoizedState;return[t,e]},useMutableSource:px,useSyncExternalStore:gx,useId:Cx,unstable_isNewReconciler:!1};function Wr(t,e){if(t&&t.defaultProps){e=tt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Ff(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:tt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var kc={isMounted:function(t){return(t=t._reactInternals)?ss(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Kt(),i=ai(t),s=bn(n,i);s.payload=e,r!=null&&(s.callback=r),e=ii(t,s,i),e!==null&&(Zr(e,t,i,n),ou(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Kt(),i=ai(t),s=bn(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=ii(t,s,i),e!==null&&(Zr(e,t,i,n),ou(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Kt(),n=ai(t),i=bn(r,n);i.tag=2,e!=null&&(i.callback=e),e=ii(t,i,n),e!==null&&(Zr(e,t,n,r),ou(e,t,n))}};function ng(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Eo(r,n)||!Eo(i,s):!0}function Ix(t,e,r){var n=!1,i=fi,s=e.contextType;return typeof s=="object"&&s!==null?s=Fr(s):(i=rr(e)?Xi:zt.current,n=e.contextTypes,s=(n=n!=null)?Zs(t,i):fi),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=kc,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function ig(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&kc.enqueueReplaceState(e,e.state,null)}function If(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},Kd(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Fr(s):(s=rr(e)?Xi:zt.current,i.context=Zs(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Ff(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&kc.enqueueReplaceState(i,i.state,null),Du(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function na(t,e){try{var r="",n=e;do r+=AS(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function yh(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Df(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var eT=typeof WeakMap=="function"?WeakMap:Map;function Dx(t,e,r){r=bn(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){ju||(ju=!0,Hf=n),Df(t,e)},r}function Nx(t,e,r){r=bn(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Df(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Df(t,e),typeof n!="function"&&(si===null?si=new Set([this]):si.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function sg(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new eT;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=pT.bind(null,t,e,r),e.then(t,t))}function ag(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function og(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=bn(-1,1),e.tag=2,ii(r,e,1))),r.lanes|=1),t)}var tT=Ln.ReactCurrentOwner,er=!1;function Wt(t,e,r,n){e.child=t===null?cx(e,null,r,n):ta(e,t.child,r,n)}function lg(t,e,r,n,i){r=r.render;var s=e.ref;return Ws(e,i),n=Qd(t,e,r,n,s,i),r=Zd(),t!==null&&!er?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,In(t,e,i)):(Xe&&r&&Ud(e),e.flags|=1,Wt(t,e,n,i),e.child)}function ug(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!u0(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,Lx(t,e,s,n,i)):(t=du(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Eo,r(a,n)&&t.ref===e.ref)return In(t,e,i)}return e.flags|=1,t=oi(s,n),t.ref=e.ref,t.return=e,e.child=t}function Lx(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Eo(s,n)&&t.ref===e.ref)if(er=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(er=!0);else return e.lanes=t.lanes,In(t,e,i)}return Nf(t,e,r,n,i)}function Mx(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},We(Ls,ur),ur|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,We(Ls,ur),ur|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,We(Ls,ur),ur|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,We(Ls,ur),ur|=n;return Wt(t,e,i,r),e.child}function Bx(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Nf(t,e,r,n,i){var s=rr(r)?Xi:zt.current;return s=Zs(e,s),Ws(e,i),r=Qd(t,e,r,n,s,i),n=Zd(),t!==null&&!er?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,In(t,e,i)):(Xe&&n&&Ud(e),e.flags|=1,Wt(t,e,r,i),e.child)}function cg(t,e,r,n,i){if(rr(r)){var s=!0;Cu(e)}else s=!1;if(Ws(e,i),e.stateNode===null)cu(t,e),Ix(e,r,n),If(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=Fr(u):(u=rr(r)?Xi:zt.current,u=Zs(e,u));var c=r.getDerivedStateFromProps,h=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&ig(e,a,n,u),Wn=!1;var f=e.memoizedState;a.state=f,Du(e,n,a,i),l=e.memoizedState,o!==n||f!==l||tr.current||Wn?(typeof c=="function"&&(Ff(e,r,c,n),l=e.memoizedState),(o=Wn||ng(e,r,o,n,f,l,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,fx(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:Wr(e.type,o),a.props=u,h=e.pendingProps,f=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Fr(l):(l=rr(r)?Xi:zt.current,l=Zs(e,l));var d=r.getDerivedStateFromProps;(c=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||f!==l)&&ig(e,a,n,l),Wn=!1,f=e.memoizedState,a.state=f,Du(e,n,a,i);var g=e.memoizedState;o!==h||f!==g||tr.current||Wn?(typeof d=="function"&&(Ff(e,r,d,n),g=e.memoizedState),(u=Wn||ng(e,r,u,n,f,g,l)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,g,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,g,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),a.props=n,a.state=g,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return Lf(t,e,r,n,s,i)}function Lf(t,e,r,n,i,s){Bx(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&Xp(e,r,!1),In(t,e,s);n=e.stateNode,tT.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=ta(e,t.child,null,s),e.child=ta(e,null,o,s)):Wt(t,e,o,s),e.memoizedState=n.state,i&&Xp(e,r,!0),e.child}function jx(t){var e=t.stateNode;e.pendingContext?Yp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Yp(t,e.context,!1),Yd(t,e.containerInfo)}function hg(t,e,r,n,i){return ea(),zd(i),e.flags|=256,Wt(t,e,r,n),e.child}var Mf={dehydrated:null,treeContext:null,retryLane:0};function Bf(t){return{baseLanes:t,cachePool:null,transitions:null}}function Ux(t,e,r){var n=e.pendingProps,i=Ze.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),We(Ze,i&1),t===null)return Pf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Oc(a,n,0,null),t=Gi(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Bf(r),e.memoizedState=Mf,t):r0(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return rT(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=oi(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=oi(o,s):(s=Gi(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?Bf(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=Mf,n}return s=t.child,t=s.sibling,n=oi(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function r0(t,e){return e=Oc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Sl(t,e,r,n){return n!==null&&zd(n),ta(e,t.child,null,r),t=r0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function rT(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=yh(Error(Q(422))),Sl(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=Oc({mode:"visible",children:n.children},i,0,null),s=Gi(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&ta(e,t.child,null,a),e.child.memoizedState=Bf(a),e.memoizedState=Mf,s);if(!(e.mode&1))return Sl(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Q(419)),n=yh(s,n,void 0),Sl(t,e,a,n)}if(o=(a&t.childLanes)!==0,er||o){if(n=wt,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Fn(t,i),Zr(n,t,i,-1))}return l0(),n=yh(Error(Q(421))),Sl(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=gT.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,gr=ni(i.nextSibling),mr=e,Xe=!0,Gr=null,t!==null&&(Ar[Or++]=Tn,Ar[Or++]=kn,Ar[Or++]=qi,Tn=t.id,kn=t.overflow,qi=e),e=r0(e,n.children),e.flags|=4096,e)}function fg(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Rf(t.return,e,r)}function wh(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function $x(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(Wt(t,e,n.children,r),n=Ze.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&fg(t,r,e);else if(t.tag===19)fg(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(We(Ze,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Nu(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),wh(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Nu(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}wh(e,!0,r,null,s);break;case"together":wh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function cu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function In(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Qi|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Q(153));if(e.child!==null){for(t=e.child,r=oi(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=oi(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function nT(t,e,r){switch(e.tag){case 3:jx(e),ea();break;case 5:dx(e);break;case 1:rr(e.type)&&Cu(e);break;case 4:Yd(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;We(Fu,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(We(Ze,Ze.current&1),e.flags|=128,null):r&e.child.childLanes?Ux(t,e,r):(We(Ze,Ze.current&1),t=In(t,e,r),t!==null?t.sibling:null);We(Ze,Ze.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return $x(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),We(Ze,Ze.current),n)break;return null;case 22:case 23:return e.lanes=0,Mx(t,e,r)}return In(t,e,r)}var zx,jf,Wx,Hx;zx=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};jf=function(){};Wx=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,zi(dn.current);var s=null;switch(r){case"input":i=of(t,i),n=of(t,n),s=[];break;case"select":i=tt({},i,{value:void 0}),n=tt({},n,{value:void 0}),s=[];break;case"textarea":i=cf(t,i),n=cf(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Au)}ff(r,n);var a;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(mo.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(mo.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&He("scroll",t),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};Hx=function(t,e,r,n){r!==n&&(e.flags|=4)};function Pa(t,e){if(!Xe)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Nt(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function iT(t,e,r){var n=e.pendingProps;switch($d(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(e),null;case 1:return rr(e.type)&&Ou(),Nt(e),null;case 3:return n=e.stateNode,ra(),Ge(tr),Ge(zt),qd(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(yl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Gr!==null&&(Kf(Gr),Gr=null))),jf(t,e),Nt(e),null;case 5:Xd(e);var i=zi(Oo.current);if(r=e.type,t!==null&&e.stateNode!=null)Wx(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Q(166));return Nt(e),null}if(t=zi(dn.current),yl(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[hn]=e,n[bo]=s,t=(e.mode&1)!==0,r){case"dialog":He("cancel",n),He("close",n);break;case"iframe":case"object":case"embed":He("load",n);break;case"video":case"audio":for(i=0;i<$a.length;i++)He($a[i],n);break;case"source":He("error",n);break;case"img":case"image":case"link":He("error",n),He("load",n);break;case"details":He("toggle",n);break;case"input":wp(n,s),He("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},He("invalid",n);break;case"textarea":Ep(n,s),He("invalid",n)}ff(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&_l(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&_l(n.textContent,o,t),i=["children",""+o]):mo.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&He("scroll",n)}switch(r){case"input":hl(n),Sp(n,s,!0);break;case"textarea":hl(n),Tp(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Au)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=xv(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[hn]=e,t[bo]=n,zx(t,e,!1,!1),e.stateNode=t;e:{switch(a=df(r,n),r){case"dialog":He("cancel",t),He("close",t),i=n;break;case"iframe":case"object":case"embed":He("load",t),i=n;break;case"video":case"audio":for(i=0;i<$a.length;i++)He($a[i],t);i=n;break;case"source":He("error",t),i=n;break;case"img":case"image":case"link":He("error",t),He("load",t),i=n;break;case"details":He("toggle",t),i=n;break;case"input":wp(t,n),i=of(t,n),He("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=tt({},n,{value:void 0}),He("invalid",t);break;case"textarea":Ep(t,n),i=cf(t,n),He("invalid",t);break;default:i=n}ff(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?wv(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&_v(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&vo(t,l):typeof l=="number"&&vo(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(mo.hasOwnProperty(s)?l!=null&&s==="onScroll"&&He("scroll",t):l!=null&&bd(t,s,l,a))}switch(r){case"input":hl(t),Sp(t,n,!1);break;case"textarea":hl(t),Tp(t);break;case"option":n.value!=null&&t.setAttribute("value",""+hi(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?js(t,!!n.multiple,s,!1):n.defaultValue!=null&&js(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Au)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Nt(e),null;case 6:if(t&&e.stateNode!=null)Hx(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Q(166));if(r=zi(Oo.current),zi(dn.current),yl(e)){if(n=e.stateNode,r=e.memoizedProps,n[hn]=e,(s=n.nodeValue!==r)&&(t=mr,t!==null))switch(t.tag){case 3:_l(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&_l(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[hn]=e,e.stateNode=n}return Nt(e),null;case 13:if(Ge(Ze),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Xe&&gr!==null&&e.mode&1&&!(e.flags&128))lx(),ea(),e.flags|=98560,s=!1;else if(s=yl(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Q(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Q(317));s[hn]=e}else ea(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Nt(e),s=!1}else Gr!==null&&(Kf(Gr),Gr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Ze.current&1?mt===0&&(mt=3):l0())),e.updateQueue!==null&&(e.flags|=4),Nt(e),null);case 4:return ra(),jf(t,e),t===null&&To(e.stateNode.containerInfo),Nt(e),null;case 10:return Vd(e.type._context),Nt(e),null;case 17:return rr(e.type)&&Ou(),Nt(e),null;case 19:if(Ge(Ze),s=e.memoizedState,s===null)return Nt(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)Pa(s,!1);else{if(mt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Nu(t),a!==null){for(e.flags|=128,Pa(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return We(Ze,Ze.current&1|2),e.child}t=t.sibling}s.tail!==null&&st()>ia&&(e.flags|=128,n=!0,Pa(s,!1),e.lanes=4194304)}else{if(!n)if(t=Nu(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Pa(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Xe)return Nt(e),null}else 2*st()-s.renderingStartTime>ia&&r!==1073741824&&(e.flags|=128,n=!0,Pa(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=st(),e.sibling=null,r=Ze.current,We(Ze,n?r&1|2:r&1),e):(Nt(e),null);case 22:case 23:return o0(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?ur&1073741824&&(Nt(e),e.subtreeFlags&6&&(e.flags|=8192)):Nt(e),null;case 24:return null;case 25:return null}throw Error(Q(156,e.tag))}function sT(t,e){switch($d(e),e.tag){case 1:return rr(e.type)&&Ou(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ra(),Ge(tr),Ge(zt),qd(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Xd(e),null;case 13:if(Ge(Ze),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Q(340));ea()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ge(Ze),null;case 4:return ra(),null;case 10:return Vd(e.type._context),null;case 22:case 23:return o0(),null;case 24:return null;default:return null}}var El=!1,Mt=!1,aT=typeof WeakSet=="function"?WeakSet:Set,ce=null;function Ns(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){rt(t,e,n)}else r.current=null}function Uf(t,e,r){try{r()}catch(n){rt(t,e,n)}}var dg=!1;function oT(t,e){if(Ef=Tu,t=Xv(),jd(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,u=0,c=0,h=t,f=null;t:for(;;){for(var d;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(d=h.firstChild)!==null;)f=h,h=d;for(;;){if(h===t)break t;if(f===r&&++u===i&&(o=a),f===s&&++c===n&&(l=a),(d=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=d}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Tf={focusedElem:t,selectionRange:r},Tu=!1,ce=e;ce!==null;)if(e=ce,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ce=t;else for(;ce!==null;){e=ce;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var p=g.memoizedProps,m=g.memoizedState,v=e.stateNode,x=v.getSnapshotBeforeUpdate(e.elementType===e.type?p:Wr(e.type,p),m);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Q(163))}}catch(w){rt(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,ce=t;break}ce=e.return}return g=dg,dg=!1,g}function Za(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Uf(e,r,s)}i=i.next}while(i!==n)}}function bc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function $f(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function Vx(t){var e=t.alternate;e!==null&&(t.alternate=null,Vx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[hn],delete e[bo],delete e[Af],delete e[WE],delete e[HE])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Gx(t){return t.tag===5||t.tag===3||t.tag===4}function pg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Gx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function zf(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Au));else if(n!==4&&(t=t.child,t!==null))for(zf(t,e,r),t=t.sibling;t!==null;)zf(t,e,r),t=t.sibling}function Wf(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Wf(t,e,r),t=t.sibling;t!==null;)Wf(t,e,r),t=t.sibling}var kt=null,Vr=!1;function Bn(t,e,r){for(r=r.child;r!==null;)Kx(t,e,r),r=r.sibling}function Kx(t,e,r){if(fn&&typeof fn.onCommitFiberUnmount=="function")try{fn.onCommitFiberUnmount(xc,r)}catch{}switch(r.tag){case 5:Mt||Ns(r,e);case 6:var n=kt,i=Vr;kt=null,Bn(t,e,r),kt=n,Vr=i,kt!==null&&(Vr?(t=kt,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):kt.removeChild(r.stateNode));break;case 18:kt!==null&&(Vr?(t=kt,r=r.stateNode,t.nodeType===8?ph(t.parentNode,r):t.nodeType===1&&ph(t,r),wo(t)):ph(kt,r.stateNode));break;case 4:n=kt,i=Vr,kt=r.stateNode.containerInfo,Vr=!0,Bn(t,e,r),kt=n,Vr=i;break;case 0:case 11:case 14:case 15:if(!Mt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Uf(r,e,a),i=i.next}while(i!==n)}Bn(t,e,r);break;case 1:if(!Mt&&(Ns(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){rt(r,e,o)}Bn(t,e,r);break;case 21:Bn(t,e,r);break;case 22:r.mode&1?(Mt=(n=Mt)||r.memoizedState!==null,Bn(t,e,r),Mt=n):Bn(t,e,r);break;default:Bn(t,e,r)}}function gg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new aT),e.forEach(function(n){var i=mT.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Br(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:kt=o.stateNode,Vr=!1;break e;case 3:kt=o.stateNode.containerInfo,Vr=!0;break e;case 4:kt=o.stateNode.containerInfo,Vr=!0;break e}o=o.return}if(kt===null)throw Error(Q(160));Kx(s,a,i),kt=null,Vr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){rt(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Yx(e,t),e=e.sibling}function Yx(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Br(e,t),nn(t),n&4){try{Za(3,t,t.return),bc(3,t)}catch(p){rt(t,t.return,p)}try{Za(5,t,t.return)}catch(p){rt(t,t.return,p)}}break;case 1:Br(e,t),nn(t),n&512&&r!==null&&Ns(r,r.return);break;case 5:if(Br(e,t),nn(t),n&512&&r!==null&&Ns(r,r.return),t.flags&32){var i=t.stateNode;try{vo(i,"")}catch(p){rt(t,t.return,p)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&mv(i,s),df(o,a);var u=df(o,s);for(a=0;a<l.length;a+=2){var c=l[a],h=l[a+1];c==="style"?wv(i,h):c==="dangerouslySetInnerHTML"?_v(i,h):c==="children"?vo(i,h):bd(i,c,h,u)}switch(o){case"input":lf(i,s);break;case"textarea":vv(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var d=s.value;d!=null?js(i,!!s.multiple,d,!1):f!==!!s.multiple&&(s.defaultValue!=null?js(i,!!s.multiple,s.defaultValue,!0):js(i,!!s.multiple,s.multiple?[]:"",!1))}i[bo]=s}catch(p){rt(t,t.return,p)}}break;case 6:if(Br(e,t),nn(t),n&4){if(t.stateNode===null)throw Error(Q(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(p){rt(t,t.return,p)}}break;case 3:if(Br(e,t),nn(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{wo(e.containerInfo)}catch(p){rt(t,t.return,p)}break;case 4:Br(e,t),nn(t);break;case 13:Br(e,t),nn(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(s0=st())),n&4&&gg(t);break;case 22:if(c=r!==null&&r.memoizedState!==null,t.mode&1?(Mt=(u=Mt)||c,Br(e,t),Mt=u):Br(e,t),nn(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(ce=t,c=t.child;c!==null;){for(h=ce=c;ce!==null;){switch(f=ce,d=f.child,f.tag){case 0:case 11:case 14:case 15:Za(4,f,f.return);break;case 1:Ns(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){n=f,r=f.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(p){rt(n,r,p)}}break;case 5:Ns(f,f.return);break;case 22:if(f.memoizedState!==null){vg(h);continue}}d!==null?(d.return=f,ce=d):vg(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=yv("display",a))}catch(p){rt(t,t.return,p)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(p){rt(t,t.return,p)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Br(e,t),nn(t),n&4&&gg(t);break;case 21:break;default:Br(e,t),nn(t)}}function nn(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Gx(r)){var n=r;break e}r=r.return}throw Error(Q(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(vo(i,""),n.flags&=-33);var s=pg(t);Wf(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=pg(t);zf(t,o,a);break;default:throw Error(Q(161))}}catch(l){rt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function lT(t,e,r){ce=t,Xx(t)}function Xx(t,e,r){for(var n=(t.mode&1)!==0;ce!==null;){var i=ce,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||El;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Mt;o=El;var u=Mt;if(El=a,(Mt=l)&&!u)for(ce=i;ce!==null;)a=ce,l=a.child,a.tag===22&&a.memoizedState!==null?xg(i):l!==null?(l.return=a,ce=l):xg(i);for(;s!==null;)ce=s,Xx(s),s=s.sibling;ce=i,El=o,Mt=u}mg(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ce=s):mg(t)}}function mg(t){for(;ce!==null;){var e=ce;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Mt||bc(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Mt)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Wr(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&eg(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}eg(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&wo(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Q(163))}Mt||e.flags&512&&$f(e)}catch(f){rt(e,e.return,f)}}if(e===t){ce=null;break}if(r=e.sibling,r!==null){r.return=e.return,ce=r;break}ce=e.return}}function vg(t){for(;ce!==null;){var e=ce;if(e===t){ce=null;break}var r=e.sibling;if(r!==null){r.return=e.return,ce=r;break}ce=e.return}}function xg(t){for(;ce!==null;){var e=ce;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{bc(4,e)}catch(l){rt(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){rt(e,i,l)}}var s=e.return;try{$f(e)}catch(l){rt(e,s,l)}break;case 5:var a=e.return;try{$f(e)}catch(l){rt(e,a,l)}}}catch(l){rt(e,e.return,l)}if(e===t){ce=null;break}var o=e.sibling;if(o!==null){o.return=e.return,ce=o;break}ce=e.return}}var uT=Math.ceil,Bu=Ln.ReactCurrentDispatcher,n0=Ln.ReactCurrentOwner,Rr=Ln.ReactCurrentBatchConfig,be=0,wt=null,ut=null,Ct=0,ur=0,Ls=_i(0),mt=0,Fo=null,Qi=0,Ac=0,i0=0,eo=null,Qt=null,s0=0,ia=1/0,yn=null,ju=!1,Hf=null,si=null,Tl=!1,Yn=null,Uu=0,to=0,Vf=null,hu=-1,fu=0;function Kt(){return be&6?st():hu!==-1?hu:hu=st()}function ai(t){return t.mode&1?be&2&&Ct!==0?Ct&-Ct:GE.transition!==null?(fu===0&&(fu=Iv()),fu):(t=Me,t!==0||(t=window.event,t=t===void 0?16:Uv(t.type)),t):1}function Zr(t,e,r,n){if(50<to)throw to=0,Vf=null,Error(Q(185));Xo(t,r,n),(!(be&2)||t!==wt)&&(t===wt&&(!(be&2)&&(Ac|=r),mt===4&&Vn(t,Ct)),nr(t,n),r===1&&be===0&&!(e.mode&1)&&(ia=st()+500,Ec&&yi()))}function nr(t,e){var r=t.callbackNode;GS(t,e);var n=Eu(t,t===wt?Ct:0);if(n===0)r!==null&&Ap(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Ap(r),e===1)t.tag===0?VE(_g.bind(null,t)):sx(_g.bind(null,t)),$E(function(){!(be&6)&&yi()}),r=null;else{switch(Dv(n)){case 1:r=Rd;break;case 4:r=Rv;break;case 16:r=Su;break;case 536870912:r=Fv;break;default:r=Su}r=n_(r,qx.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function qx(t,e){if(hu=-1,fu=0,be&6)throw Error(Q(327));var r=t.callbackNode;if(Hs()&&t.callbackNode!==r)return null;var n=Eu(t,t===wt?Ct:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=$u(t,n);else{e=n;var i=be;be|=2;var s=Qx();(wt!==t||Ct!==e)&&(yn=null,ia=st()+500,Vi(t,e));do try{fT();break}catch(o){Jx(t,o)}while(!0);Hd(),Bu.current=s,be=i,ut!==null?e=0:(wt=null,Ct=0,e=mt)}if(e!==0){if(e===2&&(i=xf(t),i!==0&&(n=i,e=Gf(t,i))),e===1)throw r=Fo,Vi(t,0),Vn(t,n),nr(t,st()),r;if(e===6)Vn(t,n);else{if(i=t.current.alternate,!(n&30)&&!cT(i)&&(e=$u(t,n),e===2&&(s=xf(t),s!==0&&(n=s,e=Gf(t,s))),e===1))throw r=Fo,Vi(t,0),Vn(t,n),nr(t,st()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Q(345));case 2:Ii(t,Qt,yn);break;case 3:if(Vn(t,n),(n&130023424)===n&&(e=s0+500-st(),10<e)){if(Eu(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Kt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=bf(Ii.bind(null,t,Qt,yn),e);break}Ii(t,Qt,yn);break;case 4:if(Vn(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-Qr(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=st()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*uT(n/1960))-n,10<n){t.timeoutHandle=bf(Ii.bind(null,t,Qt,yn),n);break}Ii(t,Qt,yn);break;case 5:Ii(t,Qt,yn);break;default:throw Error(Q(329))}}}return nr(t,st()),t.callbackNode===r?qx.bind(null,t):null}function Gf(t,e){var r=eo;return t.current.memoizedState.isDehydrated&&(Vi(t,e).flags|=256),t=$u(t,e),t!==2&&(e=Qt,Qt=r,e!==null&&Kf(e)),t}function Kf(t){Qt===null?Qt=t:Qt.push.apply(Qt,t)}function cT(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!tn(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Vn(t,e){for(e&=~i0,e&=~Ac,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Qr(e),n=1<<r;t[r]=-1,e&=~n}}function _g(t){if(be&6)throw Error(Q(327));Hs();var e=Eu(t,0);if(!(e&1))return nr(t,st()),null;var r=$u(t,e);if(t.tag!==0&&r===2){var n=xf(t);n!==0&&(e=n,r=Gf(t,n))}if(r===1)throw r=Fo,Vi(t,0),Vn(t,e),nr(t,st()),r;if(r===6)throw Error(Q(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ii(t,Qt,yn),nr(t,st()),null}function a0(t,e){var r=be;be|=1;try{return t(e)}finally{be=r,be===0&&(ia=st()+500,Ec&&yi())}}function Zi(t){Yn!==null&&Yn.tag===0&&!(be&6)&&Hs();var e=be;be|=1;var r=Rr.transition,n=Me;try{if(Rr.transition=null,Me=1,t)return t()}finally{Me=n,Rr.transition=r,be=e,!(be&6)&&yi()}}function o0(){ur=Ls.current,Ge(Ls)}function Vi(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,UE(r)),ut!==null)for(r=ut.return;r!==null;){var n=r;switch($d(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ou();break;case 3:ra(),Ge(tr),Ge(zt),qd();break;case 5:Xd(n);break;case 4:ra();break;case 13:Ge(Ze);break;case 19:Ge(Ze);break;case 10:Vd(n.type._context);break;case 22:case 23:o0()}r=r.return}if(wt=t,ut=t=oi(t.current,null),Ct=ur=e,mt=0,Fo=null,i0=Ac=Qi=0,Qt=eo=null,$i!==null){for(e=0;e<$i.length;e++)if(r=$i[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}$i=null}return t}function Jx(t,e){do{var r=ut;try{if(Hd(),lu.current=Mu,Lu){for(var n=et.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Lu=!1}if(Ji=0,vt=pt=et=null,Qa=!1,Co=0,n0.current=null,r===null||r.return===null){mt=1,Fo=e,ut=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=Ct,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var d=ag(a);if(d!==null){d.flags&=-257,og(d,a,o,s,e),d.mode&1&&sg(s,u,e),e=d,l=u;var g=e.updateQueue;if(g===null){var p=new Set;p.add(l),e.updateQueue=p}else g.add(l);break e}else{if(!(e&1)){sg(s,u,e),l0();break e}l=Error(Q(426))}}else if(Xe&&o.mode&1){var m=ag(a);if(m!==null){!(m.flags&65536)&&(m.flags|=256),og(m,a,o,s,e),zd(na(l,o));break e}}s=l=na(l,o),mt!==4&&(mt=2),eo===null?eo=[s]:eo.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=Dx(s,l,e);Zp(s,v);break e;case 1:o=l;var x=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(si===null||!si.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=Nx(s,o,e);Zp(s,w);break e}}s=s.return}while(s!==null)}e_(r)}catch(O){e=O,ut===r&&r!==null&&(ut=r=r.return);continue}break}while(!0)}function Qx(){var t=Bu.current;return Bu.current=Mu,t===null?Mu:t}function l0(){(mt===0||mt===3||mt===2)&&(mt=4),wt===null||!(Qi&268435455)&&!(Ac&268435455)||Vn(wt,Ct)}function $u(t,e){var r=be;be|=2;var n=Qx();(wt!==t||Ct!==e)&&(yn=null,Vi(t,e));do try{hT();break}catch(i){Jx(t,i)}while(!0);if(Hd(),be=r,Bu.current=n,ut!==null)throw Error(Q(261));return wt=null,Ct=0,mt}function hT(){for(;ut!==null;)Zx(ut)}function fT(){for(;ut!==null&&!MS();)Zx(ut)}function Zx(t){var e=r_(t.alternate,t,ur);t.memoizedProps=t.pendingProps,e===null?e_(t):ut=e,n0.current=null}function e_(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=sT(r,e),r!==null){r.flags&=32767,ut=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{mt=6,ut=null;return}}else if(r=iT(r,e,ur),r!==null){ut=r;return}if(e=e.sibling,e!==null){ut=e;return}ut=e=t}while(e!==null);mt===0&&(mt=5)}function Ii(t,e,r){var n=Me,i=Rr.transition;try{Rr.transition=null,Me=1,dT(t,e,r,n)}finally{Rr.transition=i,Me=n}return null}function dT(t,e,r,n){do Hs();while(Yn!==null);if(be&6)throw Error(Q(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Q(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(KS(t,s),t===wt&&(ut=wt=null,Ct=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Tl||(Tl=!0,n_(Su,function(){return Hs(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Rr.transition,Rr.transition=null;var a=Me;Me=1;var o=be;be|=4,n0.current=null,oT(t,r),Yx(r,t),IE(Tf),Tu=!!Ef,Tf=Ef=null,t.current=r,lT(r),BS(),be=o,Me=a,Rr.transition=s}else t.current=r;if(Tl&&(Tl=!1,Yn=t,Uu=i),s=t.pendingLanes,s===0&&(si=null),$S(r.stateNode),nr(t,st()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(ju)throw ju=!1,t=Hf,Hf=null,t;return Uu&1&&t.tag!==0&&Hs(),s=t.pendingLanes,s&1?t===Vf?to++:(to=0,Vf=t):to=0,yi(),null}function Hs(){if(Yn!==null){var t=Dv(Uu),e=Rr.transition,r=Me;try{if(Rr.transition=null,Me=16>t?16:t,Yn===null)var n=!1;else{if(t=Yn,Yn=null,Uu=0,be&6)throw Error(Q(331));var i=be;for(be|=4,ce=t.current;ce!==null;){var s=ce,a=s.child;if(ce.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(ce=u;ce!==null;){var c=ce;switch(c.tag){case 0:case 11:case 15:Za(8,c,s)}var h=c.child;if(h!==null)h.return=c,ce=h;else for(;ce!==null;){c=ce;var f=c.sibling,d=c.return;if(Vx(c),c===u){ce=null;break}if(f!==null){f.return=d,ce=f;break}ce=d}}}var g=s.alternate;if(g!==null){var p=g.child;if(p!==null){g.child=null;do{var m=p.sibling;p.sibling=null,p=m}while(p!==null)}}ce=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,ce=a;else e:for(;ce!==null;){if(s=ce,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Za(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,ce=v;break e}ce=s.return}}var x=t.current;for(ce=x;ce!==null;){a=ce;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,ce=_;else e:for(a=x;ce!==null;){if(o=ce,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:bc(9,o)}}catch(O){rt(o,o.return,O)}if(o===a){ce=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,ce=w;break e}ce=o.return}}if(be=i,yi(),fn&&typeof fn.onPostCommitFiberRoot=="function")try{fn.onPostCommitFiberRoot(xc,t)}catch{}n=!0}return n}finally{Me=r,Rr.transition=e}}return!1}function yg(t,e,r){e=na(r,e),e=Dx(t,e,1),t=ii(t,e,1),e=Kt(),t!==null&&(Xo(t,1,e),nr(t,e))}function rt(t,e,r){if(t.tag===3)yg(t,t,r);else for(;e!==null;){if(e.tag===3){yg(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(si===null||!si.has(n))){t=na(r,t),t=Nx(e,t,1),e=ii(e,t,1),t=Kt(),e!==null&&(Xo(e,1,t),nr(e,t));break}}e=e.return}}function pT(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Kt(),t.pingedLanes|=t.suspendedLanes&r,wt===t&&(Ct&r)===r&&(mt===4||mt===3&&(Ct&130023424)===Ct&&500>st()-s0?Vi(t,0):i0|=r),nr(t,e)}function t_(t,e){e===0&&(t.mode&1?(e=pl,pl<<=1,!(pl&130023424)&&(pl=4194304)):e=1);var r=Kt();t=Fn(t,e),t!==null&&(Xo(t,e,r),nr(t,r))}function gT(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),t_(t,r)}function mT(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Q(314))}n!==null&&n.delete(e),t_(t,r)}var r_;r_=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||tr.current)er=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return er=!1,nT(t,e,r);er=!!(t.flags&131072)}else er=!1,Xe&&e.flags&1048576&&ax(e,Ru,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;cu(t,e),t=e.pendingProps;var i=Zs(e,zt.current);Ws(e,r),i=Qd(null,e,n,t,i,r);var s=Zd();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,rr(n)?(s=!0,Cu(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Kd(e),i.updater=kc,e.stateNode=i,i._reactInternals=e,If(e,n,t,r),e=Lf(null,e,n,!0,s,r)):(e.tag=0,Xe&&s&&Ud(e),Wt(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(cu(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=xT(n),t=Wr(n,t),i){case 0:e=Nf(null,e,n,t,r);break e;case 1:e=cg(null,e,n,t,r);break e;case 11:e=lg(null,e,n,t,r);break e;case 14:e=ug(null,e,n,Wr(n.type,t),r);break e}throw Error(Q(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Wr(n,i),Nf(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Wr(n,i),cg(t,e,n,i,r);case 3:e:{if(jx(e),t===null)throw Error(Q(387));n=e.pendingProps,s=e.memoizedState,i=s.element,fx(t,e),Du(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=na(Error(Q(423)),e),e=hg(t,e,n,r,i);break e}else if(n!==i){i=na(Error(Q(424)),e),e=hg(t,e,n,r,i);break e}else for(gr=ni(e.stateNode.containerInfo.firstChild),mr=e,Xe=!0,Gr=null,r=cx(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ea(),n===i){e=In(t,e,r);break e}Wt(t,e,n,r)}e=e.child}return e;case 5:return dx(e),t===null&&Pf(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,kf(n,i)?a=null:s!==null&&kf(n,s)&&(e.flags|=32),Bx(t,e),Wt(t,e,a,r),e.child;case 6:return t===null&&Pf(e),null;case 13:return Ux(t,e,r);case 4:return Yd(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=ta(e,null,n,r):Wt(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Wr(n,i),lg(t,e,n,i,r);case 7:return Wt(t,e,e.pendingProps,r),e.child;case 8:return Wt(t,e,e.pendingProps.children,r),e.child;case 12:return Wt(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,We(Fu,n._currentValue),n._currentValue=a,s!==null)if(tn(s.value,a)){if(s.children===i.children&&!tr.current){e=In(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=bn(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Rf(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Q(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Rf(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Wt(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Ws(e,r),i=Fr(i),n=n(i),e.flags|=1,Wt(t,e,n,r),e.child;case 14:return n=e.type,i=Wr(n,e.pendingProps),i=Wr(n.type,i),ug(t,e,n,i,r);case 15:return Lx(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Wr(n,i),cu(t,e),e.tag=1,rr(n)?(t=!0,Cu(e)):t=!1,Ws(e,r),Ix(e,n,i),If(e,n,i,r),Lf(null,e,n,!0,t,r);case 19:return $x(t,e,r);case 22:return Mx(t,e,r)}throw Error(Q(156,e.tag))};function n_(t,e){return Pv(t,e)}function vT(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cr(t,e,r,n){return new vT(t,e,r,n)}function u0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function xT(t){if(typeof t=="function")return u0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Od)return 11;if(t===Cd)return 14}return 2}function oi(t,e){var r=t.alternate;return r===null?(r=Cr(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function du(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")u0(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case bs:return Gi(r.children,i,s,e);case Ad:a=8,i|=8;break;case rf:return t=Cr(12,r,e,i|2),t.elementType=rf,t.lanes=s,t;case nf:return t=Cr(13,r,e,i),t.elementType=nf,t.lanes=s,t;case sf:return t=Cr(19,r,e,i),t.elementType=sf,t.lanes=s,t;case dv:return Oc(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case hv:a=10;break e;case fv:a=9;break e;case Od:a=11;break e;case Cd:a=14;break e;case zn:a=16,n=null;break e}throw Error(Q(130,t==null?t:typeof t,""))}return e=Cr(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function Gi(t,e,r,n){return t=Cr(7,t,n,e),t.lanes=r,t}function Oc(t,e,r,n){return t=Cr(22,t,n,e),t.elementType=dv,t.lanes=r,t.stateNode={isHidden:!1},t}function Sh(t,e,r){return t=Cr(6,t,null,e),t.lanes=r,t}function Eh(t,e,r){return e=Cr(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function _T(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nh(0),this.expirationTimes=nh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nh(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function c0(t,e,r,n,i,s,a,o,l){return t=new _T(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Cr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Kd(s),t}function yT(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ks,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function i_(t){if(!t)return fi;t=t._reactInternals;e:{if(ss(t)!==t||t.tag!==1)throw Error(Q(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(rr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Q(171))}if(t.tag===1){var r=t.type;if(rr(r))return ix(t,r,e)}return e}function s_(t,e,r,n,i,s,a,o,l){return t=c0(r,n,!0,t,i,s,a,o,l),t.context=i_(null),r=t.current,n=Kt(),i=ai(r),s=bn(n,i),s.callback=e??null,ii(r,s,i),t.current.lanes=i,Xo(t,i,n),nr(t,n),t}function Cc(t,e,r,n){var i=e.current,s=Kt(),a=ai(i);return r=i_(r),e.context===null?e.context=r:e.pendingContext=r,e=bn(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=ii(i,e,a),t!==null&&(Zr(t,i,a,s),ou(t,i,a)),a}function zu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function wg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function h0(t,e){wg(t,e),(t=t.alternate)&&wg(t,e)}function wT(){return null}var a_=typeof reportError=="function"?reportError:function(t){console.error(t)};function f0(t){this._internalRoot=t}Pc.prototype.render=f0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Q(409));Cc(t,e,null,null)};Pc.prototype.unmount=f0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Zi(function(){Cc(null,t,null,null)}),e[Rn]=null}};function Pc(t){this._internalRoot=t}Pc.prototype.unstable_scheduleHydration=function(t){if(t){var e=Mv();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Hn.length&&e!==0&&e<Hn[r].priority;r++);Hn.splice(r,0,t),r===0&&jv(t)}};function d0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Rc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Sg(){}function ST(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=zu(a);s.call(u)}}var a=s_(e,n,t,0,null,!1,!1,"",Sg);return t._reactRootContainer=a,t[Rn]=a.current,To(t.nodeType===8?t.parentNode:t),Zi(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var u=zu(l);o.call(u)}}var l=c0(t,0,!1,null,null,!1,!1,"",Sg);return t._reactRootContainer=l,t[Rn]=l.current,To(t.nodeType===8?t.parentNode:t),Zi(function(){Cc(e,l,r,n)}),l}function Fc(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=zu(a);o.call(l)}}Cc(e,a,t,i)}else a=ST(r,e,t,i,n);return zu(a)}Nv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Ua(e.pendingLanes);r!==0&&(Fd(e,r|1),nr(e,st()),!(be&6)&&(ia=st()+500,yi()))}break;case 13:Zi(function(){var n=Fn(t,1);if(n!==null){var i=Kt();Zr(n,t,1,i)}}),h0(t,1)}};Id=function(t){if(t.tag===13){var e=Fn(t,134217728);if(e!==null){var r=Kt();Zr(e,t,134217728,r)}h0(t,134217728)}};Lv=function(t){if(t.tag===13){var e=ai(t),r=Fn(t,e);if(r!==null){var n=Kt();Zr(r,t,e,n)}h0(t,e)}};Mv=function(){return Me};Bv=function(t,e){var r=Me;try{return Me=t,e()}finally{Me=r}};gf=function(t,e,r){switch(e){case"input":if(lf(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Sc(n);if(!i)throw Error(Q(90));gv(n),lf(n,i)}}}break;case"textarea":vv(t,r);break;case"select":e=r.value,e!=null&&js(t,!!r.multiple,e,!1)}};Tv=a0;kv=Zi;var ET={usingClientEntryPoint:!1,Events:[Jo,Ps,Sc,Sv,Ev,a0]},Ra={findFiberByHostInstance:Ui,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},TT={bundleType:Ra.bundleType,version:Ra.version,rendererPackageName:Ra.rendererPackageName,rendererConfig:Ra.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ln.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Ov(t),t===null?null:t.stateNode},findFiberByHostInstance:Ra.findFiberByHostInstance||wT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kl.isDisabled&&kl.supportsFiber)try{xc=kl.inject(TT),fn=kl}catch{}}_r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ET;_r.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d0(e))throw Error(Q(200));return yT(t,e,null,r)};_r.createRoot=function(t,e){if(!d0(t))throw Error(Q(299));var r=!1,n="",i=a_;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=c0(t,1,!1,null,null,r,!1,n,i),t[Rn]=e.current,To(t.nodeType===8?t.parentNode:t),new f0(e)};_r.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Q(188)):(t=Object.keys(t).join(","),Error(Q(268,t)));return t=Ov(e),t=t===null?null:t.stateNode,t};_r.flushSync=function(t){return Zi(t)};_r.hydrate=function(t,e,r){if(!Rc(e))throw Error(Q(200));return Fc(null,t,e,!0,r)};_r.hydrateRoot=function(t,e,r){if(!d0(t))throw Error(Q(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=a_;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=s_(e,null,t,1,r??null,i,!1,s,a),t[Rn]=e.current,To(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Pc(e)};_r.render=function(t,e,r){if(!Rc(e))throw Error(Q(200));return Fc(null,t,e,!1,r)};_r.unmountComponentAtNode=function(t){if(!Rc(t))throw Error(Q(40));return t._reactRootContainer?(Zi(function(){Fc(null,null,t,!1,function(){t._reactRootContainer=null,t[Rn]=null})}),!0):!1};_r.unstable_batchedUpdates=a0;_r.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Rc(r))throw Error(Q(200));if(t==null||t._reactInternals===void 0)throw Error(Q(38));return Fc(t,e,r,!1,n)};_r.version="18.3.1-next-f1338f8080-20240426";function o_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o_)}catch(t){console.error(t)}}o_(),ov.exports=_r;var kT=ov.exports,Eg=kT;ef.createRoot=Eg.createRoot,ef.hydrateRoot=Eg.hydrateRoot;const bT=({tabs:t,activeTab:e,onSelect:r})=>z.jsx("nav",{className:"tabs","aria-label":"App sections",children:t.map(n=>z.jsx("button",{type:"button",className:`tab-button ${e===n?"tab-button--active":""}`,onClick:()=>r(n),"aria-pressed":e===n,children:n},n))}),AT=({students:t,onAdd:e,onDelete:r,busy:n})=>{const[i,s]=Ue.useState(""),a=o=>{o.preventDefault();const l=i.trim();l&&(e(l),s(""))};return z.jsxs("section",{className:"panel","aria-labelledby":"students-heading",children:[z.jsxs("header",{className:"panel__header",children:[z.jsxs("div",{children:[z.jsx("h2",{id:"students-heading",children:"Students"}),z.jsx("p",{className:"panel__subtitle",children:"Add, review, or remove learners for the class."})]}),z.jsx("span",{className:"badge",children:t.length})]}),z.jsxs("form",{className:"panel__form",onSubmit:a,children:[z.jsxs("label",{className:"field",children:[z.jsx("span",{children:"Student name"}),z.jsx("input",{type:"text",value:i,onChange:o=>s(o.target.value),placeholder:"e.g. Ada Lovelace",disabled:n,required:!0})]}),z.jsx("button",{type:"submit",disabled:n||!i.trim(),children:"Add student"})]}),z.jsx("p",{className:"helper-text",children:"Deleting a student cascades and removes their ratings."}),z.jsxs("ul",{className:"primitive-list",children:[t.map(o=>z.jsxs("li",{className:"list-item",children:[z.jsx("span",{children:o.name}),z.jsx("button",{type:"button",className:"button--danger",onClick:()=>r(o.id),disabled:n,children:"Delete"})]},o.id)),t.length===0&&z.jsx("li",{className:"empty-state",children:"No students yet. Add your first learner above."})]})]})},OT=({subjects:t,onAdd:e,onDelete:r,busy:n})=>{const[i,s]=Ue.useState(""),a=o=>{o.preventDefault();const l=i.trim();l&&(e(l),s(""))};return z.jsxs("section",{className:"panel","aria-labelledby":"subjects-heading",children:[z.jsxs("header",{className:"panel__header",children:[z.jsxs("div",{children:[z.jsx("h2",{id:"subjects-heading",children:"Subjects"}),z.jsx("p",{className:"panel__subtitle",children:"Define the learning objectives you grade against."})]}),z.jsx("span",{className:"badge",children:t.length})]}),z.jsxs("form",{className:"panel__form",onSubmit:a,children:[z.jsxs("label",{className:"field",children:[z.jsx("span",{children:"Subject name"}),z.jsx("input",{type:"text",value:i,onChange:o=>s(o.target.value),placeholder:"e.g. Mathematics",disabled:n,required:!0})]}),z.jsx("button",{type:"submit",disabled:n||!i.trim(),children:"Add subject"})]}),z.jsx("p",{className:"helper-text",children:"Subject names are unique. Use concise labels students understand."}),z.jsxs("ul",{className:"primitive-list",children:[t.map(o=>z.jsxs("li",{className:"list-item",children:[z.jsx("span",{children:o.name}),z.jsx("button",{type:"button",className:"button--danger",onClick:()=>r(o.id),disabled:n,children:"Delete"})]},o.id)),t.length===0&&z.jsx("li",{className:"empty-state",children:"No subjects yet. Add a subject to get started."})]})]})},Kr=["EXCELLENT","MODERATE","LOW"],Yf=["MID","END"],ro={MID:"Mid-year",END:"End-year"};function p0(t,{year:e,term:r}){const n=Number(e);return t.filter(i=>{const s=Number.isFinite(n)?i.year===n:!0,a=r?i.term===r:!0;return s&&a})}function CT(t){const e=new Set(t.map(r=>r.year));return Array.from(e).sort((r,n)=>r-n)}function PT(t,e){const r=p0(t,e),n=Kr.reduce((i,s)=>(i[s]=0,i),{});return r.forEach(i=>{n[i.level]=(n[i.level]??0)+1}),{counts:n,filtered:r}}function RT(t,e,r){const n=p0(t,r),i=Kr.reduce((a,o)=>(a[o]=0,a),{}),s=new Map(e.map(a=>[a.id,{subjectId:a.id,subjectName:a.name,counts:{...i},total:0}]));return n.forEach(a=>{const o=s.get(a.subject_id);o&&(o.counts[a.level]+=1,o.total+=1)}),Array.from(s.values())}function FT(t,e,r){return{students:t.length,subjects:e.length,ratings:r.length}}const IT=({year:t,term:e,onYearChange:r,onTermChange:n,onRefresh:i,availableYears:s,busy:a})=>{const o=new Date().getFullYear(),l=u=>{const c=parseInt(u.target.value,10),h=Number.isNaN(c)?o:c;r(h)};return z.jsxs("div",{className:"controls",role:"group","aria-label":"Year and term filters",children:[z.jsxs("div",{className:"controls__group",children:[z.jsx("label",{htmlFor:"year-input",children:"Year"}),z.jsx("input",{id:"year-input",type:"number",min:"2000",max:"2100",value:t,onChange:l,list:"year-options",disabled:a}),z.jsx("datalist",{id:"year-options",children:s.map(u=>z.jsx("option",{value:u},u))})]}),z.jsxs("div",{className:"controls__group",children:[z.jsx("label",{htmlFor:"term-select",children:"Term"}),z.jsx("select",{id:"term-select",value:e,onChange:u=>n(u.target.value),disabled:a,children:Yf.map(u=>z.jsx("option",{value:u,children:ro[u]},u))})]}),z.jsx("button",{type:"button",className:"button--ghost",onClick:i,disabled:a,children:"Refresh data"})]})},DT=({students:t,subjects:e,ratingLookup:r,onChange:n,year:i,term:s,busy:a,filteredRatings:o})=>{if(t.length===0||e.length===0)return z.jsxs("div",{className:"panel",children:[z.jsx("h2",{children:"Ratings"}),z.jsx("p",{className:"helper-text",children:"Add at least one student and one subject to unlock the ratings grid."})]});const l=["",...Kr],u=o.length;return z.jsxs("section",{className:"panel","aria-labelledby":"ratings-heading",children:[z.jsx("header",{className:"panel__header",children:z.jsxs("div",{children:[z.jsx("h2",{id:"ratings-heading",children:"Ratings"}),z.jsxs("p",{className:"panel__subtitle",children:[u," ratings stored for ",s," ",i,"."]})]})}),z.jsx("div",{className:"helper-text",children:"Select Excellent / Moderate / Low. Choose blank to clear a rating."}),z.jsx("div",{className:"panel__table-wrapper",children:z.jsxs("table",{className:"ratings-table",children:[z.jsx("thead",{children:z.jsxs("tr",{children:[z.jsx("th",{scope:"col",children:"Student"}),e.map(c=>z.jsx("th",{scope:"col",children:c.name},c.id))]})}),z.jsx("tbody",{children:t.map(c=>z.jsxs("tr",{children:[z.jsx("th",{scope:"row",children:c.name}),e.map(h=>{const f=`${c.id}-${h.id}`,d=r.get(f)??"";return z.jsx("td",{children:z.jsx("select",{"aria-label":`Rating for ${c.name} in ${h.name}`,value:d,disabled:a,onChange:g=>n(c.id,h.id,g.target.value||null),children:l.map(g=>z.jsx("option",{value:g,children:g||""},g||"empty"))})},h.id)})]},c.id))})]})})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Zo(t){return t+.5|0}const Xn=(t,e,r)=>Math.max(Math.min(t,r),e);function za(t){return Xn(Zo(t*2.55),0,255)}function li(t){return Xn(Zo(t*255),0,255)}function En(t){return Xn(Zo(t/2.55)/100,0,1)}function Tg(t){return Xn(Zo(t*100),0,100)}const Sr={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Xf=[..."0123456789ABCDEF"],NT=t=>Xf[t&15],LT=t=>Xf[(t&240)>>4]+Xf[t&15],bl=t=>(t&240)>>4===(t&15),MT=t=>bl(t.r)&&bl(t.g)&&bl(t.b)&&bl(t.a);function BT(t){var e=t.length,r;return t[0]==="#"&&(e===4||e===5?r={r:255&Sr[t[1]]*17,g:255&Sr[t[2]]*17,b:255&Sr[t[3]]*17,a:e===5?Sr[t[4]]*17:255}:(e===7||e===9)&&(r={r:Sr[t[1]]<<4|Sr[t[2]],g:Sr[t[3]]<<4|Sr[t[4]],b:Sr[t[5]]<<4|Sr[t[6]],a:e===9?Sr[t[7]]<<4|Sr[t[8]]:255})),r}const jT=(t,e)=>t<255?e(t):"";function UT(t){var e=MT(t)?NT:LT;return t?"#"+e(t.r)+e(t.g)+e(t.b)+jT(t.a,e):void 0}const $T=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function l_(t,e,r){const n=e*Math.min(r,1-r),i=(s,a=(s+t/30)%12)=>r-n*Math.max(Math.min(a-3,9-a,1),-1);return[i(0),i(8),i(4)]}function zT(t,e,r){const n=(i,s=(i+t/60)%6)=>r-r*e*Math.max(Math.min(s,4-s,1),0);return[n(5),n(3),n(1)]}function WT(t,e,r){const n=l_(t,1,.5);let i;for(e+r>1&&(i=1/(e+r),e*=i,r*=i),i=0;i<3;i++)n[i]*=1-e-r,n[i]+=e;return n}function HT(t,e,r,n,i){return t===i?(e-r)/n+(e<r?6:0):e===i?(r-t)/n+2:(t-e)/n+4}function g0(t){const r=t.r/255,n=t.g/255,i=t.b/255,s=Math.max(r,n,i),a=Math.min(r,n,i),o=(s+a)/2;let l,u,c;return s!==a&&(c=s-a,u=o>.5?c/(2-s-a):c/(s+a),l=HT(r,n,i,c,s),l=l*60+.5),[l|0,u||0,o]}function m0(t,e,r,n){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,r,n)).map(li)}function v0(t,e,r){return m0(l_,t,e,r)}function VT(t,e,r){return m0(WT,t,e,r)}function GT(t,e,r){return m0(zT,t,e,r)}function u_(t){return(t%360+360)%360}function KT(t){const e=$T.exec(t);let r=255,n;if(!e)return;e[5]!==n&&(r=e[6]?za(+e[5]):li(+e[5]));const i=u_(+e[2]),s=+e[3]/100,a=+e[4]/100;return e[1]==="hwb"?n=VT(i,s,a):e[1]==="hsv"?n=GT(i,s,a):n=v0(i,s,a),{r:n[0],g:n[1],b:n[2],a:r}}function YT(t,e){var r=g0(t);r[0]=u_(r[0]+e),r=v0(r),t.r=r[0],t.g=r[1],t.b=r[2]}function XT(t){if(!t)return;const e=g0(t),r=e[0],n=Tg(e[1]),i=Tg(e[2]);return t.a<255?`hsla(${r}, ${n}%, ${i}%, ${En(t.a)})`:`hsl(${r}, ${n}%, ${i}%)`}const kg={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},bg={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function qT(){const t={},e=Object.keys(bg),r=Object.keys(kg);let n,i,s,a,o;for(n=0;n<e.length;n++){for(a=o=e[n],i=0;i<r.length;i++)s=r[i],o=o.replace(s,kg[s]);s=parseInt(bg[a],16),t[o]=[s>>16&255,s>>8&255,s&255]}return t}let Al;function JT(t){Al||(Al=qT(),Al.transparent=[0,0,0,0]);const e=Al[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const QT=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function ZT(t){const e=QT.exec(t);let r=255,n,i,s;if(e){if(e[7]!==n){const a=+e[7];r=e[8]?za(a):Xn(a*255,0,255)}return n=+e[1],i=+e[3],s=+e[5],n=255&(e[2]?za(n):Xn(n,0,255)),i=255&(e[4]?za(i):Xn(i,0,255)),s=255&(e[6]?za(s):Xn(s,0,255)),{r:n,g:i,b:s,a:r}}}function ek(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${En(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const Th=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,ds=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function tk(t,e,r){const n=ds(En(t.r)),i=ds(En(t.g)),s=ds(En(t.b));return{r:li(Th(n+r*(ds(En(e.r))-n))),g:li(Th(i+r*(ds(En(e.g))-i))),b:li(Th(s+r*(ds(En(e.b))-s))),a:t.a+r*(e.a-t.a)}}function Ol(t,e,r){if(t){let n=g0(t);n[e]=Math.max(0,Math.min(n[e]+n[e]*r,e===0?360:1)),n=v0(n),t.r=n[0],t.g=n[1],t.b=n[2]}}function c_(t,e){return t&&Object.assign(e||{},t)}function Ag(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=li(t[3]))):(e=c_(t,{r:0,g:0,b:0,a:1}),e.a=li(e.a)),e}function rk(t){return t.charAt(0)==="r"?ZT(t):KT(t)}class Io{constructor(e){if(e instanceof Io)return e;const r=typeof e;let n;r==="object"?n=Ag(e):r==="string"&&(n=BT(e)||JT(e)||rk(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=c_(this._rgb);return e&&(e.a=En(e.a)),e}set rgb(e){this._rgb=Ag(e)}rgbString(){return this._valid?ek(this._rgb):void 0}hexString(){return this._valid?UT(this._rgb):void 0}hslString(){return this._valid?XT(this._rgb):void 0}mix(e,r){if(e){const n=this.rgb,i=e.rgb;let s;const a=r===s?.5:r,o=2*a-1,l=n.a-i.a,u=((o*l===-1?o:(o+l)/(1+o*l))+1)/2;s=1-u,n.r=255&u*n.r+s*i.r+.5,n.g=255&u*n.g+s*i.g+.5,n.b=255&u*n.b+s*i.b+.5,n.a=a*n.a+(1-a)*i.a,this.rgb=n}return this}interpolate(e,r){return e&&(this._rgb=tk(this._rgb,e._rgb,r)),this}clone(){return new Io(this.rgb)}alpha(e){return this._rgb.a=li(e),this}clearer(e){const r=this._rgb;return r.a*=1-e,this}greyscale(){const e=this._rgb,r=Zo(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=r,this}opaquer(e){const r=this._rgb;return r.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Ol(this._rgb,2,e),this}darken(e){return Ol(this._rgb,2,-e),this}saturate(e){return Ol(this._rgb,1,e),this}desaturate(e){return Ol(this._rgb,1,-e),this}rotate(e){return YT(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function vn(){}const nk=(()=>{let t=0;return()=>t++})();function $e(t){return t==null}function gt(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Ce(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Dr(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function sn(t,e){return Dr(t)?t:e}function Re(t,e){return typeof t>"u"?e:t}const ik=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Ve(t,e,r){if(t&&typeof t.call=="function")return t.apply(r,e)}function Ne(t,e,r,n){let i,s,a;if(gt(t))for(s=t.length,i=0;i<s;i++)e.call(r,t[i],i);else if(Ce(t))for(a=Object.keys(t),s=a.length,i=0;i<s;i++)e.call(r,t[a[i]],a[i])}function Wu(t,e){let r,n,i,s;if(!t||!e||t.length!==e.length)return!1;for(r=0,n=t.length;r<n;++r)if(i=t[r],s=e[r],i.datasetIndex!==s.datasetIndex||i.index!==s.index)return!1;return!0}function Hu(t){if(gt(t))return t.map(Hu);if(Ce(t)){const e=Object.create(null),r=Object.keys(t),n=r.length;let i=0;for(;i<n;++i)e[r[i]]=Hu(t[r[i]]);return e}return t}function h_(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function sk(t,e,r,n){if(!h_(t))return;const i=e[t],s=r[t];Ce(i)&&Ce(s)?Do(i,s,n):e[t]=Hu(s)}function Do(t,e,r){const n=gt(e)?e:[e],i=n.length;if(!Ce(t))return t;r=r||{};const s=r.merger||sk;let a;for(let o=0;o<i;++o){if(a=n[o],!Ce(a))continue;const l=Object.keys(a);for(let u=0,c=l.length;u<c;++u)s(l[u],t,a,r)}return t}function no(t,e){return Do(t,e,{merger:ak})}function ak(t,e,r){if(!h_(t))return;const n=e[t],i=r[t];Ce(n)&&Ce(i)?no(n,i):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=Hu(i))}const Og={"":t=>t,x:t=>t.x,y:t=>t.y};function ok(t){const e=t.split("."),r=[];let n="";for(const i of e)n+=i,n.endsWith("\\")?n=n.slice(0,-1)+".":(r.push(n),n="");return r}function lk(t){const e=ok(t);return r=>{for(const n of e){if(n==="")break;r=r&&r[n]}return r}}function sa(t,e){return(Og[e]||(Og[e]=lk(e)))(t)}function x0(t){return t.charAt(0).toUpperCase()+t.slice(1)}const No=t=>typeof t<"u",di=t=>typeof t=="function",Cg=(t,e)=>{if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0};function uk(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const jt=Math.PI,ui=2*jt,Vu=Number.POSITIVE_INFINITY,ck=jt/180,Xr=jt/2,bi=jt/4,Pg=jt*2/3,f_=Math.log10,ci=Math.sign;function pu(t,e,r){return Math.abs(t-e)<r}function Rg(t){const e=Math.round(t);t=pu(t,e,t/1e3)?e:t;const r=Math.pow(10,Math.floor(f_(t))),n=t/r;return(n<=1?1:n<=2?2:n<=5?5:10)*r}function hk(t){const e=[],r=Math.sqrt(t);let n;for(n=1;n<r;n++)t%n===0&&(e.push(n),e.push(t/n));return r===(r|0)&&e.push(r),e.sort((i,s)=>i-s).pop(),e}function fk(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function Gu(t){return!fk(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function dk(t,e){const r=Math.round(t);return r-e<=t&&r+e>=t}function pk(t,e,r){let n,i,s;for(n=0,i=t.length;n<i;n++)s=t[n][r],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function Wi(t){return t*(jt/180)}function gk(t){return t*(180/jt)}function Fg(t){if(!Dr(t))return;let e=1,r=0;for(;Math.round(t*e)/e!==t;)e*=10,r++;return r}function mk(t,e){const r=e.x-t.x,n=e.y-t.y,i=Math.sqrt(r*r+n*n);let s=Math.atan2(n,r);return s<-.5*jt&&(s+=ui),{angle:s,distance:i}}function vk(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Ai(t){return(t%ui+ui)%ui}function xk(t,e,r,n){const i=Ai(t),s=Ai(e),a=Ai(r),o=Ai(s-i),l=Ai(a-i),u=Ai(i-s),c=Ai(i-a);return i===s||i===a||n||o>l&&u<c}function qr(t,e,r){return Math.max(e,Math.min(r,t))}function _k(t){return qr(t,-32768,32767)}function Ms(t,e,r,n=1e-6){return t>=Math.min(e,r)-n&&t<=Math.max(e,r)+n}function _0(t,e,r){r=r||(a=>t[a]<e);let n=t.length-1,i=0,s;for(;n-i>1;)s=i+n>>1,r(s)?i=s:n=s;return{lo:i,hi:n}}const qf=(t,e,r,n)=>_0(t,r,n?i=>{const s=t[i][e];return s<r||s===r&&t[i+1][e]===r}:i=>t[i][e]<r),yk=(t,e,r)=>_0(t,r,n=>t[n][e]>=r);function wk(t,e,r){let n=0,i=t.length;for(;n<i&&t[n]<e;)n++;for(;i>n&&t[i-1]>r;)i--;return n>0||i<t.length?t.slice(n,i):t}const d_=["push","pop","shift","splice","unshift"];function Sk(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),d_.forEach(r=>{const n="_onData"+x0(r),i=t[r];Object.defineProperty(t,r,{configurable:!0,enumerable:!1,value(...s){const a=i.apply(this,s);return t._chartjs.listeners.forEach(o=>{typeof o[n]=="function"&&o[n](...s)}),a}})})}function Ig(t,e){const r=t._chartjs;if(!r)return;const n=r.listeners,i=n.indexOf(e);i!==-1&&n.splice(i,1),!(n.length>0)&&(d_.forEach(s=>{delete t[s]}),delete t._chartjs)}function p_(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const g_=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function m_(t,e){let r=[],n=!1;return function(...i){r=i,n||(n=!0,g_.call(window,()=>{n=!1,t.apply(e,r)}))}}function Ek(t,e){let r;return function(...n){return e?(clearTimeout(r),r=setTimeout(t,e,n)):t.apply(this,n),e}}const y0=t=>t==="start"?"left":t==="end"?"right":"center",Lt=(t,e,r)=>t==="start"?e:t==="end"?r:(e+r)/2,Tk=(t,e,r,n)=>t===(n?"left":"right")?r:t==="center"?(e+r)/2:e,Cl=t=>t===0||t===1,Dg=(t,e,r)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*ui/r)),Ng=(t,e,r)=>Math.pow(2,-10*t)*Math.sin((t-e)*ui/r)+1,io={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Xr)+1,easeOutSine:t=>Math.sin(t*Xr),easeInOutSine:t=>-.5*(Math.cos(jt*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Cl(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Cl(t)?t:Dg(t,.075,.3),easeOutElastic:t=>Cl(t)?t:Ng(t,.075,.3),easeInOutElastic(t){return Cl(t)?t:t<.5?.5*Dg(t*2,.1125,.45):.5+.5*Ng(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-io.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?io.easeInBounce(t*2)*.5:io.easeOutBounce(t*2-1)*.5+.5};function v_(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function Lg(t){return v_(t)?t:new Io(t)}function kh(t){return v_(t)?t:new Io(t).saturate(.5).darken(.1).hexString()}const kk=["x","y","borderWidth","radius","tension"],bk=["color","borderColor","backgroundColor"];function Ak(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:bk},numbers:{type:"number",properties:kk}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Ok(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Mg=new Map;function Ck(t,e){e=e||{};const r=t+JSON.stringify(e);let n=Mg.get(r);return n||(n=new Intl.NumberFormat(t,e),Mg.set(r,n)),n}function x_(t,e,r){return Ck(e,r).format(t)}const Pk={values(t){return gt(t)?t:""+t},numeric(t,e,r){if(t===0)return"0";const n=this.chart.options.locale;let i,s=t;if(r.length>1){const u=Math.max(Math.abs(r[0].value),Math.abs(r[r.length-1].value));(u<1e-4||u>1e15)&&(i="scientific"),s=Rk(t,r)}const a=f_(Math.abs(s)),o=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:i,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),x_(t,n,l)}};function Rk(t,e){let r=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(r)>=1&&t!==Math.floor(t)&&(r=t-Math.floor(t)),r}var __={formatters:Pk};function Fk(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,r)=>r.lineWidth,tickColor:(e,r)=>r.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:__.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const es=Object.create(null),Jf=Object.create(null);function so(t,e){if(!e)return t;const r=e.split(".");for(let n=0,i=r.length;n<i;++n){const s=r[n];t=t[s]||(t[s]=Object.create(null))}return t}function bh(t,e,r){return typeof e=="string"?Do(so(t,e),r):Do(so(t,""),e)}class Ik{constructor(e,r){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,i)=>kh(i.backgroundColor),this.hoverBorderColor=(n,i)=>kh(i.borderColor),this.hoverColor=(n,i)=>kh(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(r)}set(e,r){return bh(this,e,r)}get(e){return so(this,e)}describe(e,r){return bh(Jf,e,r)}override(e,r){return bh(es,e,r)}route(e,r,n,i){const s=so(this,e),a=so(this,n),o="_"+r;Object.defineProperties(s,{[o]:{value:s[r],writable:!0},[r]:{enumerable:!0,get(){const l=this[o],u=a[i];return Ce(l)?Object.assign({},u,l):Re(l,u)},set(l){this[o]=l}}})}apply(e){e.forEach(r=>r(this))}}var at=new Ik({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Ak,Ok,Fk]);function Dk(t){return!t||$e(t.size)||$e(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function Bg(t,e,r,n,i){let s=e[i];return s||(s=e[i]=t.measureText(i).width,r.push(i)),s>n&&(n=s),n}function Oi(t,e,r){const n=t.currentDevicePixelRatio,i=r!==0?Math.max(r/2,.5):0;return Math.round((e-i)*n)/n+i}function jg(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function Ug(t,e,r,n){y_(t,e,r,n,null)}function y_(t,e,r,n,i){let s,a,o,l,u,c,h,f;const d=e.pointStyle,g=e.rotation,p=e.radius;let m=(g||0)*ck;if(d&&typeof d=="object"&&(s=d.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){t.save(),t.translate(r,n),t.rotate(m),t.drawImage(d,-d.width/2,-d.height/2,d.width,d.height),t.restore();return}if(!(isNaN(p)||p<=0)){switch(t.beginPath(),d){default:i?t.ellipse(r,n,i/2,p,0,0,ui):t.arc(r,n,p,0,ui),t.closePath();break;case"triangle":c=i?i/2:p,t.moveTo(r+Math.sin(m)*c,n-Math.cos(m)*p),m+=Pg,t.lineTo(r+Math.sin(m)*c,n-Math.cos(m)*p),m+=Pg,t.lineTo(r+Math.sin(m)*c,n-Math.cos(m)*p),t.closePath();break;case"rectRounded":u=p*.516,l=p-u,a=Math.cos(m+bi)*l,h=Math.cos(m+bi)*(i?i/2-u:l),o=Math.sin(m+bi)*l,f=Math.sin(m+bi)*(i?i/2-u:l),t.arc(r-h,n-o,u,m-jt,m-Xr),t.arc(r+f,n-a,u,m-Xr,m),t.arc(r+h,n+o,u,m,m+Xr),t.arc(r-f,n+a,u,m+Xr,m+jt),t.closePath();break;case"rect":if(!g){l=Math.SQRT1_2*p,c=i?i/2:l,t.rect(r-c,n-l,2*c,2*l);break}m+=bi;case"rectRot":h=Math.cos(m)*(i?i/2:p),a=Math.cos(m)*p,o=Math.sin(m)*p,f=Math.sin(m)*(i?i/2:p),t.moveTo(r-h,n-o),t.lineTo(r+f,n-a),t.lineTo(r+h,n+o),t.lineTo(r-f,n+a),t.closePath();break;case"crossRot":m+=bi;case"cross":h=Math.cos(m)*(i?i/2:p),a=Math.cos(m)*p,o=Math.sin(m)*p,f=Math.sin(m)*(i?i/2:p),t.moveTo(r-h,n-o),t.lineTo(r+h,n+o),t.moveTo(r+f,n-a),t.lineTo(r-f,n+a);break;case"star":h=Math.cos(m)*(i?i/2:p),a=Math.cos(m)*p,o=Math.sin(m)*p,f=Math.sin(m)*(i?i/2:p),t.moveTo(r-h,n-o),t.lineTo(r+h,n+o),t.moveTo(r+f,n-a),t.lineTo(r-f,n+a),m+=bi,h=Math.cos(m)*(i?i/2:p),a=Math.cos(m)*p,o=Math.sin(m)*p,f=Math.sin(m)*(i?i/2:p),t.moveTo(r-h,n-o),t.lineTo(r+h,n+o),t.moveTo(r+f,n-a),t.lineTo(r-f,n+a);break;case"line":a=i?i/2:Math.cos(m)*p,o=Math.sin(m)*p,t.moveTo(r-a,n-o),t.lineTo(r+a,n+o);break;case"dash":t.moveTo(r,n),t.lineTo(r+Math.cos(m)*(i?i/2:p),n+Math.sin(m)*p);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function w_(t,e,r){return r=r||.5,!e||t&&t.x>e.left-r&&t.x<e.right+r&&t.y>e.top-r&&t.y<e.bottom+r}function w0(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function S0(t){t.restore()}function Nk(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),$e(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function Lk(t,e,r,n,i){if(i.strikethrough||i.underline){const s=t.measureText(n),a=e-s.actualBoundingBoxLeft,o=e+s.actualBoundingBoxRight,l=r-s.actualBoundingBoxAscent,u=r+s.actualBoundingBoxDescent,c=i.strikethrough?(l+u)/2:u;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=i.decorationWidth||2,t.moveTo(a,c),t.lineTo(o,c),t.stroke()}}function Mk(t,e){const r=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=r}function Lo(t,e,r,n,i,s={}){const a=gt(e)?e:[e],o=s.strokeWidth>0&&s.strokeColor!=="";let l,u;for(t.save(),t.font=i.string,Nk(t,s),l=0;l<a.length;++l)u=a[l],s.backdrop&&Mk(t,s.backdrop),o&&(s.strokeColor&&(t.strokeStyle=s.strokeColor),$e(s.strokeWidth)||(t.lineWidth=s.strokeWidth),t.strokeText(u,r,n,s.maxWidth)),t.fillText(u,r,n,s.maxWidth),Lk(t,r,n,u,s),n+=Number(i.lineHeight);t.restore()}function Ku(t,e){const{x:r,y:n,w:i,h:s,radius:a}=e;t.arc(r+a.topLeft,n+a.topLeft,a.topLeft,1.5*jt,jt,!0),t.lineTo(r,n+s-a.bottomLeft),t.arc(r+a.bottomLeft,n+s-a.bottomLeft,a.bottomLeft,jt,Xr,!0),t.lineTo(r+i-a.bottomRight,n+s),t.arc(r+i-a.bottomRight,n+s-a.bottomRight,a.bottomRight,Xr,0,!0),t.lineTo(r+i,n+a.topRight),t.arc(r+i-a.topRight,n+a.topRight,a.topRight,0,-Xr,!0),t.lineTo(r+a.topLeft,n)}const Bk=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,jk=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Uk(t,e){const r=(""+t).match(Bk);if(!r||r[1]==="normal")return e*1.2;switch(t=+r[2],r[3]){case"px":return t;case"%":t/=100;break}return e*t}const $k=t=>+t||0;function S_(t,e){const r={},n=Ce(e),i=n?Object.keys(e):e,s=Ce(t)?n?a=>Re(t[a],t[e[a]]):a=>t[a]:()=>t;for(const a of i)r[a]=$k(s(a));return r}function E_(t){return S_(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Vs(t){return S_(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Nr(t){const e=E_(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Bt(t,e){t=t||{},e=e||at.font;let r=Re(t.size,e.size);typeof r=="string"&&(r=parseInt(r,10));let n=Re(t.style,e.style);n&&!(""+n).match(jk)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const i={family:Re(t.family,e.family),lineHeight:Uk(Re(t.lineHeight,e.lineHeight),r),size:r,style:n,weight:Re(t.weight,e.weight),string:""};return i.string=Dk(i),i}function Pl(t,e,r,n){let i,s,a;for(i=0,s=t.length;i<s;++i)if(a=t[i],a!==void 0&&a!==void 0)return a}function zk(t,e,r){const{min:n,max:i}=t,s=ik(e,(i-n)/2),a=(o,l)=>r&&o===0?0:o+l;return{min:a(n,-Math.abs(s)),max:a(i,s)}}function fa(t,e){return Object.assign(Object.create(t),e)}function E0(t,e=[""],r,n,i=()=>t[0]){const s=r||t;typeof n>"u"&&(n=A_("_fallback",t));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:s,_fallback:n,_getTarget:i,override:o=>E0([o,...t],e,s,n)};return new Proxy(a,{deleteProperty(o,l){return delete o[l],delete o._keys,delete t[0][l],!0},get(o,l){return k_(o,l,()=>qk(l,e,t,o))},getOwnPropertyDescriptor(o,l){return Reflect.getOwnPropertyDescriptor(o._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(o,l){return zg(o).includes(l)},ownKeys(o){return zg(o)},set(o,l,u){const c=o._storage||(o._storage=i());return o[l]=c[l]=u,delete o._keys,!0}})}function aa(t,e,r,n){const i={_cacheable:!1,_proxy:t,_context:e,_subProxy:r,_stack:new Set,_descriptors:T_(t,n),setContext:s=>aa(t,s,r,n),override:s=>aa(t.override(s),e,r,n)};return new Proxy(i,{deleteProperty(s,a){return delete s[a],delete t[a],!0},get(s,a,o){return k_(s,a,()=>Hk(s,a,o))},getOwnPropertyDescriptor(s,a){return s._descriptors.allKeys?Reflect.has(t,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,a)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(s,a){return Reflect.has(t,a)},ownKeys(){return Reflect.ownKeys(t)},set(s,a,o){return t[a]=o,delete s[a],!0}})}function T_(t,e={scriptable:!0,indexable:!0}){const{_scriptable:r=e.scriptable,_indexable:n=e.indexable,_allKeys:i=e.allKeys}=t;return{allKeys:i,scriptable:r,indexable:n,isScriptable:di(r)?r:()=>r,isIndexable:di(n)?n:()=>n}}const Wk=(t,e)=>t?t+x0(e):e,T0=(t,e)=>Ce(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function k_(t,e,r){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const n=r();return t[e]=n,n}function Hk(t,e,r){const{_proxy:n,_context:i,_subProxy:s,_descriptors:a}=t;let o=n[e];return di(o)&&a.isScriptable(e)&&(o=Vk(e,o,t,r)),gt(o)&&o.length&&(o=Gk(e,o,t,a.isIndexable)),T0(e,o)&&(o=aa(o,i,s&&s[e],a)),o}function Vk(t,e,r,n){const{_proxy:i,_context:s,_subProxy:a,_stack:o}=r;if(o.has(t))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+t);o.add(t);let l=e(s,a||n);return o.delete(t),T0(t,l)&&(l=k0(i._scopes,i,t,l)),l}function Gk(t,e,r,n){const{_proxy:i,_context:s,_subProxy:a,_descriptors:o}=r;if(typeof s.index<"u"&&n(t))return e[s.index%e.length];if(Ce(e[0])){const l=e,u=i._scopes.filter(c=>c!==l);e=[];for(const c of l){const h=k0(u,i,t,c);e.push(aa(h,s,a&&a[t],o))}}return e}function b_(t,e,r){return di(t)?t(e,r):t}const Kk=(t,e)=>t===!0?e:typeof t=="string"?sa(e,t):void 0;function Yk(t,e,r,n,i){for(const s of e){const a=Kk(r,s);if(a){t.add(a);const o=b_(a._fallback,r,i);if(typeof o<"u"&&o!==r&&o!==n)return o}else if(a===!1&&typeof n<"u"&&r!==n)return null}return!1}function k0(t,e,r,n){const i=e._rootScopes,s=b_(e._fallback,r,n),a=[...t,...i],o=new Set;o.add(n);let l=$g(o,a,r,s||r,n);return l===null||typeof s<"u"&&s!==r&&(l=$g(o,a,s,l,n),l===null)?!1:E0(Array.from(o),[""],i,s,()=>Xk(e,r,n))}function $g(t,e,r,n,i){for(;r;)r=Yk(t,e,r,n,i);return r}function Xk(t,e,r){const n=t._getTarget();e in n||(n[e]={});const i=n[e];return gt(i)&&Ce(r)?r:i||{}}function qk(t,e,r,n){let i;for(const s of e)if(i=A_(Wk(s,t),r),typeof i<"u")return T0(t,i)?k0(r,n,t,i):i}function A_(t,e){for(const r of e){if(!r)continue;const n=r[t];if(typeof n<"u")return n}}function zg(t){let e=t._keys;return e||(e=t._keys=Jk(t._scopes)),e}function Jk(t){const e=new Set;for(const r of t)for(const n of Object.keys(r).filter(i=>!i.startsWith("_")))e.add(n);return Array.from(e)}function b0(){return typeof window<"u"&&typeof document<"u"}function A0(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Yu(t,e,r){let n;return typeof t=="string"?(n=parseInt(t,10),t.indexOf("%")!==-1&&(n=n/100*e.parentNode[r])):n=t,n}const Ic=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function Qk(t,e){return Ic(t).getPropertyValue(e)}const Zk=["top","right","bottom","left"];function Ki(t,e,r){const n={};r=r?"-"+r:"";for(let i=0;i<4;i++){const s=Zk[i];n[s]=parseFloat(t[e+"-"+s+r])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const eb=(t,e,r)=>(t>0||e>0)&&(!r||!r.shadowRoot);function tb(t,e){const r=t.touches,n=r&&r.length?r[0]:t,{offsetX:i,offsetY:s}=n;let a=!1,o,l;if(eb(i,s,t.target))o=i,l=s;else{const u=e.getBoundingClientRect();o=n.clientX-u.left,l=n.clientY-u.top,a=!0}return{x:o,y:l,box:a}}function Di(t,e){if("native"in t)return t;const{canvas:r,currentDevicePixelRatio:n}=e,i=Ic(r),s=i.boxSizing==="border-box",a=Ki(i,"padding"),o=Ki(i,"border","width"),{x:l,y:u,box:c}=tb(t,r),h=a.left+(c&&o.left),f=a.top+(c&&o.top);let{width:d,height:g}=e;return s&&(d-=a.width+o.width,g-=a.height+o.height),{x:Math.round((l-h)/d*r.width/n),y:Math.round((u-f)/g*r.height/n)}}function rb(t,e,r){let n,i;if(e===void 0||r===void 0){const s=t&&A0(t);if(!s)e=t.clientWidth,r=t.clientHeight;else{const a=s.getBoundingClientRect(),o=Ic(s),l=Ki(o,"border","width"),u=Ki(o,"padding");e=a.width-u.width-l.width,r=a.height-u.height-l.height,n=Yu(o.maxWidth,s,"clientWidth"),i=Yu(o.maxHeight,s,"clientHeight")}}return{width:e,height:r,maxWidth:n||Vu,maxHeight:i||Vu}}const qn=t=>Math.round(t*10)/10;function nb(t,e,r,n){const i=Ic(t),s=Ki(i,"margin"),a=Yu(i.maxWidth,t,"clientWidth")||Vu,o=Yu(i.maxHeight,t,"clientHeight")||Vu,l=rb(t,e,r);let{width:u,height:c}=l;if(i.boxSizing==="content-box"){const f=Ki(i,"border","width"),d=Ki(i,"padding");u-=d.width+f.width,c-=d.height+f.height}return u=Math.max(0,u-s.width),c=Math.max(0,n?u/n:c-s.height),u=qn(Math.min(u,a,l.maxWidth)),c=qn(Math.min(c,o,l.maxHeight)),u&&!c&&(c=qn(u/2)),(e!==void 0||r!==void 0)&&n&&l.height&&c>l.height&&(c=l.height,u=qn(Math.floor(c*n))),{width:u,height:c}}function Wg(t,e,r){const n=e||1,i=qn(t.height*n),s=qn(t.width*n);t.height=qn(t.height),t.width=qn(t.width);const a=t.canvas;return a.style&&(r||!a.style.height&&!a.style.width)&&(a.style.height=`${t.height}px`,a.style.width=`${t.width}px`),t.currentDevicePixelRatio!==n||a.height!==i||a.width!==s?(t.currentDevicePixelRatio=n,a.height=i,a.width=s,t.ctx.setTransform(n,0,0,n,0,0),!0):!1}const ib=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};b0()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function Hg(t,e){const r=Qk(t,e),n=r&&r.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}const sb=function(t,e){return{x(r){return t+t+e-r},setWidth(r){e=r},textAlign(r){return r==="center"?r:r==="right"?"left":"right"},xPlus(r,n){return r-n},leftForLtr(r,n){return r-n}}},ab=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Gs(t,e,r){return t?sb(e,r):ab()}function O_(t,e){let r,n;(e==="ltr"||e==="rtl")&&(r=t.canvas.style,n=[r.getPropertyValue("direction"),r.getPropertyPriority("direction")],r.setProperty("direction",e,"important"),t.prevTextDirection=n)}function C_(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Rl(t,e,r){return t.options.clip?t[r]:e[r]}function ob(t,e){const{xScale:r,yScale:n}=t;return r&&n?{left:Rl(r,e,"left"),right:Rl(r,e,"right"),top:Rl(n,e,"top"),bottom:Rl(n,e,"bottom")}:e}function lb(t,e){const r=e._clip;if(r.disabled)return!1;const n=ob(e,t.chartArea);return{left:r.left===!1?0:n.left-(r.left===!0?0:r.left),right:r.right===!1?t.width:n.right+(r.right===!0?0:r.right),top:r.top===!1?0:n.top-(r.top===!0?0:r.top),bottom:r.bottom===!1?t.height:n.bottom+(r.bottom===!0?0:r.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class ub{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,r,n,i){const s=r.listeners[i],a=r.duration;s.forEach(o=>o({chart:e,initial:r.initial,numSteps:a,currentStep:Math.min(n-r.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=g_.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let r=0;this._charts.forEach((n,i)=>{if(!n.running||!n.items.length)return;const s=n.items;let a=s.length-1,o=!1,l;for(;a>=0;--a)l=s[a],l._active?(l._total>n.duration&&(n.duration=l._total),l.tick(e),o=!0):(s[a]=s[s.length-1],s.pop());o&&(i.draw(),this._notify(i,n,e,"progress")),s.length||(n.running=!1,this._notify(i,n,e,"complete"),n.initial=!1),r+=s.length}),this._lastDate=e,r===0&&(this._running=!1)}_getAnims(e){const r=this._charts;let n=r.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},r.set(e,n)),n}listen(e,r,n){this._getAnims(e).listeners[r].push(n)}add(e,r){!r||!r.length||this._getAnims(e).items.push(...r)}has(e){return this._getAnims(e).items.length>0}start(e){const r=this._charts.get(e);r&&(r.running=!0,r.start=Date.now(),r.duration=r.items.reduce((n,i)=>Math.max(n,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const r=this._charts.get(e);return!(!r||!r.running||!r.items.length)}stop(e){const r=this._charts.get(e);if(!r||!r.items.length)return;const n=r.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();r.items=[],this._notify(e,r,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var xn=new ub;const Vg="transparent",cb={boolean(t,e,r){return r>.5?e:t},color(t,e,r){const n=Lg(t||Vg),i=n.valid&&Lg(e||Vg);return i&&i.valid?i.mix(n,r).hexString():e},number(t,e,r){return t+(e-t)*r}};class hb{constructor(e,r,n,i){const s=r[n];i=Pl([e.to,i,s,e.from]);const a=Pl([e.from,s,i]);this._active=!0,this._fn=e.fn||cb[e.type||typeof a],this._easing=io[e.easing]||io.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=r,this._prop=n,this._from=a,this._to=i,this._promises=void 0}active(){return this._active}update(e,r,n){if(this._active){this._notify(!1);const i=this._target[this._prop],s=n-this._start,a=this._duration-s;this._start=n,this._duration=Math.floor(Math.max(a,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=Pl([e.to,r,i,e.from]),this._from=Pl([e.from,i,r])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const r=e-this._start,n=this._duration,i=this._prop,s=this._from,a=this._loop,o=this._to;let l;if(this._active=s!==o&&(a||r<n),!this._active){this._target[i]=o,this._notify(!0);return}if(r<0){this._target[i]=s;return}l=r/n%2,l=a&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[i]=this._fn(s,o,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((r,n)=>{e.push({res:r,rej:n})})}_notify(e){const r=e?"res":"rej",n=this._promises||[];for(let i=0;i<n.length;i++)n[i][r]()}}class P_{constructor(e,r){this._chart=e,this._properties=new Map,this.configure(r)}configure(e){if(!Ce(e))return;const r=Object.keys(at.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const s=e[i];if(!Ce(s))return;const a={};for(const o of r)a[o]=s[o];(gt(s.properties)&&s.properties||[i]).forEach(o=>{(o===i||!n.has(o))&&n.set(o,a)})})}_animateOptions(e,r){const n=r.options,i=db(e,n);if(!i)return[];const s=this._createAnimations(i,n);return n.$shared&&fb(e.options.$animations,n).then(()=>{e.options=n},()=>{}),s}_createAnimations(e,r){const n=this._properties,i=[],s=e.$animations||(e.$animations={}),a=Object.keys(r),o=Date.now();let l;for(l=a.length-1;l>=0;--l){const u=a[l];if(u.charAt(0)==="$")continue;if(u==="options"){i.push(...this._animateOptions(e,r));continue}const c=r[u];let h=s[u];const f=n.get(u);if(h)if(f&&h.active()){h.update(f,c,o);continue}else h.cancel();if(!f||!f.duration){e[u]=c;continue}s[u]=h=new hb(f,e,u,c),i.push(h)}return i}update(e,r){if(this._properties.size===0){Object.assign(e,r);return}const n=this._createAnimations(e,r);if(n.length)return xn.add(this._chart,n),!0}}function fb(t,e){const r=[],n=Object.keys(e);for(let i=0;i<n.length;i++){const s=t[n[i]];s&&s.active()&&r.push(s.wait())}return Promise.all(r)}function db(t,e){if(!e)return;let r=t.options;if(!r){t.options=e;return}return r.$shared&&(t.options=r=Object.assign({},r,{$shared:!1,$animations:{}})),r}function Gg(t,e){const r=t&&t.options||{},n=r.reverse,i=r.min===void 0?e:0,s=r.max===void 0?e:0;return{start:n?s:i,end:n?i:s}}function pb(t,e,r){if(r===!1)return!1;const n=Gg(t,r),i=Gg(e,r);return{top:i.end,right:n.end,bottom:i.start,left:n.start}}function gb(t){let e,r,n,i;return Ce(t)?(e=t.top,r=t.right,n=t.bottom,i=t.left):e=r=n=i=t,{top:e,right:r,bottom:n,left:i,disabled:t===!1}}function R_(t,e){const r=[],n=t._getSortedDatasetMetas(e);let i,s;for(i=0,s=n.length;i<s;++i)r.push(n[i].index);return r}function Kg(t,e,r,n={}){const i=t.keys,s=n.mode==="single";let a,o,l,u;if(e===null)return;let c=!1;for(a=0,o=i.length;a<o;++a){if(l=+i[a],l===r){if(c=!0,n.all)continue;break}u=t.values[l],Dr(u)&&(s||e===0||ci(e)===ci(u))&&(e+=u)}return!c&&!n.all?0:e}function mb(t,e){const{iScale:r,vScale:n}=e,i=r.axis==="x"?"x":"y",s=n.axis==="x"?"x":"y",a=Object.keys(t),o=new Array(a.length);let l,u,c;for(l=0,u=a.length;l<u;++l)c=a[l],o[l]={[i]:c,[s]:t[c]};return o}function Ah(t,e){const r=t&&t.options.stacked;return r||r===void 0&&e.stack!==void 0}function vb(t,e,r){return`${t.id}.${e.id}.${r.stack||r.type}`}function xb(t){const{min:e,max:r,minDefined:n,maxDefined:i}=t.getUserBounds();return{min:n?e:Number.NEGATIVE_INFINITY,max:i?r:Number.POSITIVE_INFINITY}}function _b(t,e,r){const n=t[e]||(t[e]={});return n[r]||(n[r]={})}function Yg(t,e,r,n){for(const i of e.getMatchingVisibleMetas(n).reverse()){const s=t[i.index];if(r&&s>0||!r&&s<0)return i.index}return null}function Xg(t,e){const{chart:r,_cachedMeta:n}=t,i=r._stacks||(r._stacks={}),{iScale:s,vScale:a,index:o}=n,l=s.axis,u=a.axis,c=vb(s,a,n),h=e.length;let f;for(let d=0;d<h;++d){const g=e[d],{[l]:p,[u]:m}=g,v=g._stacks||(g._stacks={});f=v[u]=_b(i,c,p),f[o]=m,f._top=Yg(f,a,!0,n.type),f._bottom=Yg(f,a,!1,n.type);const x=f._visualValues||(f._visualValues={});x[o]=m}}function Oh(t,e){const r=t.scales;return Object.keys(r).filter(n=>r[n].axis===e).shift()}function yb(t,e){return fa(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function wb(t,e,r){return fa(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:r,index:e,mode:"default",type:"data"})}function Fa(t,e){const r=t.controller.index,n=t.vScale&&t.vScale.axis;if(n){e=e||t._parsed;for(const i of e){const s=i._stacks;if(!s||s[n]===void 0||s[n][r]===void 0)return;delete s[n][r],s[n]._visualValues!==void 0&&s[n]._visualValues[r]!==void 0&&delete s[n]._visualValues[r]}}}const Ch=t=>t==="reset"||t==="none",qg=(t,e)=>e?t:Object.assign({},t),Sb=(t,e,r)=>t&&!e.hidden&&e._stacked&&{keys:R_(r,!0),values:null};class ao{constructor(e,r){this.chart=e,this._ctx=e.ctx,this.index=r,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Ah(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Fa(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,r=this._cachedMeta,n=this.getDataset(),i=(h,f,d,g)=>h==="x"?f:h==="r"?g:d,s=r.xAxisID=Re(n.xAxisID,Oh(e,"x")),a=r.yAxisID=Re(n.yAxisID,Oh(e,"y")),o=r.rAxisID=Re(n.rAxisID,Oh(e,"r")),l=r.indexAxis,u=r.iAxisID=i(l,s,a,o),c=r.vAxisID=i(l,a,s,o);r.xScale=this.getScaleForId(s),r.yScale=this.getScaleForId(a),r.rScale=this.getScaleForId(o),r.iScale=this.getScaleForId(u),r.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const r=this._cachedMeta;return e===r.iScale?r.vScale:r.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&Ig(this._data,this),e._stacked&&Fa(e)}_dataCheck(){const e=this.getDataset(),r=e.data||(e.data=[]),n=this._data;if(Ce(r)){const i=this._cachedMeta;this._data=mb(r,i)}else if(n!==r){if(n){Ig(n,this);const i=this._cachedMeta;Fa(i),i._parsed=[]}r&&Object.isExtensible(r)&&Sk(r,this),this._syncList=[],this._data=r}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const r=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const s=r._stacked;r._stacked=Ah(r.vScale,r),r.stack!==n.stack&&(i=!0,Fa(r),r.stack=n.stack),this._resyncElements(e),(i||s!==r._stacked)&&(Xg(this,r._parsed),r._stacked=Ah(r.vScale,r))}configure(){const e=this.chart.config,r=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),r,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,r){const{_cachedMeta:n,_data:i}=this,{iScale:s,_stacked:a}=n,o=s.axis;let l=e===0&&r===i.length?!0:n._sorted,u=e>0&&n._parsed[e-1],c,h,f;if(this._parsing===!1)n._parsed=i,n._sorted=!0,f=i;else{gt(i[e])?f=this.parseArrayData(n,i,e,r):Ce(i[e])?f=this.parseObjectData(n,i,e,r):f=this.parsePrimitiveData(n,i,e,r);const d=()=>h[o]===null||u&&h[o]<u[o];for(c=0;c<r;++c)n._parsed[c+e]=h=f[c],l&&(d()&&(l=!1),u=h);n._sorted=l}a&&Xg(this,f)}parsePrimitiveData(e,r,n,i){const{iScale:s,vScale:a}=e,o=s.axis,l=a.axis,u=s.getLabels(),c=s===a,h=new Array(i);let f,d,g;for(f=0,d=i;f<d;++f)g=f+n,h[f]={[o]:c||s.parse(u[g],g),[l]:a.parse(r[g],g)};return h}parseArrayData(e,r,n,i){const{xScale:s,yScale:a}=e,o=new Array(i);let l,u,c,h;for(l=0,u=i;l<u;++l)c=l+n,h=r[c],o[l]={x:s.parse(h[0],c),y:a.parse(h[1],c)};return o}parseObjectData(e,r,n,i){const{xScale:s,yScale:a}=e,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,u=new Array(i);let c,h,f,d;for(c=0,h=i;c<h;++c)f=c+n,d=r[f],u[c]={x:s.parse(sa(d,o),f),y:a.parse(sa(d,l),f)};return u}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,r,n){const i=this.chart,s=this._cachedMeta,a=r[e.axis],o={keys:R_(i,!0),values:r._stacks[e.axis]._visualValues};return Kg(o,a,s.index,{mode:n})}updateRangeFromParsed(e,r,n,i){const s=n[r.axis];let a=s===null?NaN:s;const o=i&&n._stacks[r.axis];i&&o&&(i.values=o,a=Kg(i,s,this._cachedMeta.index)),e.min=Math.min(e.min,a),e.max=Math.max(e.max,a)}getMinMax(e,r){const n=this._cachedMeta,i=n._parsed,s=n._sorted&&e===n.iScale,a=i.length,o=this._getOtherScale(e),l=Sb(r,n,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:h}=xb(o);let f,d;function g(){d=i[f];const p=d[o.axis];return!Dr(d[e.axis])||c>p||h<p}for(f=0;f<a&&!(!g()&&(this.updateRangeFromParsed(u,e,d,l),s));++f);if(s){for(f=a-1;f>=0;--f)if(!g()){this.updateRangeFromParsed(u,e,d,l);break}}return u}getAllParsedValues(e){const r=this._cachedMeta._parsed,n=[];let i,s,a;for(i=0,s=r.length;i<s;++i)a=r[i][e.axis],Dr(a)&&n.push(a);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const r=this._cachedMeta,n=r.iScale,i=r.vScale,s=this.getParsed(e);return{label:n?""+n.getLabelForValue(s[n.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}_update(e){const r=this._cachedMeta;this.update(e||"default"),r._clip=gb(Re(this.options.clip,pb(r.xScale,r.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,r=this.chart,n=this._cachedMeta,i=n.data||[],s=r.chartArea,a=[],o=this._drawStart||0,l=this._drawCount||i.length-o,u=this.options.drawActiveElementsOnTop;let c;for(n.dataset&&n.dataset.draw(e,s,o,l),c=o;c<o+l;++c){const h=i[c];h.hidden||(h.active&&u?a.push(h):h.draw(e,s))}for(c=0;c<a.length;++c)a[c].draw(e,s)}getStyle(e,r){const n=r?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,r,n){const i=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const a=this._cachedMeta.data[e];s=a.$context||(a.$context=wb(this.getContext(),e,a)),s.parsed=this.getParsed(e),s.raw=i.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=yb(this.chart.getContext(),this.index)),s.dataset=i,s.index=s.datasetIndex=this.index;return s.active=!!r,s.mode=n,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,r){return this._resolveElementOptions(this.dataElementType.id,r,e)}_resolveElementOptions(e,r="default",n){const i=r==="active",s=this._cachedDataOpts,a=e+"-"+r,o=s[a],l=this.enableOptionSharing&&No(n);if(o)return qg(o,l);const u=this.chart.config,c=u.datasetElementScopeKeys(this._type,e),h=i?[`${e}Hover`,"hover",e,""]:[e,""],f=u.getOptionScopes(this.getDataset(),c),d=Object.keys(at.elements[e]),g=()=>this.getContext(n,i,r),p=u.resolveNamedOptions(f,d,g,h);return p.$shared&&(p.$shared=l,s[a]=Object.freeze(qg(p,l))),p}_resolveAnimations(e,r,n){const i=this.chart,s=this._cachedDataOpts,a=`animation-${r}`,o=s[a];if(o)return o;let l;if(i.options.animation!==!1){const c=this.chart.config,h=c.datasetAnimationScopeKeys(this._type,r),f=c.getOptionScopes(this.getDataset(),h);l=c.createResolver(f,this.getContext(e,n,r))}const u=new P_(i,l&&l.animations);return l&&l._cacheable&&(s[a]=Object.freeze(u)),u}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,r){return!r||Ch(e)||this.chart._animationsDisabled}_getSharedOptions(e,r){const n=this.resolveDataElementOptions(e,r),i=this._sharedOptions,s=this.getSharedOptions(n),a=this.includeOptions(r,s)||s!==i;return this.updateSharedOptions(s,r,n),{sharedOptions:s,includeOptions:a}}updateElement(e,r,n,i){Ch(i)?Object.assign(e,n):this._resolveAnimations(r,i).update(e,n)}updateSharedOptions(e,r,n){e&&!Ch(r)&&this._resolveAnimations(void 0,r).update(e,n)}_setStyle(e,r,n,i){e.active=i;const s=this.getStyle(r,i);this._resolveAnimations(r,n,i).update(e,{options:!i&&this.getSharedOptions(s)||s})}removeHoverStyle(e,r,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,r,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const r=this._data,n=this._cachedMeta.data;for(const[o,l,u]of this._syncList)this[o](l,u);this._syncList=[];const i=n.length,s=r.length,a=Math.min(s,i);a&&this.parse(0,a),s>i?this._insertElements(i,s-i,e):s<i&&this._removeElements(s,i-s)}_insertElements(e,r,n=!0){const i=this._cachedMeta,s=i.data,a=e+r;let o;const l=u=>{for(u.length+=r,o=u.length-1;o>=a;o--)u[o]=u[o-r]};for(l(s),o=e;o<a;++o)s[o]=new this.dataElementType;this._parsing&&l(i._parsed),this.parse(e,r),n&&this.updateElements(s,e,r,"reset")}updateElements(e,r,n,i){}_removeElements(e,r){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(e,r);n._stacked&&Fa(n,i)}n.data.splice(e,r)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[r,n,i]=e;this[r](n,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,r){r&&this._sync(["_removeElements",e,r]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}ke(ao,"defaults",{}),ke(ao,"datasetElementType",null),ke(ao,"dataElementType",null);function Eb(t,e){if(!t._cache.$bar){const r=t.getMatchingVisibleMetas(e);let n=[];for(let i=0,s=r.length;i<s;i++)n=n.concat(r[i].controller.getAllParsedValues(t));t._cache.$bar=p_(n.sort((i,s)=>i-s))}return t._cache.$bar}function Tb(t){const e=t.iScale,r=Eb(e,t.type);let n=e._length,i,s,a,o;const l=()=>{a===32767||a===-32768||(No(o)&&(n=Math.min(n,Math.abs(a-o)||n)),o=a)};for(i=0,s=r.length;i<s;++i)a=e.getPixelForValue(r[i]),l();for(o=void 0,i=0,s=e.ticks.length;i<s;++i)a=e.getPixelForTick(i),l();return n}function kb(t,e,r,n){const i=r.barThickness;let s,a;return $e(i)?(s=e.min*r.categoryPercentage,a=r.barPercentage):(s=i*n,a=1),{chunk:s/n,ratio:a,start:e.pixels[t]-s/2}}function bb(t,e,r,n){const i=e.pixels,s=i[t];let a=t>0?i[t-1]:null,o=t<i.length-1?i[t+1]:null;const l=r.categoryPercentage;a===null&&(a=s-(o===null?e.end-e.start:o-s)),o===null&&(o=s+s-a);const u=s-(s-Math.min(a,o))/2*l;return{chunk:Math.abs(o-a)/2*l/n,ratio:r.barPercentage,start:u}}function Ab(t,e,r,n){const i=r.parse(t[0],n),s=r.parse(t[1],n),a=Math.min(i,s),o=Math.max(i,s);let l=a,u=o;Math.abs(a)>Math.abs(o)&&(l=o,u=a),e[r.axis]=u,e._custom={barStart:l,barEnd:u,start:i,end:s,min:a,max:o}}function F_(t,e,r,n){return gt(t)?Ab(t,e,r,n):e[r.axis]=r.parse(t,n),e}function Jg(t,e,r,n){const i=t.iScale,s=t.vScale,a=i.getLabels(),o=i===s,l=[];let u,c,h,f;for(u=r,c=r+n;u<c;++u)f=e[u],h={},h[i.axis]=o||i.parse(a[u],u),l.push(F_(f,h,s,u));return l}function Ph(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function Ob(t,e,r){return t!==0?ci(t):(e.isHorizontal()?1:-1)*(e.min>=r?1:-1)}function Cb(t){let e,r,n,i,s;return t.horizontal?(e=t.base>t.x,r="left",n="right"):(e=t.base<t.y,r="bottom",n="top"),e?(i="end",s="start"):(i="start",s="end"),{start:r,end:n,reverse:e,top:i,bottom:s}}function Pb(t,e,r,n){let i=e.borderSkipped;const s={};if(!i){t.borderSkipped=s;return}if(i===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:a,end:o,reverse:l,top:u,bottom:c}=Cb(t);i==="middle"&&r&&(t.enableBorderRadius=!0,(r._top||0)===n?i=u:(r._bottom||0)===n?i=c:(s[Qg(c,a,o,l)]=!0,i=u)),s[Qg(i,a,o,l)]=!0,t.borderSkipped=s}function Qg(t,e,r,n){return n?(t=Rb(t,e,r),t=Zg(t,r,e)):t=Zg(t,e,r),t}function Rb(t,e,r){return t===e?r:t===r?e:t}function Zg(t,e,r){return t==="start"?e:t==="end"?r:t}function Fb(t,{inflateAmount:e},r){t.inflateAmount=e==="auto"?r===1?.33:0:e}class gu extends ao{parsePrimitiveData(e,r,n,i){return Jg(e,r,n,i)}parseArrayData(e,r,n,i){return Jg(e,r,n,i)}parseObjectData(e,r,n,i){const{iScale:s,vScale:a}=e,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,u=s.axis==="x"?o:l,c=a.axis==="x"?o:l,h=[];let f,d,g,p;for(f=n,d=n+i;f<d;++f)p=r[f],g={},g[s.axis]=s.parse(sa(p,u),f),h.push(F_(sa(p,c),g,a,f));return h}updateRangeFromParsed(e,r,n,i){super.updateRangeFromParsed(e,r,n,i);const s=n._custom;s&&r===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const r=this._cachedMeta,{iScale:n,vScale:i}=r,s=this.getParsed(e),a=s._custom,o=Ph(a)?"["+a.start+", "+a.end+"]":""+i.getLabelForValue(s[i.axis]);return{label:""+n.getLabelForValue(s[n.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const r=this._cachedMeta;this.updateElements(r.data,0,r.data.length,e)}updateElements(e,r,n,i){const s=i==="reset",{index:a,_cachedMeta:{vScale:o}}=this,l=o.getBasePixel(),u=o.isHorizontal(),c=this._getRuler(),{sharedOptions:h,includeOptions:f}=this._getSharedOptions(r,i);for(let d=r;d<r+n;d++){const g=this.getParsed(d),p=s||$e(g[o.axis])?{base:l,head:l}:this._calculateBarValuePixels(d),m=this._calculateBarIndexPixels(d,c),v=(g._stacks||{})[o.axis],x={horizontal:u,base:p.base,enableBorderRadius:!v||Ph(g._custom)||a===v._top||a===v._bottom,x:u?p.head:m.center,y:u?m.center:p.head,height:u?m.size:Math.abs(p.size),width:u?Math.abs(p.size):m.size};f&&(x.options=h||this.resolveDataElementOptions(d,e[d].active?"active":i));const _=x.options||e[d].options;Pb(x,_,v,a),Fb(x,_,c.ratio),this.updateElement(e[d],d,x,i)}}_getStacks(e,r){const{iScale:n}=this._cachedMeta,i=n.getMatchingVisibleMetas(this._type).filter(c=>c.controller.options.grouped),s=n.options.stacked,a=[],o=this._cachedMeta.controller.getParsed(r),l=o&&o[n.axis],u=c=>{const h=c._parsed.find(d=>d[n.axis]===l),f=h&&h[c.vScale.axis];if($e(f)||isNaN(f))return!0};for(const c of i)if(!(r!==void 0&&u(c))&&((s===!1||a.indexOf(c.stack)===-1||s===void 0&&c.stack===void 0)&&a.push(c.stack),c.index===e))break;return a.length||a.push(void 0),a}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,r=this.chart.options.indexAxis;return Object.keys(e).filter(n=>e[n].axis===r).shift()}_getAxis(){const e={},r=this.getFirstScaleIdForIndexAxis();for(const n of this.chart.data.datasets)e[Re(this.chart.options.indexAxis==="x"?n.xAxisID:n.yAxisID,r)]=!0;return Object.keys(e)}_getStackIndex(e,r,n){const i=this._getStacks(e,n),s=r!==void 0?i.indexOf(r):-1;return s===-1?i.length-1:s}_getRuler(){const e=this.options,r=this._cachedMeta,n=r.iScale,i=[];let s,a;for(s=0,a=r.data.length;s<a;++s)i.push(n.getPixelForValue(this.getParsed(s)[n.axis],s));const o=e.barThickness;return{min:o||Tb(r),pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:e.grouped,ratio:o?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:r,_stacked:n,index:i},options:{base:s,minBarLength:a}}=this,o=s||0,l=this.getParsed(e),u=l._custom,c=Ph(u);let h=l[r.axis],f=0,d=n?this.applyStack(r,l,n):h,g,p;d!==h&&(f=d-h,d=h),c&&(h=u.barStart,d=u.barEnd-u.barStart,h!==0&&ci(h)!==ci(u.barEnd)&&(f=0),f+=h);const m=!$e(s)&&!c?s:f;let v=r.getPixelForValue(m);if(this.chart.getDataVisibility(e)?g=r.getPixelForValue(f+d):g=v,p=g-v,Math.abs(p)<a){p=Ob(p,r,o)*a,h===o&&(v-=p/2);const x=r.getPixelForDecimal(0),_=r.getPixelForDecimal(1),w=Math.min(x,_),O=Math.max(x,_);v=Math.max(Math.min(v,O),w),g=v+p,n&&!c&&(l._stacks[r.axis]._visualValues[i]=r.getValueForPixel(g)-r.getValueForPixel(v))}if(v===r.getPixelForValue(o)){const x=ci(p)*r.getLineWidthForValue(o)/2;v+=x,p-=x}return{size:p,base:v,head:g,center:g+p/2}}_calculateBarIndexPixels(e,r){const n=r.scale,i=this.options,s=i.skipNull,a=Re(i.maxBarThickness,1/0);let o,l;const u=this._getAxisCount();if(r.grouped){const c=s?this._getStackCount(e):r.stackCount,h=i.barThickness==="flex"?bb(e,r,i,c*u):kb(e,r,i,c*u),f=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,d=this._getAxis().indexOf(Re(f,this.getFirstScaleIdForIndexAxis())),g=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0)+d;o=h.start+h.chunk*g+h.chunk/2,l=Math.min(a,h.chunk*h.ratio)}else o=n.getPixelForValue(this.getParsed(e)[n.axis],e),l=Math.min(a,r.min*r.ratio);return{base:o-l/2,head:o+l/2,center:o,size:l}}draw(){const e=this._cachedMeta,r=e.vScale,n=e.data,i=n.length;let s=0;for(;s<i;++s)this.getParsed(s)[r.axis]!==null&&!n[s].hidden&&n[s].draw(this._ctx)}}ke(gu,"id","bar"),ke(gu,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),ke(gu,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function Ci(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class O0{constructor(e){ke(this,"options");this.options=e||{}}static override(e){Object.assign(O0.prototype,e)}init(){}formats(){return Ci()}parse(){return Ci()}format(){return Ci()}add(){return Ci()}diff(){return Ci()}startOf(){return Ci()}endOf(){return Ci()}}var Ib={_date:O0};function Db(t,e,r,n){const{controller:i,data:s,_sorted:a}=t,o=i._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(o&&e===o.axis&&e!=="r"&&a&&s.length){const u=o._reversePixels?yk:qf;if(n){if(i._sharedOptions){const c=s[0],h=typeof c.getRange=="function"&&c.getRange(e);if(h){const f=u(s,e,r-h),d=u(s,e,r+h);return{lo:f.lo,hi:d.hi}}}}else{const c=u(s,e,r);if(l){const{vScale:h}=i._cachedMeta,{_parsed:f}=t,d=f.slice(0,c.lo+1).reverse().findIndex(p=>!$e(p[h.axis]));c.lo-=Math.max(0,d);const g=f.slice(c.hi).findIndex(p=>!$e(p[h.axis]));c.hi+=Math.max(0,g)}return c}}return{lo:0,hi:s.length-1}}function Dc(t,e,r,n,i){const s=t.getSortedVisibleDatasetMetas(),a=r[e];for(let o=0,l=s.length;o<l;++o){const{index:u,data:c}=s[o],{lo:h,hi:f}=Db(s[o],e,a,i);for(let d=h;d<=f;++d){const g=c[d];g.skip||n(g,u,d)}}}function Nb(t){const e=t.indexOf("x")!==-1,r=t.indexOf("y")!==-1;return function(n,i){const s=e?Math.abs(n.x-i.x):0,a=r?Math.abs(n.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(a,2))}}function Rh(t,e,r,n,i){const s=[];return!i&&!t.isPointInArea(e)||Dc(t,r,e,function(o,l,u){!i&&!w_(o,t.chartArea,0)||o.inRange(e.x,e.y,n)&&s.push({element:o,datasetIndex:l,index:u})},!0),s}function Lb(t,e,r,n){let i=[];function s(a,o,l){const{startAngle:u,endAngle:c}=a.getProps(["startAngle","endAngle"],n),{angle:h}=mk(a,{x:e.x,y:e.y});xk(h,u,c)&&i.push({element:a,datasetIndex:o,index:l})}return Dc(t,r,e,s),i}function Mb(t,e,r,n,i,s){let a=[];const o=Nb(r);let l=Number.POSITIVE_INFINITY;function u(c,h,f){const d=c.inRange(e.x,e.y,i);if(n&&!d)return;const g=c.getCenterPoint(i);if(!(!!s||t.isPointInArea(g))&&!d)return;const m=o(e,g);m<l?(a=[{element:c,datasetIndex:h,index:f}],l=m):m===l&&a.push({element:c,datasetIndex:h,index:f})}return Dc(t,r,e,u),a}function Fh(t,e,r,n,i,s){return!s&&!t.isPointInArea(e)?[]:r==="r"&&!n?Lb(t,e,r,i):Mb(t,e,r,n,i,s)}function em(t,e,r,n,i){const s=[],a=r==="x"?"inXRange":"inYRange";let o=!1;return Dc(t,r,e,(l,u,c)=>{l[a]&&l[a](e[r],i)&&(s.push({element:l,datasetIndex:u,index:c}),o=o||l.inRange(e.x,e.y,i))}),n&&!o?[]:s}var Bb={modes:{index(t,e,r,n){const i=Di(e,t),s=r.axis||"x",a=r.includeInvisible||!1,o=r.intersect?Rh(t,i,s,n,a):Fh(t,i,s,!1,n,a),l=[];return o.length?(t.getSortedVisibleDatasetMetas().forEach(u=>{const c=o[0].index,h=u.data[c];h&&!h.skip&&l.push({element:h,datasetIndex:u.index,index:c})}),l):[]},dataset(t,e,r,n){const i=Di(e,t),s=r.axis||"xy",a=r.includeInvisible||!1;let o=r.intersect?Rh(t,i,s,n,a):Fh(t,i,s,!1,n,a);if(o.length>0){const l=o[0].datasetIndex,u=t.getDatasetMeta(l).data;o=[];for(let c=0;c<u.length;++c)o.push({element:u[c],datasetIndex:l,index:c})}return o},point(t,e,r,n){const i=Di(e,t),s=r.axis||"xy",a=r.includeInvisible||!1;return Rh(t,i,s,n,a)},nearest(t,e,r,n){const i=Di(e,t),s=r.axis||"xy",a=r.includeInvisible||!1;return Fh(t,i,s,r.intersect,n,a)},x(t,e,r,n){const i=Di(e,t);return em(t,i,"x",r.intersect,n)},y(t,e,r,n){const i=Di(e,t);return em(t,i,"y",r.intersect,n)}}};const I_=["left","top","right","bottom"];function Ia(t,e){return t.filter(r=>r.pos===e)}function tm(t,e){return t.filter(r=>I_.indexOf(r.pos)===-1&&r.box.axis===e)}function Da(t,e){return t.sort((r,n)=>{const i=e?n:r,s=e?r:n;return i.weight===s.weight?i.index-s.index:i.weight-s.weight})}function jb(t){const e=[];let r,n,i,s,a,o;for(r=0,n=(t||[]).length;r<n;++r)i=t[r],{position:s,options:{stack:a,stackWeight:o=1}}=i,e.push({index:r,box:i,pos:s,horizontal:i.isHorizontal(),weight:i.weight,stack:a&&s+a,stackWeight:o});return e}function Ub(t){const e={};for(const r of t){const{stack:n,pos:i,stackWeight:s}=r;if(!n||!I_.includes(i))continue;const a=e[n]||(e[n]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=s}return e}function $b(t,e){const r=Ub(t),{vBoxMaxWidth:n,hBoxMaxHeight:i}=e;let s,a,o;for(s=0,a=t.length;s<a;++s){o=t[s];const{fullSize:l}=o.box,u=r[o.stack],c=u&&o.stackWeight/u.weight;o.horizontal?(o.width=c?c*n:l&&e.availableWidth,o.height=i):(o.width=n,o.height=c?c*i:l&&e.availableHeight)}return r}function zb(t){const e=jb(t),r=Da(e.filter(u=>u.box.fullSize),!0),n=Da(Ia(e,"left"),!0),i=Da(Ia(e,"right")),s=Da(Ia(e,"top"),!0),a=Da(Ia(e,"bottom")),o=tm(e,"x"),l=tm(e,"y");return{fullSize:r,leftAndTop:n.concat(s),rightAndBottom:i.concat(l).concat(a).concat(o),chartArea:Ia(e,"chartArea"),vertical:n.concat(i).concat(l),horizontal:s.concat(a).concat(o)}}function rm(t,e,r,n){return Math.max(t[r],e[r])+Math.max(t[n],e[n])}function D_(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function Wb(t,e,r,n){const{pos:i,box:s}=r,a=t.maxPadding;if(!Ce(i)){r.size&&(t[i]-=r.size);const h=n[r.stack]||{size:0,count:1};h.size=Math.max(h.size,r.horizontal?s.height:s.width),r.size=h.size/h.count,t[i]+=r.size}s.getPadding&&D_(a,s.getPadding());const o=Math.max(0,e.outerWidth-rm(a,t,"left","right")),l=Math.max(0,e.outerHeight-rm(a,t,"top","bottom")),u=o!==t.w,c=l!==t.h;return t.w=o,t.h=l,r.horizontal?{same:u,other:c}:{same:c,other:u}}function Hb(t){const e=t.maxPadding;function r(n){const i=Math.max(e[n]-t[n],0);return t[n]+=i,i}t.y+=r("top"),t.x+=r("left"),r("right"),r("bottom")}function Vb(t,e){const r=e.maxPadding;function n(i){const s={left:0,top:0,right:0,bottom:0};return i.forEach(a=>{s[a]=Math.max(e[a],r[a])}),s}return n(t?["left","right"]:["top","bottom"])}function Wa(t,e,r,n){const i=[];let s,a,o,l,u,c;for(s=0,a=t.length,u=0;s<a;++s){o=t[s],l=o.box,l.update(o.width||e.w,o.height||e.h,Vb(o.horizontal,e));const{same:h,other:f}=Wb(e,r,o,n);u|=h&&i.length,c=c||f,l.fullSize||i.push(o)}return u&&Wa(i,e,r,n)||c}function Fl(t,e,r,n,i){t.top=r,t.left=e,t.right=e+n,t.bottom=r+i,t.width=n,t.height=i}function nm(t,e,r,n){const i=r.padding;let{x:s,y:a}=e;for(const o of t){const l=o.box,u=n[o.stack]||{placed:0,weight:1},c=o.stackWeight/u.weight||1;if(o.horizontal){const h=e.w*c,f=u.size||l.height;No(u.start)&&(a=u.start),l.fullSize?Fl(l,i.left,a,r.outerWidth-i.right-i.left,f):Fl(l,e.left+u.placed,a,h,f),u.start=a,u.placed+=h,a=l.bottom}else{const h=e.h*c,f=u.size||l.width;No(u.start)&&(s=u.start),l.fullSize?Fl(l,s,i.top,f,r.outerHeight-i.bottom-i.top):Fl(l,s,e.top+u.placed,f,h),u.start=s,u.placed+=h,s=l.right}}e.x=s,e.y=a}var Pr={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(r){e.draw(r)}}]},t.boxes.push(e)},removeBox(t,e){const r=t.boxes?t.boxes.indexOf(e):-1;r!==-1&&t.boxes.splice(r,1)},configure(t,e,r){e.fullSize=r.fullSize,e.position=r.position,e.weight=r.weight},update(t,e,r,n){if(!t)return;const i=Nr(t.options.layout.padding),s=Math.max(e-i.width,0),a=Math.max(r-i.height,0),o=zb(t.boxes),l=o.vertical,u=o.horizontal;Ne(t.boxes,p=>{typeof p.beforeLayout=="function"&&p.beforeLayout()});const c=l.reduce((p,m)=>m.box.options&&m.box.options.display===!1?p:p+1,0)||1,h=Object.freeze({outerWidth:e,outerHeight:r,padding:i,availableWidth:s,availableHeight:a,vBoxMaxWidth:s/2/c,hBoxMaxHeight:a/2}),f=Object.assign({},i);D_(f,Nr(n));const d=Object.assign({maxPadding:f,w:s,h:a,x:i.left,y:i.top},i),g=$b(l.concat(u),h);Wa(o.fullSize,d,h,g),Wa(l,d,h,g),Wa(u,d,h,g)&&Wa(l,d,h,g),Hb(d),nm(o.leftAndTop,d,h,g),d.x+=d.w,d.y+=d.h,nm(o.rightAndBottom,d,h,g),t.chartArea={left:d.left,top:d.top,right:d.left+d.w,bottom:d.top+d.h,height:d.h,width:d.w},Ne(o.chartArea,p=>{const m=p.box;Object.assign(m,t.chartArea),m.update(d.w,d.h,{left:0,top:0,right:0,bottom:0})})}};class N_{acquireContext(e,r){}releaseContext(e){return!1}addEventListener(e,r,n){}removeEventListener(e,r,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,r,n,i){return r=Math.max(0,r||e.width),n=n||e.height,{width:r,height:Math.max(0,i?Math.floor(r/i):n)}}isAttached(e){return!0}updateConfig(e){}}class Gb extends N_{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const mu="$chartjs",Kb={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},im=t=>t===null||t==="";function Yb(t,e){const r=t.style,n=t.getAttribute("height"),i=t.getAttribute("width");if(t[mu]={initial:{height:n,width:i,style:{display:r.display,height:r.height,width:r.width}}},r.display=r.display||"block",r.boxSizing=r.boxSizing||"border-box",im(i)){const s=Hg(t,"width");s!==void 0&&(t.width=s)}if(im(n))if(t.style.height==="")t.height=t.width/(e||2);else{const s=Hg(t,"height");s!==void 0&&(t.height=s)}return t}const L_=ib?{passive:!0}:!1;function Xb(t,e,r){t&&t.addEventListener(e,r,L_)}function qb(t,e,r){t&&t.canvas&&t.canvas.removeEventListener(e,r,L_)}function Jb(t,e){const r=Kb[t.type]||t.type,{x:n,y:i}=Di(t,e);return{type:r,chart:e,native:t,x:n!==void 0?n:null,y:i!==void 0?i:null}}function Xu(t,e){for(const r of t)if(r===e||r.contains(e))return!0}function Qb(t,e,r){const n=t.canvas,i=new MutationObserver(s=>{let a=!1;for(const o of s)a=a||Xu(o.addedNodes,n),a=a&&!Xu(o.removedNodes,n);a&&r()});return i.observe(document,{childList:!0,subtree:!0}),i}function Zb(t,e,r){const n=t.canvas,i=new MutationObserver(s=>{let a=!1;for(const o of s)a=a||Xu(o.removedNodes,n),a=a&&!Xu(o.addedNodes,n);a&&r()});return i.observe(document,{childList:!0,subtree:!0}),i}const Mo=new Map;let sm=0;function M_(){const t=window.devicePixelRatio;t!==sm&&(sm=t,Mo.forEach((e,r)=>{r.currentDevicePixelRatio!==t&&e()}))}function eA(t,e){Mo.size||window.addEventListener("resize",M_),Mo.set(t,e)}function tA(t){Mo.delete(t),Mo.size||window.removeEventListener("resize",M_)}function rA(t,e,r){const n=t.canvas,i=n&&A0(n);if(!i)return;const s=m_((o,l)=>{const u=i.clientWidth;r(o,l),u<i.clientWidth&&r()},window),a=new ResizeObserver(o=>{const l=o[0],u=l.contentRect.width,c=l.contentRect.height;u===0&&c===0||s(u,c)});return a.observe(i),eA(t,s),a}function Ih(t,e,r){r&&r.disconnect(),e==="resize"&&tA(t)}function nA(t,e,r){const n=t.canvas,i=m_(s=>{t.ctx!==null&&r(Jb(s,t))},t);return Xb(n,e,i),i}class iA extends N_{acquireContext(e,r){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(Yb(e,r),n):null}releaseContext(e){const r=e.canvas;if(!r[mu])return!1;const n=r[mu].initial;["height","width"].forEach(s=>{const a=n[s];$e(a)?r.removeAttribute(s):r.setAttribute(s,a)});const i=n.style||{};return Object.keys(i).forEach(s=>{r.style[s]=i[s]}),r.width=r.width,delete r[mu],!0}addEventListener(e,r,n){this.removeEventListener(e,r);const i=e.$proxies||(e.$proxies={}),a={attach:Qb,detach:Zb,resize:rA}[r]||nA;i[r]=a(e,r,n)}removeEventListener(e,r){const n=e.$proxies||(e.$proxies={}),i=n[r];if(!i)return;({attach:Ih,detach:Ih,resize:Ih}[r]||qb)(e,r,i),n[r]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,r,n,i){return nb(e,r,n,i)}isAttached(e){const r=e&&A0(e);return!!(r&&r.isConnected)}}function sA(t){return!b0()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?Gb:iA}class pi{constructor(){ke(this,"x");ke(this,"y");ke(this,"active",!1);ke(this,"options");ke(this,"$animations")}tooltipPosition(e){const{x:r,y:n}=this.getProps(["x","y"],e);return{x:r,y:n}}hasValue(){return Gu(this.x)&&Gu(this.y)}getProps(e,r){const n=this.$animations;if(!r||!n)return this;const i={};return e.forEach(s=>{i[s]=n[s]&&n[s].active()?n[s]._to:this[s]}),i}}ke(pi,"defaults",{}),ke(pi,"defaultRoutes");function aA(t,e){const r=t.options.ticks,n=oA(t),i=Math.min(r.maxTicksLimit||n,n),s=r.major.enabled?uA(e):[],a=s.length,o=s[0],l=s[a-1],u=[];if(a>i)return cA(e,u,s,a/i),u;const c=lA(s,e,i);if(a>0){let h,f;const d=a>1?Math.round((l-o)/(a-1)):null;for(Il(e,u,c,$e(d)?0:o-d,o),h=0,f=a-1;h<f;h++)Il(e,u,c,s[h],s[h+1]);return Il(e,u,c,l,$e(d)?e.length:l+d),u}return Il(e,u,c),u}function oA(t){const e=t.options.offset,r=t._tickSize(),n=t._length/r+(e?0:1),i=t._maxLength/r;return Math.floor(Math.min(n,i))}function lA(t,e,r){const n=hA(t),i=e.length/r;if(!n)return Math.max(i,1);const s=hk(n);for(let a=0,o=s.length-1;a<o;a++){const l=s[a];if(l>i)return l}return Math.max(i,1)}function uA(t){const e=[];let r,n;for(r=0,n=t.length;r<n;r++)t[r].major&&e.push(r);return e}function cA(t,e,r,n){let i=0,s=r[0],a;for(n=Math.ceil(n),a=0;a<t.length;a++)a===s&&(e.push(t[a]),i++,s=r[i*n])}function Il(t,e,r,n,i){const s=Re(n,0),a=Math.min(Re(i,t.length),t.length);let o=0,l,u,c;for(r=Math.ceil(r),i&&(l=i-n,r=l/Math.floor(l/r)),c=s;c<0;)o++,c=Math.round(s+o*r);for(u=Math.max(s,0);u<a;u++)u===c&&(e.push(t[u]),o++,c=Math.round(s+o*r))}function hA(t){const e=t.length;let r,n;if(e<2)return!1;for(n=t[0],r=1;r<e;++r)if(t[r]-t[r-1]!==n)return!1;return n}const fA=t=>t==="left"?"right":t==="right"?"left":t,am=(t,e,r)=>e==="top"||e==="left"?t[e]+r:t[e]-r,om=(t,e)=>Math.min(e||t,t);function lm(t,e){const r=[],n=t.length/e,i=t.length;let s=0;for(;s<i;s+=n)r.push(t[Math.floor(s)]);return r}function dA(t,e,r){const n=t.ticks.length,i=Math.min(e,n-1),s=t._startPixel,a=t._endPixel,o=1e-6;let l=t.getPixelForTick(i),u;if(!(r&&(n===1?u=Math.max(l-s,a-l):e===0?u=(t.getPixelForTick(1)-l)/2:u=(l-t.getPixelForTick(i-1))/2,l+=i<e?u:-u,l<s-o||l>a+o)))return l}function pA(t,e){Ne(t,r=>{const n=r.gc,i=n.length/2;let s;if(i>e){for(s=0;s<i;++s)delete r.data[n[s]];n.splice(0,i)}})}function Na(t){return t.drawTicks?t.tickLength:0}function um(t,e){if(!t.display)return 0;const r=Bt(t.font,e),n=Nr(t.padding);return(gt(t.text)?t.text.length:1)*r.lineHeight+n.height}function gA(t,e){return fa(t,{scale:e,type:"scale"})}function mA(t,e,r){return fa(t,{tick:r,index:e,type:"tick"})}function vA(t,e,r){let n=y0(t);return(r&&e!=="right"||!r&&e==="right")&&(n=fA(n)),n}function xA(t,e,r,n){const{top:i,left:s,bottom:a,right:o,chart:l}=t,{chartArea:u,scales:c}=l;let h=0,f,d,g;const p=a-i,m=o-s;if(t.isHorizontal()){if(d=Lt(n,s,o),Ce(r)){const v=Object.keys(r)[0],x=r[v];g=c[v].getPixelForValue(x)+p-e}else r==="center"?g=(u.bottom+u.top)/2+p-e:g=am(t,r,e);f=o-s}else{if(Ce(r)){const v=Object.keys(r)[0],x=r[v];d=c[v].getPixelForValue(x)-m+e}else r==="center"?d=(u.left+u.right)/2-m+e:d=am(t,r,e);g=Lt(n,a,i),h=r==="left"?-Xr:Xr}return{titleX:d,titleY:g,maxWidth:f,rotation:h}}class da extends pi{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,r){return e}getUserBounds(){let{_userMin:e,_userMax:r,_suggestedMin:n,_suggestedMax:i}=this;return e=sn(e,Number.POSITIVE_INFINITY),r=sn(r,Number.NEGATIVE_INFINITY),n=sn(n,Number.POSITIVE_INFINITY),i=sn(i,Number.NEGATIVE_INFINITY),{min:sn(e,n),max:sn(r,i),minDefined:Dr(e),maxDefined:Dr(r)}}getMinMax(e){let{min:r,max:n,minDefined:i,maxDefined:s}=this.getUserBounds(),a;if(i&&s)return{min:r,max:n};const o=this.getMatchingVisibleMetas();for(let l=0,u=o.length;l<u;++l)a=o[l].controller.getMinMax(this,e),i||(r=Math.min(r,a.min)),s||(n=Math.max(n,a.max));return r=s&&r>n?n:r,n=i&&r>n?r:n,{min:sn(r,sn(n,r)),max:sn(n,sn(r,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Ve(this.options.beforeUpdate,[this])}update(e,r,n){const{beginAtZero:i,grace:s,ticks:a}=this.options,o=a.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=r,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=zk(this,s,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=o<this.ticks.length;this._convertTicksToLabels(l?lm(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=aA(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,r,n;this.isHorizontal()?(r=this.left,n=this.right):(r=this.top,n=this.bottom,e=!e),this._startPixel=r,this._endPixel=n,this._reversePixels=e,this._length=n-r,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Ve(this.options.afterUpdate,[this])}beforeSetDimensions(){Ve(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Ve(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Ve(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Ve(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const r=this.options.ticks;let n,i,s;for(n=0,i=e.length;n<i;n++)s=e[n],s.label=Ve(r.callback,[s.value,n,e],this)}afterTickToLabelConversion(){Ve(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Ve(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,r=e.ticks,n=om(this.ticks.length,e.ticks.maxTicksLimit),i=r.minRotation||0,s=r.maxRotation;let a=i,o,l,u;if(!this._isVisible()||!r.display||i>=s||n<=1||!this.isHorizontal()){this.labelRotation=i;return}const c=this._getLabelSizes(),h=c.widest.width,f=c.highest.height,d=qr(this.chart.width-h,0,this.maxWidth);o=e.offset?this.maxWidth/n:d/(n-1),h+6>o&&(o=d/(n-(e.offset?.5:1)),l=this.maxHeight-Na(e.grid)-r.padding-um(e.title,this.chart.options.font),u=Math.sqrt(h*h+f*f),a=gk(Math.min(Math.asin(qr((c.highest.height+6)/o,-1,1)),Math.asin(qr(l/u,-1,1))-Math.asin(qr(f/u,-1,1)))),a=Math.max(i,Math.min(s,a))),this.labelRotation=a}afterCalculateLabelRotation(){Ve(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Ve(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:r,options:{ticks:n,title:i,grid:s}}=this,a=this._isVisible(),o=this.isHorizontal();if(a){const l=um(i,r.options.font);if(o?(e.width=this.maxWidth,e.height=Na(s)+l):(e.height=this.maxHeight,e.width=Na(s)+l),n.display&&this.ticks.length){const{first:u,last:c,widest:h,highest:f}=this._getLabelSizes(),d=n.padding*2,g=Wi(this.labelRotation),p=Math.cos(g),m=Math.sin(g);if(o){const v=n.mirror?0:m*h.width+p*f.height;e.height=Math.min(this.maxHeight,e.height+v+d)}else{const v=n.mirror?0:p*h.width+m*f.height;e.width=Math.min(this.maxWidth,e.width+v+d)}this._calculatePadding(u,c,m,p)}}this._handleMargins(),o?(this.width=this._length=r.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=r.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,r,n,i){const{ticks:{align:s,padding:a},position:o}=this.options,l=this.labelRotation!==0,u=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const c=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,d=0;l?u?(f=i*e.width,d=n*r.height):(f=n*e.height,d=i*r.width):s==="start"?d=r.width:s==="end"?f=e.width:s!=="inner"&&(f=e.width/2,d=r.width/2),this.paddingLeft=Math.max((f-c+a)*this.width/(this.width-c),0),this.paddingRight=Math.max((d-h+a)*this.width/(this.width-h),0)}else{let c=r.height/2,h=e.height/2;s==="start"?(c=0,h=e.height):s==="end"&&(c=r.height,h=0),this.paddingTop=c+a,this.paddingBottom=h+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Ve(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:r}=this.options;return r==="top"||r==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let r,n;for(r=0,n=e.length;r<n;r++)$e(e[r].label)&&(e.splice(r,1),n--,r--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const r=this.options.ticks.sampleSize;let n=this.ticks;r<n.length&&(n=lm(n,r)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,r,n){const{ctx:i,_longestTextCache:s}=this,a=[],o=[],l=Math.floor(r/om(r,n));let u=0,c=0,h,f,d,g,p,m,v,x,_,w,O;for(h=0;h<r;h+=l){if(g=e[h].label,p=this._resolveTickFontOptions(h),i.font=m=p.string,v=s[m]=s[m]||{data:{},gc:[]},x=p.lineHeight,_=w=0,!$e(g)&&!gt(g))_=Bg(i,v.data,v.gc,_,g),w=x;else if(gt(g))for(f=0,d=g.length;f<d;++f)O=g[f],!$e(O)&&!gt(O)&&(_=Bg(i,v.data,v.gc,_,O),w+=x);a.push(_),o.push(w),u=Math.max(_,u),c=Math.max(w,c)}pA(s,r);const R=a.indexOf(u),T=o.indexOf(c),P=F=>({width:a[F]||0,height:o[F]||0});return{first:P(0),last:P(r-1),widest:P(R),highest:P(T),widths:a,heights:o}}getLabelForValue(e){return e}getPixelForValue(e,r){return NaN}getValueForPixel(e){}getPixelForTick(e){const r=this.ticks;return e<0||e>r.length-1?null:this.getPixelForValue(r[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const r=this._startPixel+e*this._length;return _k(this._alignToPixels?Oi(this.chart,r,0):r)}getDecimalForPixel(e){const r=(e-this._startPixel)/this._length;return this._reversePixels?1-r:r}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:r}=this;return e<0&&r<0?r:e>0&&r>0?e:0}getContext(e){const r=this.ticks||[];if(e>=0&&e<r.length){const n=r[e];return n.$context||(n.$context=mA(this.getContext(),e,n))}return this.$context||(this.$context=gA(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,r=Wi(this.labelRotation),n=Math.abs(Math.cos(r)),i=Math.abs(Math.sin(r)),s=this._getLabelSizes(),a=e.autoSkipPadding||0,o=s?s.widest.width+a:0,l=s?s.highest.height+a:0;return this.isHorizontal()?l*n>o*i?o/n:l/i:l*i<o*n?l/n:o/i}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const r=this.axis,n=this.chart,i=this.options,{grid:s,position:a,border:o}=i,l=s.offset,u=this.isHorizontal(),h=this.ticks.length+(l?1:0),f=Na(s),d=[],g=o.setContext(this.getContext()),p=g.display?g.width:0,m=p/2,v=function(we){return Oi(n,we,p)};let x,_,w,O,R,T,P,F,N,U,H,Z;if(a==="top")x=v(this.bottom),T=this.bottom-f,F=x-m,U=v(e.top)+m,Z=e.bottom;else if(a==="bottom")x=v(this.top),U=e.top,Z=v(e.bottom)-m,T=x+m,F=this.top+f;else if(a==="left")x=v(this.right),R=this.right-f,P=x-m,N=v(e.left)+m,H=e.right;else if(a==="right")x=v(this.left),N=e.left,H=v(e.right)-m,R=x+m,P=this.left+f;else if(r==="x"){if(a==="center")x=v((e.top+e.bottom)/2+.5);else if(Ce(a)){const we=Object.keys(a)[0],_e=a[we];x=v(this.chart.scales[we].getPixelForValue(_e))}U=e.top,Z=e.bottom,T=x+m,F=T+f}else if(r==="y"){if(a==="center")x=v((e.left+e.right)/2);else if(Ce(a)){const we=Object.keys(a)[0],_e=a[we];x=v(this.chart.scales[we].getPixelForValue(_e))}R=x-m,P=R-f,N=e.left,H=e.right}const ve=Re(i.ticks.maxTicksLimit,h),oe=Math.max(1,Math.ceil(h/ve));for(_=0;_<h;_+=oe){const we=this.getContext(_),_e=s.setContext(we),Y=o.setContext(we),q=_e.lineWidth,he=_e.color,xe=Y.dash||[],C=Y.dashOffset,L=_e.tickWidth,I=_e.tickColor,D=_e.tickBorderDash||[],G=_e.tickBorderDashOffset;w=dA(this,_,l),w!==void 0&&(O=Oi(n,w,q),u?R=P=N=H=O:T=F=U=Z=O,d.push({tx1:R,ty1:T,tx2:P,ty2:F,x1:N,y1:U,x2:H,y2:Z,width:q,color:he,borderDash:xe,borderDashOffset:C,tickWidth:L,tickColor:I,tickBorderDash:D,tickBorderDashOffset:G}))}return this._ticksLength=h,this._borderValue=x,d}_computeLabelItems(e){const r=this.axis,n=this.options,{position:i,ticks:s}=n,a=this.isHorizontal(),o=this.ticks,{align:l,crossAlign:u,padding:c,mirror:h}=s,f=Na(n.grid),d=f+c,g=h?-c:d,p=-Wi(this.labelRotation),m=[];let v,x,_,w,O,R,T,P,F,N,U,H,Z="middle";if(i==="top")R=this.bottom-g,T=this._getXAxisLabelAlignment();else if(i==="bottom")R=this.top+g,T=this._getXAxisLabelAlignment();else if(i==="left"){const oe=this._getYAxisLabelAlignment(f);T=oe.textAlign,O=oe.x}else if(i==="right"){const oe=this._getYAxisLabelAlignment(f);T=oe.textAlign,O=oe.x}else if(r==="x"){if(i==="center")R=(e.top+e.bottom)/2+d;else if(Ce(i)){const oe=Object.keys(i)[0],we=i[oe];R=this.chart.scales[oe].getPixelForValue(we)+d}T=this._getXAxisLabelAlignment()}else if(r==="y"){if(i==="center")O=(e.left+e.right)/2-d;else if(Ce(i)){const oe=Object.keys(i)[0],we=i[oe];O=this.chart.scales[oe].getPixelForValue(we)}T=this._getYAxisLabelAlignment(f).textAlign}r==="y"&&(l==="start"?Z="top":l==="end"&&(Z="bottom"));const ve=this._getLabelSizes();for(v=0,x=o.length;v<x;++v){_=o[v],w=_.label;const oe=s.setContext(this.getContext(v));P=this.getPixelForTick(v)+s.labelOffset,F=this._resolveTickFontOptions(v),N=F.lineHeight,U=gt(w)?w.length:1;const we=U/2,_e=oe.color,Y=oe.textStrokeColor,q=oe.textStrokeWidth;let he=T;a?(O=P,T==="inner"&&(v===x-1?he=this.options.reverse?"left":"right":v===0?he=this.options.reverse?"right":"left":he="center"),i==="top"?u==="near"||p!==0?H=-U*N+N/2:u==="center"?H=-ve.highest.height/2-we*N+N:H=-ve.highest.height+N/2:u==="near"||p!==0?H=N/2:u==="center"?H=ve.highest.height/2-we*N:H=ve.highest.height-U*N,h&&(H*=-1),p!==0&&!oe.showLabelBackdrop&&(O+=N/2*Math.sin(p))):(R=P,H=(1-U)*N/2);let xe;if(oe.showLabelBackdrop){const C=Nr(oe.backdropPadding),L=ve.heights[v],I=ve.widths[v];let D=H-C.top,G=0-C.left;switch(Z){case"middle":D-=L/2;break;case"bottom":D-=L;break}switch(T){case"center":G-=I/2;break;case"right":G-=I;break;case"inner":v===x-1?G-=I:v>0&&(G-=I/2);break}xe={left:G,top:D,width:I+C.width,height:L+C.height,color:oe.backdropColor}}m.push({label:w,font:F,textOffset:H,options:{rotation:p,color:_e,strokeColor:Y,strokeWidth:q,textAlign:he,textBaseline:Z,translation:[O,R],backdrop:xe}})}return m}_getXAxisLabelAlignment(){const{position:e,ticks:r}=this.options;if(-Wi(this.labelRotation))return e==="top"?"left":"right";let i="center";return r.align==="start"?i="left":r.align==="end"?i="right":r.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:r,ticks:{crossAlign:n,mirror:i,padding:s}}=this.options,a=this._getLabelSizes(),o=e+s,l=a.widest.width;let u,c;return r==="left"?i?(c=this.right+s,n==="near"?u="left":n==="center"?(u="center",c+=l/2):(u="right",c+=l)):(c=this.right-o,n==="near"?u="right":n==="center"?(u="center",c-=l/2):(u="left",c=this.left)):r==="right"?i?(c=this.left+s,n==="near"?u="right":n==="center"?(u="center",c-=l/2):(u="left",c-=l)):(c=this.left+o,n==="near"?u="left":n==="center"?(u="center",c+=l/2):(u="right",c=this.right)):u="right",{textAlign:u,x:c}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,r=this.options.position;if(r==="left"||r==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(r==="top"||r==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:r},left:n,top:i,width:s,height:a}=this;r&&(e.save(),e.fillStyle=r,e.fillRect(n,i,s,a),e.restore())}getLineWidthForValue(e){const r=this.options.grid;if(!this._isVisible()||!r.display)return 0;const i=this.ticks.findIndex(s=>s.value===e);return i>=0?r.setContext(this.getContext(i)).lineWidth:0}drawGrid(e){const r=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,a;const o=(l,u,c)=>{!c.width||!c.color||(n.save(),n.lineWidth=c.width,n.strokeStyle=c.color,n.setLineDash(c.borderDash||[]),n.lineDashOffset=c.borderDashOffset,n.beginPath(),n.moveTo(l.x,l.y),n.lineTo(u.x,u.y),n.stroke(),n.restore())};if(r.display)for(s=0,a=i.length;s<a;++s){const l=i[s];r.drawOnChartArea&&o({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),r.drawTicks&&o({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:r,options:{border:n,grid:i}}=this,s=n.setContext(this.getContext()),a=n.display?s.width:0;if(!a)return;const o=i.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let u,c,h,f;this.isHorizontal()?(u=Oi(e,this.left,a)-a/2,c=Oi(e,this.right,o)+o/2,h=f=l):(h=Oi(e,this.top,a)-a/2,f=Oi(e,this.bottom,o)+o/2,u=c=l),r.save(),r.lineWidth=s.width,r.strokeStyle=s.color,r.beginPath(),r.moveTo(u,h),r.lineTo(c,f),r.stroke(),r.restore()}drawLabels(e){if(!this.options.ticks.display)return;const n=this.ctx,i=this._computeLabelArea();i&&w0(n,i);const s=this.getLabelItems(e);for(const a of s){const o=a.options,l=a.font,u=a.label,c=a.textOffset;Lo(n,u,0,c,l,o)}i&&S0(n)}drawTitle(){const{ctx:e,options:{position:r,title:n,reverse:i}}=this;if(!n.display)return;const s=Bt(n.font),a=Nr(n.padding),o=n.align;let l=s.lineHeight/2;r==="bottom"||r==="center"||Ce(r)?(l+=a.bottom,gt(n.text)&&(l+=s.lineHeight*(n.text.length-1))):l+=a.top;const{titleX:u,titleY:c,maxWidth:h,rotation:f}=xA(this,l,r,o);Lo(e,n.text,0,0,s,{color:n.color,maxWidth:h,rotation:f,textAlign:vA(o,r,i),textBaseline:"middle",translation:[u,c]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,r=e.ticks&&e.ticks.z||0,n=Re(e.grid&&e.grid.z,-1),i=Re(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==da.prototype.draw?[{z:r,draw:s=>{this.draw(s)}}]:[{z:n,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:r,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const r=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let s,a;for(s=0,a=r.length;s<a;++s){const o=r[s];o[n]===this.id&&(!e||o.type===e)&&i.push(o)}return i}_resolveTickFontOptions(e){const r=this.options.ticks.setContext(this.getContext(e));return Bt(r.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Dl{constructor(e,r,n){this.type=e,this.scope=r,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const r=Object.getPrototypeOf(e);let n;wA(r)&&(n=this.register(r));const i=this.items,s=e.id,a=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in i||(i[s]=e,_A(e,a,n),this.override&&at.override(e.id,e.overrides)),a}get(e){return this.items[e]}unregister(e){const r=this.items,n=e.id,i=this.scope;n in r&&delete r[n],i&&n in at[i]&&(delete at[i][n],this.override&&delete es[n])}}function _A(t,e,r){const n=Do(Object.create(null),[r?at.get(r):{},at.get(e),t.defaults]);at.set(e,n),t.defaultRoutes&&yA(e,t.defaultRoutes),t.descriptors&&at.describe(e,t.descriptors)}function yA(t,e){Object.keys(e).forEach(r=>{const n=r.split("."),i=n.pop(),s=[t].concat(n).join("."),a=e[r].split("."),o=a.pop(),l=a.join(".");at.route(s,i,l,o)})}function wA(t){return"id"in t&&"defaults"in t}class SA{constructor(){this.controllers=new Dl(ao,"datasets",!0),this.elements=new Dl(pi,"elements"),this.plugins=new Dl(Object,"plugins"),this.scales=new Dl(da,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,r,n){[...r].forEach(i=>{const s=n||this._getRegistryForType(i);n||s.isForType(i)||s===this.plugins&&i.id?this._exec(e,s,i):Ne(i,a=>{const o=n||this._getRegistryForType(a);this._exec(e,o,a)})})}_exec(e,r,n){const i=x0(e);Ve(n["before"+i],[],n),r[e](n),Ve(n["after"+i],[],n)}_getRegistryForType(e){for(let r=0;r<this._typedRegistries.length;r++){const n=this._typedRegistries[r];if(n.isForType(e))return n}return this.plugins}_get(e,r,n){const i=r.get(e);if(i===void 0)throw new Error('"'+e+'" is not a registered '+n+".");return i}}var cn=new SA;class EA{constructor(){this._init=void 0}notify(e,r,n,i){if(r==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const s=i?this._descriptors(e).filter(i):this._descriptors(e),a=this._notify(s,e,r,n);return r==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),a}_notify(e,r,n,i){i=i||{};for(const s of e){const a=s.plugin,o=a[n],l=[r,i,s.options];if(Ve(o,l,a)===!1&&i.cancelable)return!1}return!0}invalidate(){$e(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const r=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),r}_createDescriptors(e,r){const n=e&&e.config,i=Re(n.options&&n.options.plugins,{}),s=TA(n);return i===!1&&!r?[]:bA(e,s,i,r)}_notifyStateChanges(e){const r=this._oldCache||[],n=this._cache,i=(s,a)=>s.filter(o=>!a.some(l=>o.plugin.id===l.plugin.id));this._notify(i(r,n),e,"stop"),this._notify(i(n,r),e,"start")}}function TA(t){const e={},r=[],n=Object.keys(cn.plugins.items);for(let s=0;s<n.length;s++)r.push(cn.getPlugin(n[s]));const i=t.plugins||[];for(let s=0;s<i.length;s++){const a=i[s];r.indexOf(a)===-1&&(r.push(a),e[a.id]=!0)}return{plugins:r,localIds:e}}function kA(t,e){return!e&&t===!1?null:t===!0?{}:t}function bA(t,{plugins:e,localIds:r},n,i){const s=[],a=t.getContext();for(const o of e){const l=o.id,u=kA(n[l],i);u!==null&&s.push({plugin:o,options:AA(t.config,{plugin:o,local:r[l]},u,a)})}return s}function AA(t,{plugin:e,local:r},n,i){const s=t.pluginScopeKeys(e),a=t.getOptionScopes(n,s);return r&&e.defaults&&a.push(e.defaults),t.createResolver(a,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Qf(t,e){const r=at.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||r.indexAxis||"x"}function OA(t,e){let r=t;return t==="_index_"?r=e:t==="_value_"&&(r=e==="x"?"y":"x"),r}function CA(t,e){return t===e?"_index_":"_value_"}function cm(t){if(t==="x"||t==="y"||t==="r")return t}function PA(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function Zf(t,...e){if(cm(t))return t;for(const r of e){const n=r.axis||PA(r.position)||t.length>1&&cm(t[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function hm(t,e,r){if(r[e+"AxisID"]===t)return{axis:e}}function RA(t,e){if(e.data&&e.data.datasets){const r=e.data.datasets.filter(n=>n.xAxisID===t||n.yAxisID===t);if(r.length)return hm(t,"x",r[0])||hm(t,"y",r[0])}return{}}function FA(t,e){const r=es[t.type]||{scales:{}},n=e.scales||{},i=Qf(t.type,e),s=Object.create(null);return Object.keys(n).forEach(a=>{const o=n[a];if(!Ce(o))return console.error(`Invalid scale configuration for scale: ${a}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${a}`);const l=Zf(a,o,RA(a,t),at.scales[o.type]),u=CA(l,i),c=r.scales||{};s[a]=no(Object.create(null),[{axis:l},o,c[l],c[u]])}),t.data.datasets.forEach(a=>{const o=a.type||t.type,l=a.indexAxis||Qf(o,e),c=(es[o]||{}).scales||{};Object.keys(c).forEach(h=>{const f=OA(h,l),d=a[f+"AxisID"]||f;s[d]=s[d]||Object.create(null),no(s[d],[{axis:f},n[d],c[h]])})}),Object.keys(s).forEach(a=>{const o=s[a];no(o,[at.scales[o.type],at.scale])}),s}function B_(t){const e=t.options||(t.options={});e.plugins=Re(e.plugins,{}),e.scales=FA(t,e)}function j_(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function IA(t){return t=t||{},t.data=j_(t.data),B_(t),t}const fm=new Map,U_=new Set;function Nl(t,e){let r=fm.get(t);return r||(r=e(),fm.set(t,r),U_.add(r)),r}const La=(t,e,r)=>{const n=sa(e,r);n!==void 0&&t.add(n)};class DA{constructor(e){this._config=IA(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=j_(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),B_(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Nl(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,r){return Nl(`${e}.transition.${r}`,()=>[[`datasets.${e}.transitions.${r}`,`transitions.${r}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,r){return Nl(`${e}-${r}`,()=>[[`datasets.${e}.elements.${r}`,`datasets.${e}`,`elements.${r}`,""]])}pluginScopeKeys(e){const r=e.id,n=this.type;return Nl(`${n}-plugin-${r}`,()=>[[`plugins.${r}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,r){const n=this._scopeCache;let i=n.get(e);return(!i||r)&&(i=new Map,n.set(e,i)),i}getOptionScopes(e,r,n){const{options:i,type:s}=this,a=this._cachedScopes(e,n),o=a.get(r);if(o)return o;const l=new Set;r.forEach(c=>{e&&(l.add(e),c.forEach(h=>La(l,e,h))),c.forEach(h=>La(l,i,h)),c.forEach(h=>La(l,es[s]||{},h)),c.forEach(h=>La(l,at,h)),c.forEach(h=>La(l,Jf,h))});const u=Array.from(l);return u.length===0&&u.push(Object.create(null)),U_.has(r)&&a.set(r,u),u}chartOptionScopes(){const{options:e,type:r}=this;return[e,es[r]||{},at.datasets[r]||{},{type:r},at,Jf]}resolveNamedOptions(e,r,n,i=[""]){const s={$shared:!0},{resolver:a,subPrefixes:o}=dm(this._resolverCache,e,i);let l=a;if(LA(a,r)){s.$shared=!1,n=di(n)?n():n;const u=this.createResolver(e,n,o);l=aa(a,n,u)}for(const u of r)s[u]=l[u];return s}createResolver(e,r,n=[""],i){const{resolver:s}=dm(this._resolverCache,e,n);return Ce(r)?aa(s,r,void 0,i):s}}function dm(t,e,r){let n=t.get(e);n||(n=new Map,t.set(e,n));const i=r.join();let s=n.get(i);return s||(s={resolver:E0(e,r),subPrefixes:r.filter(o=>!o.toLowerCase().includes("hover"))},n.set(i,s)),s}const NA=t=>Ce(t)&&Object.getOwnPropertyNames(t).some(e=>di(t[e]));function LA(t,e){const{isScriptable:r,isIndexable:n}=T_(t);for(const i of e){const s=r(i),a=n(i),o=(a||s)&&t[i];if(s&&(di(o)||NA(o))||a&&gt(o))return!0}return!1}var MA="4.5.1";const BA=["top","bottom","left","right","chartArea"];function pm(t,e){return t==="top"||t==="bottom"||BA.indexOf(t)===-1&&e==="x"}function gm(t,e){return function(r,n){return r[t]===n[t]?r[e]-n[e]:r[t]-n[t]}}function mm(t){const e=t.chart,r=e.options.animation;e.notifyPlugins("afterRender"),Ve(r&&r.onComplete,[t],e)}function jA(t){const e=t.chart,r=e.options.animation;Ve(r&&r.onProgress,[t],e)}function $_(t){return b0()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const vu={},vm=t=>{const e=$_(t);return Object.values(vu).filter(r=>r.canvas===e).pop()};function UA(t,e,r){const n=Object.keys(t);for(const i of n){const s=+i;if(s>=e){const a=t[i];delete t[i],(r>0||s>e)&&(t[s+r]=a)}}}function $A(t,e,r,n){return!r||t.type==="mouseout"?null:n?e:t}var $n;let Nc=($n=class{static register(...e){cn.add(...e),xm()}static unregister(...e){cn.remove(...e),xm()}constructor(e,r){const n=this.config=new DA(r),i=$_(e),s=vm(i);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const a=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||sA(i)),this.platform.updateConfig(n);const o=this.platform.acquireContext(i,a.aspectRatio),l=o&&o.canvas,u=l&&l.height,c=l&&l.width;if(this.id=nk(),this.ctx=o,this.canvas=l,this.width=c,this.height=u,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new EA,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Ek(h=>this.update(h),a.resizeDelay||0),this._dataChanges=[],vu[this.id]=this,!o||!l){console.error("Failed to create chart: can't acquire context from the given item");return}xn.listen(this,"complete",mm),xn.listen(this,"progress",jA),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:r},width:n,height:i,_aspectRatio:s}=this;return $e(e)?r&&s?s:i?n/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return cn}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Wg(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return jg(this.canvas,this.ctx),this}stop(){return xn.stop(this),this}resize(e,r){xn.running(this)?this._resizeBeforeDraw={width:e,height:r}:this._resize(e,r)}_resize(e,r){const n=this.options,i=this.canvas,s=n.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(i,e,r,s),o=n.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,Wg(this,o,!0)&&(this.notifyPlugins("resize",{size:a}),Ve(n.onResize,[this,a],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const r=this.options.scales||{};Ne(r,(n,i)=>{n.id=i})}buildOrUpdateScales(){const e=this.options,r=e.scales,n=this.scales,i=Object.keys(n).reduce((a,o)=>(a[o]=!1,a),{});let s=[];r&&(s=s.concat(Object.keys(r).map(a=>{const o=r[a],l=Zf(a,o),u=l==="r",c=l==="x";return{options:o,dposition:u?"chartArea":c?"bottom":"left",dtype:u?"radialLinear":c?"category":"linear"}}))),Ne(s,a=>{const o=a.options,l=o.id,u=Zf(l,o),c=Re(o.type,a.dtype);(o.position===void 0||pm(o.position,u)!==pm(a.dposition))&&(o.position=a.dposition),i[l]=!0;let h=null;if(l in n&&n[l].type===c)h=n[l];else{const f=cn.getScale(c);h=new f({id:l,type:c,ctx:this.ctx,chart:this}),n[h.id]=h}h.init(o,e)}),Ne(i,(a,o)=>{a||delete n[o]}),Ne(n,a=>{Pr.configure(this,a,a.options),Pr.addBox(this,a)})}_updateMetasets(){const e=this._metasets,r=this.data.datasets.length,n=e.length;if(e.sort((i,s)=>i.index-s.index),n>r){for(let i=r;i<n;++i)this._destroyDatasetMeta(i);e.splice(r,n-r)}this._sortedMetasets=e.slice(0).sort(gm("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:r}}=this;e.length>r.length&&delete this._stacks,e.forEach((n,i)=>{r.filter(s=>s===n._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const e=[],r=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=r.length;n<i;n++){const s=r[n];let a=this.getDatasetMeta(n);const o=s.type||this.config.type;if(a.type&&a.type!==o&&(this._destroyDatasetMeta(n),a=this.getDatasetMeta(n)),a.type=o,a.indexAxis=s.indexAxis||Qf(o,this.options),a.order=s.order||0,a.index=n,a.label=""+s.label,a.visible=this.isDatasetVisible(n),a.controller)a.controller.updateIndex(n),a.controller.linkScales();else{const l=cn.getController(o),{datasetElementType:u,dataElementType:c}=at.datasets[o];Object.assign(l,{dataElementType:cn.getElement(c),datasetElementType:u&&cn.getElement(u)}),a.controller=new l(this,n),e.push(a.controller)}}return this._updateMetasets(),e}_resetElements(){Ne(this.data.datasets,(e,r)=>{this.getDatasetMeta(r).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const r=this.config;r.update();const n=this._options=r.createResolver(r.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let u=0,c=this.data.datasets.length;u<c;u++){const{controller:h}=this.getDatasetMeta(u),f=!i&&s.indexOf(h)===-1;h.buildOrUpdateElements(f),a=Math.max(+h.getMaxOverflow(),a)}a=this._minPadding=n.layout.autoPadding?a:0,this._updateLayout(a),i||Ne(s,u=>{u.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(gm("z","_idx"));const{_active:o,_lastEvent:l}=this;l?this._eventHandler(l,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){Ne(this.scales,e=>{Pr.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,r=new Set(Object.keys(this._listeners)),n=new Set(e.events);(!Cg(r,n)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,r=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:s}of r){const a=n==="_removeElements"?-s:s;UA(e,i,a)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const r=this.data.datasets.length,n=s=>new Set(e.filter(a=>a[0]===s).map((a,o)=>o+","+a.splice(1).join(","))),i=n(0);for(let s=1;s<r;s++)if(!Cg(i,n(s)))return;return Array.from(i).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Pr.update(this,this.width,this.height,e);const r=this.chartArea,n=r.width<=0||r.height<=0;this._layers=[],Ne(this.boxes,i=>{n&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,s)=>{i._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let r=0,n=this.data.datasets.length;r<n;++r)this.getDatasetMeta(r).controller.configure();for(let r=0,n=this.data.datasets.length;r<n;++r)this._updateDataset(r,di(e)?e({datasetIndex:r}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,r){const n=this.getDatasetMeta(e),i={meta:n,index:e,mode:r,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(n.controller._update(r),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(xn.has(this)?this.attached&&!xn.running(this)&&xn.start(this):(this.draw(),mm({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:n,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const r=this._layers;for(e=0;e<r.length&&r[e].z<=0;++e)r[e].draw(this.chartArea);for(this._drawDatasets();e<r.length;++e)r[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const r=this._sortedMetasets,n=[];let i,s;for(i=0,s=r.length;i<s;++i){const a=r[i];(!e||a.visible)&&n.push(a)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let r=e.length-1;r>=0;--r)this._drawDataset(e[r]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const r=this.ctx,n={meta:e,index:e.index,cancelable:!0},i=lb(this,e);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(i&&w0(r,i),e.controller.draw(),i&&S0(r),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(e){return w_(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,r,n,i){const s=Bb.modes[r];return typeof s=="function"?s(this,e,n,i):[]}getDatasetMeta(e){const r=this.data.datasets[e],n=this._metasets;let i=n.filter(s=>s&&s._dataset===r).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:r&&r.order||0,index:e,_dataset:r,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=fa(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const r=this.data.datasets[e];if(!r)return!1;const n=this.getDatasetMeta(e);return typeof n.hidden=="boolean"?!n.hidden:!r.hidden}setDatasetVisibility(e,r){const n=this.getDatasetMeta(e);n.hidden=!r}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,r,n){const i=n?"show":"hide",s=this.getDatasetMeta(e),a=s.controller._resolveAnimations(void 0,i);No(r)?(s.data[r].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),a.update(s,{visible:n}),this.update(o=>o.datasetIndex===e?i:void 0))}hide(e,r){this._updateVisibility(e,r,!1)}show(e,r){this._updateVisibility(e,r,!0)}_destroyDatasetMeta(e){const r=this._metasets[e];r&&r.controller&&r.controller._destroy(),delete this._metasets[e]}_stop(){let e,r;for(this.stop(),xn.remove(this),e=0,r=this.data.datasets.length;e<r;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:r}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),jg(e,r),this.platform.releaseContext(r),this.canvas=null,this.ctx=null),delete vu[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,r=this.platform,n=(s,a)=>{r.addEventListener(this,s,a),e[s]=a},i=(s,a,o)=>{s.offsetX=a,s.offsetY=o,this._eventHandler(s)};Ne(this.options.events,s=>n(s,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,r=this.platform,n=(l,u)=>{r.addEventListener(this,l,u),e[l]=u},i=(l,u)=>{e[l]&&(r.removeEventListener(this,l,u),delete e[l])},s=(l,u)=>{this.canvas&&this.resize(l,u)};let a;const o=()=>{i("attach",o),this.attached=!0,this.resize(),n("resize",s),n("detach",a)};a=()=>{this.attached=!1,i("resize",s),this._stop(),this._resize(0,0),n("attach",o)},r.isAttached(this.canvas)?o():a()}unbindEvents(){Ne(this._listeners,(e,r)=>{this.platform.removeEventListener(this,r,e)}),this._listeners={},Ne(this._responsiveListeners,(e,r)=>{this.platform.removeEventListener(this,r,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,r,n){const i=n?"set":"remove";let s,a,o,l;for(r==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+i+"DatasetHoverStyle"]()),o=0,l=e.length;o<l;++o){a=e[o];const u=a&&this.getDatasetMeta(a.datasetIndex).controller;u&&u[i+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const r=this._active||[],n=e.map(({datasetIndex:s,index:a})=>{const o=this.getDatasetMeta(s);if(!o)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:o.data[a],index:a}});!Wu(n,r)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,r))}notifyPlugins(e,r,n){return this._plugins.notify(this,e,r,n)}isPluginEnabled(e){return this._plugins._cache.filter(r=>r.plugin.id===e).length===1}_updateHoverStyles(e,r,n){const i=this.options.hover,s=(l,u)=>l.filter(c=>!u.some(h=>c.datasetIndex===h.datasetIndex&&c.index===h.index)),a=s(r,e),o=n?e:s(e,r);a.length&&this.updateHoverStyle(a,i.mode,!1),o.length&&i.mode&&this.updateHoverStyle(o,i.mode,!0)}_eventHandler(e,r){const n={event:e,replay:r,cancelable:!0,inChartArea:this.isPointInArea(e)},i=a=>(a.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",n,i)===!1)return;const s=this._handleEvent(e,r,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(s||n.changed)&&this.render(),this}_handleEvent(e,r,n){const{_active:i=[],options:s}=this,a=r,o=this._getActiveElements(e,i,n,a),l=uk(e),u=$A(e,this._lastEvent,n,l);n&&(this._lastEvent=null,Ve(s.onHover,[e,o,this],this),l&&Ve(s.onClick,[e,o,this],this));const c=!Wu(o,i);return(c||r)&&(this._active=o,this._updateHoverStyles(o,i,r)),this._lastEvent=u,c}_getActiveElements(e,r,n,i){if(e.type==="mouseout")return[];if(!n)return r;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,i)}},ke($n,"defaults",at),ke($n,"instances",vu),ke($n,"overrides",es),ke($n,"registry",cn),ke($n,"version",MA),ke($n,"getChart",vm),$n);function xm(){return Ne(Nc.instances,t=>t._plugins.invalidate())}function z_(t,e){const{x:r,y:n,base:i,width:s,height:a}=t.getProps(["x","y","base","width","height"],e);let o,l,u,c,h;return t.horizontal?(h=a/2,o=Math.min(r,i),l=Math.max(r,i),u=n-h,c=n+h):(h=s/2,o=r-h,l=r+h,u=Math.min(n,i),c=Math.max(n,i)),{left:o,top:u,right:l,bottom:c}}function Jn(t,e,r,n){return t?0:qr(e,r,n)}function zA(t,e,r){const n=t.options.borderWidth,i=t.borderSkipped,s=E_(n);return{t:Jn(i.top,s.top,0,r),r:Jn(i.right,s.right,0,e),b:Jn(i.bottom,s.bottom,0,r),l:Jn(i.left,s.left,0,e)}}function WA(t,e,r){const{enableBorderRadius:n}=t.getProps(["enableBorderRadius"]),i=t.options.borderRadius,s=Vs(i),a=Math.min(e,r),o=t.borderSkipped,l=n||Ce(i);return{topLeft:Jn(!l||o.top||o.left,s.topLeft,0,a),topRight:Jn(!l||o.top||o.right,s.topRight,0,a),bottomLeft:Jn(!l||o.bottom||o.left,s.bottomLeft,0,a),bottomRight:Jn(!l||o.bottom||o.right,s.bottomRight,0,a)}}function HA(t){const e=z_(t),r=e.right-e.left,n=e.bottom-e.top,i=zA(t,r/2,n/2),s=WA(t,r/2,n/2);return{outer:{x:e.left,y:e.top,w:r,h:n,radius:s},inner:{x:e.left+i.l,y:e.top+i.t,w:r-i.l-i.r,h:n-i.t-i.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,s.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(i.b,i.r))}}}}function Dh(t,e,r,n){const i=e===null,s=r===null,o=t&&!(i&&s)&&z_(t,n);return o&&(i||Ms(e,o.left,o.right))&&(s||Ms(r,o.top,o.bottom))}function VA(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function GA(t,e){t.rect(e.x,e.y,e.w,e.h)}function Nh(t,e,r={}){const n=t.x!==r.x?-e:0,i=t.y!==r.y?-e:0,s=(t.x+t.w!==r.x+r.w?e:0)-n,a=(t.y+t.h!==r.y+r.h?e:0)-i;return{x:t.x+n,y:t.y+i,w:t.w+s,h:t.h+a,radius:t.radius}}class xu extends pi{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:r,options:{borderColor:n,backgroundColor:i}}=this,{inner:s,outer:a}=HA(this),o=VA(a.radius)?Ku:GA;e.save(),(a.w!==s.w||a.h!==s.h)&&(e.beginPath(),o(e,Nh(a,r,s)),e.clip(),o(e,Nh(s,-r,a)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),o(e,Nh(s,r)),e.fillStyle=i,e.fill(),e.restore()}inRange(e,r,n){return Dh(this,e,r,n)}inXRange(e,r){return Dh(this,e,null,r)}inYRange(e,r){return Dh(this,null,e,r)}getCenterPoint(e){const{x:r,y:n,base:i,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(r+i)/2:r,y:s?n:(n+i)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}ke(xu,"id","bar"),ke(xu,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),ke(xu,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const _m=(t,e)=>{let{boxHeight:r=e,boxWidth:n=e}=t;return t.usePointStyle&&(r=Math.min(r,e),n=t.pointStyleWidth||Math.min(n,e)),{boxWidth:n,boxHeight:r,itemHeight:Math.max(e,r)}},KA=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class ym extends pi{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,r,n){this.maxWidth=e,this.maxHeight=r,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let r=Ve(e.generateLabels,[this.chart],this)||[];e.filter&&(r=r.filter(n=>e.filter(n,this.chart.data))),e.sort&&(r=r.sort((n,i)=>e.sort(n,i,this.chart.data))),this.options.reverse&&r.reverse(),this.legendItems=r}fit(){const{options:e,ctx:r}=this;if(!e.display){this.width=this.height=0;return}const n=e.labels,i=Bt(n.font),s=i.size,a=this._computeTitleHeight(),{boxWidth:o,itemHeight:l}=_m(n,s);let u,c;r.font=i.string,this.isHorizontal()?(u=this.maxWidth,c=this._fitRows(a,s,o,l)+10):(c=this.maxHeight,u=this._fitCols(a,i,o,l)+10),this.width=Math.min(u,e.maxWidth||this.maxWidth),this.height=Math.min(c,e.maxHeight||this.maxHeight)}_fitRows(e,r,n,i){const{ctx:s,maxWidth:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],u=this.lineWidths=[0],c=i+o;let h=e;s.textAlign="left",s.textBaseline="middle";let f=-1,d=-c;return this.legendItems.forEach((g,p)=>{const m=n+r/2+s.measureText(g.text).width;(p===0||u[u.length-1]+m+2*o>a)&&(h+=c,u[u.length-(p>0?0:1)]=0,d+=c,f++),l[p]={left:0,top:d,row:f,width:m,height:i},u[u.length-1]+=m+o}),h}_fitCols(e,r,n,i){const{ctx:s,maxHeight:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],u=this.columnSizes=[],c=a-e;let h=o,f=0,d=0,g=0,p=0;return this.legendItems.forEach((m,v)=>{const{itemWidth:x,itemHeight:_}=YA(n,r,s,m,i);v>0&&d+_+2*o>c&&(h+=f+o,u.push({width:f,height:d}),g+=f+o,p++,f=d=0),l[v]={left:g,top:d,col:p,width:x,height:_},f=Math.max(f,x),d+=_+o}),h+=f,u.push({width:f,height:d}),h}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:r,options:{align:n,labels:{padding:i},rtl:s}}=this,a=Gs(s,this.left,this.width);if(this.isHorizontal()){let o=0,l=Lt(n,this.left+i,this.right-this.lineWidths[o]);for(const u of r)o!==u.row&&(o=u.row,l=Lt(n,this.left+i,this.right-this.lineWidths[o])),u.top+=this.top+e+i,u.left=a.leftForLtr(a.x(l),u.width),l+=u.width+i}else{let o=0,l=Lt(n,this.top+e+i,this.bottom-this.columnSizes[o].height);for(const u of r)u.col!==o&&(o=u.col,l=Lt(n,this.top+e+i,this.bottom-this.columnSizes[o].height)),u.top=l,u.left+=this.left+i,u.left=a.leftForLtr(a.x(u.left),u.width),l+=u.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;w0(e,this),this._draw(),S0(e)}}_draw(){const{options:e,columnSizes:r,lineWidths:n,ctx:i}=this,{align:s,labels:a}=e,o=at.color,l=Gs(e.rtl,this.left,this.width),u=Bt(a.font),{padding:c}=a,h=u.size,f=h/2;let d;this.drawTitle(),i.textAlign=l.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=u.string;const{boxWidth:g,boxHeight:p,itemHeight:m}=_m(a,h),v=function(R,T,P){if(isNaN(g)||g<=0||isNaN(p)||p<0)return;i.save();const F=Re(P.lineWidth,1);if(i.fillStyle=Re(P.fillStyle,o),i.lineCap=Re(P.lineCap,"butt"),i.lineDashOffset=Re(P.lineDashOffset,0),i.lineJoin=Re(P.lineJoin,"miter"),i.lineWidth=F,i.strokeStyle=Re(P.strokeStyle,o),i.setLineDash(Re(P.lineDash,[])),a.usePointStyle){const N={radius:p*Math.SQRT2/2,pointStyle:P.pointStyle,rotation:P.rotation,borderWidth:F},U=l.xPlus(R,g/2),H=T+f;y_(i,N,U,H,a.pointStyleWidth&&g)}else{const N=T+Math.max((h-p)/2,0),U=l.leftForLtr(R,g),H=Vs(P.borderRadius);i.beginPath(),Object.values(H).some(Z=>Z!==0)?Ku(i,{x:U,y:N,w:g,h:p,radius:H}):i.rect(U,N,g,p),i.fill(),F!==0&&i.stroke()}i.restore()},x=function(R,T,P){Lo(i,P.text,R,T+m/2,u,{strikethrough:P.hidden,textAlign:l.textAlign(P.textAlign)})},_=this.isHorizontal(),w=this._computeTitleHeight();_?d={x:Lt(s,this.left+c,this.right-n[0]),y:this.top+c+w,line:0}:d={x:this.left+c,y:Lt(s,this.top+w+c,this.bottom-r[0].height),line:0},O_(this.ctx,e.textDirection);const O=m+c;this.legendItems.forEach((R,T)=>{i.strokeStyle=R.fontColor,i.fillStyle=R.fontColor;const P=i.measureText(R.text).width,F=l.textAlign(R.textAlign||(R.textAlign=a.textAlign)),N=g+f+P;let U=d.x,H=d.y;l.setWidth(this.width),_?T>0&&U+N+c>this.right&&(H=d.y+=O,d.line++,U=d.x=Lt(s,this.left+c,this.right-n[d.line])):T>0&&H+O>this.bottom&&(U=d.x=U+r[d.line].width+c,d.line++,H=d.y=Lt(s,this.top+w+c,this.bottom-r[d.line].height));const Z=l.x(U);if(v(Z,H,R),U=Tk(F,U+g+f,_?U+N:this.right,e.rtl),x(l.x(U),H,R),_)d.x+=N+c;else if(typeof R.text!="string"){const ve=u.lineHeight;d.y+=W_(R,ve)+c}else d.y+=O}),C_(this.ctx,e.textDirection)}drawTitle(){const e=this.options,r=e.title,n=Bt(r.font),i=Nr(r.padding);if(!r.display)return;const s=Gs(e.rtl,this.left,this.width),a=this.ctx,o=r.position,l=n.size/2,u=i.top+l;let c,h=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),c=this.top+u,h=Lt(e.align,h,this.right-f);else{const g=this.columnSizes.reduce((p,m)=>Math.max(p,m.height),0);c=u+Lt(e.align,this.top,this.bottom-g-e.labels.padding-this._computeTitleHeight())}const d=Lt(o,h,h+f);a.textAlign=s.textAlign(y0(o)),a.textBaseline="middle",a.strokeStyle=r.color,a.fillStyle=r.color,a.font=n.string,Lo(a,r.text,d,c,n)}_computeTitleHeight(){const e=this.options.title,r=Bt(e.font),n=Nr(e.padding);return e.display?r.lineHeight+n.height:0}_getLegendItemAt(e,r){let n,i,s;if(Ms(e,this.left,this.right)&&Ms(r,this.top,this.bottom)){for(s=this.legendHitBoxes,n=0;n<s.length;++n)if(i=s[n],Ms(e,i.left,i.left+i.width)&&Ms(r,i.top,i.top+i.height))return this.legendItems[n]}return null}handleEvent(e){const r=this.options;if(!JA(e.type,r))return;const n=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const i=this._hoveredItem,s=KA(i,n);i&&!s&&Ve(r.onLeave,[e,i,this],this),this._hoveredItem=n,n&&!s&&Ve(r.onHover,[e,n,this],this)}else n&&Ve(r.onClick,[e,n,this],this)}}function YA(t,e,r,n,i){const s=XA(n,t,e,r),a=qA(i,n,e.lineHeight);return{itemWidth:s,itemHeight:a}}function XA(t,e,r,n){let i=t.text;return i&&typeof i!="string"&&(i=i.reduce((s,a)=>s.length>a.length?s:a)),e+r.size/2+n.measureText(i).width}function qA(t,e,r){let n=t;return typeof e.text!="string"&&(n=W_(e,r)),n}function W_(t,e){const r=t.text?t.text.length:0;return e*r}function JA(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var QA={id:"legend",_element:ym,start(t,e,r){const n=t.legend=new ym({ctx:t.ctx,options:r,chart:t});Pr.configure(t,n,r),Pr.addBox(t,n)},stop(t){Pr.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,r){const n=t.legend;Pr.configure(t,n,r),n.options=r},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,r){const n=e.datasetIndex,i=r.chart;i.isDatasetVisible(n)?(i.hide(n),e.hidden=!0):(i.show(n),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:r,pointStyle:n,textAlign:i,color:s,useBorderRadius:a,borderRadius:o}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const u=l.controller.getStyle(r?0:void 0),c=Nr(u.borderWidth);return{text:e[l.index].label,fillStyle:u.backgroundColor,fontColor:s,hidden:!l.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:u.borderColor,pointStyle:n||u.pointStyle,rotation:u.rotation,textAlign:i||u.textAlign,borderRadius:a&&(o||u.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class H_ extends pi{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,r){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=r;const i=gt(n.text)?n.text.length:1;this._padding=Nr(n.padding);const s=i*Bt(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:r,left:n,bottom:i,right:s,options:a}=this,o=a.align;let l=0,u,c,h;return this.isHorizontal()?(c=Lt(o,n,s),h=r+e,u=s-n):(a.position==="left"?(c=n+e,h=Lt(o,i,r),l=jt*-.5):(c=s-e,h=Lt(o,r,i),l=jt*.5),u=i-r),{titleX:c,titleY:h,maxWidth:u,rotation:l}}draw(){const e=this.ctx,r=this.options;if(!r.display)return;const n=Bt(r.font),s=n.lineHeight/2+this._padding.top,{titleX:a,titleY:o,maxWidth:l,rotation:u}=this._drawArgs(s);Lo(e,r.text,0,0,n,{color:r.color,maxWidth:l,rotation:u,textAlign:y0(r.align),textBaseline:"middle",translation:[a,o]})}}function ZA(t,e){const r=new H_({ctx:t.ctx,options:e,chart:t});Pr.configure(t,r,e),Pr.addBox(t,r),t.titleBlock=r}var eO={id:"title",_element:H_,start(t,e,r){ZA(t,r)},stop(t){const e=t.titleBlock;Pr.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,r){const n=t.titleBlock;Pr.configure(t,n,r),n.options=r},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Ha={average(t){if(!t.length)return!1;let e,r,n=new Set,i=0,s=0;for(e=0,r=t.length;e<r;++e){const o=t[e].element;if(o&&o.hasValue()){const l=o.tooltipPosition();n.add(l.x),i+=l.y,++s}}return s===0||n.size===0?!1:{x:[...n].reduce((o,l)=>o+l)/n.size,y:i/s}},nearest(t,e){if(!t.length)return!1;let r=e.x,n=e.y,i=Number.POSITIVE_INFINITY,s,a,o;for(s=0,a=t.length;s<a;++s){const l=t[s].element;if(l&&l.hasValue()){const u=l.getCenterPoint(),c=vk(e,u);c<i&&(i=c,o=l)}}if(o){const l=o.tooltipPosition();r=l.x,n=l.y}return{x:r,y:n}}};function an(t,e){return e&&(gt(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function _n(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function tO(t,e){const{element:r,datasetIndex:n,index:i}=e,s=t.getDatasetMeta(n).controller,{label:a,value:o}=s.getLabelAndValue(i);return{chart:t,label:a,parsed:s.getParsed(i),raw:t.data.datasets[n].data[i],formattedValue:o,dataset:s.getDataset(),dataIndex:i,datasetIndex:n,element:r}}function wm(t,e){const r=t.chart.ctx,{body:n,footer:i,title:s}=t,{boxWidth:a,boxHeight:o}=e,l=Bt(e.bodyFont),u=Bt(e.titleFont),c=Bt(e.footerFont),h=s.length,f=i.length,d=n.length,g=Nr(e.padding);let p=g.height,m=0,v=n.reduce((w,O)=>w+O.before.length+O.lines.length+O.after.length,0);if(v+=t.beforeBody.length+t.afterBody.length,h&&(p+=h*u.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),v){const w=e.displayColors?Math.max(o,l.lineHeight):l.lineHeight;p+=d*w+(v-d)*l.lineHeight+(v-1)*e.bodySpacing}f&&(p+=e.footerMarginTop+f*c.lineHeight+(f-1)*e.footerSpacing);let x=0;const _=function(w){m=Math.max(m,r.measureText(w).width+x)};return r.save(),r.font=u.string,Ne(t.title,_),r.font=l.string,Ne(t.beforeBody.concat(t.afterBody),_),x=e.displayColors?a+2+e.boxPadding:0,Ne(n,w=>{Ne(w.before,_),Ne(w.lines,_),Ne(w.after,_)}),x=0,r.font=c.string,Ne(t.footer,_),r.restore(),m+=g.width,{width:m,height:p}}function rO(t,e){const{y:r,height:n}=e;return r<n/2?"top":r>t.height-n/2?"bottom":"center"}function nO(t,e,r,n){const{x:i,width:s}=n,a=r.caretSize+r.caretPadding;if(t==="left"&&i+s+a>e.width||t==="right"&&i-s-a<0)return!0}function iO(t,e,r,n){const{x:i,width:s}=r,{width:a,chartArea:{left:o,right:l}}=t;let u="center";return n==="center"?u=i<=(o+l)/2?"left":"right":i<=s/2?u="left":i>=a-s/2&&(u="right"),nO(u,t,e,r)&&(u="center"),u}function Sm(t,e,r){const n=r.yAlign||e.yAlign||rO(t,r);return{xAlign:r.xAlign||e.xAlign||iO(t,e,r,n),yAlign:n}}function sO(t,e){let{x:r,width:n}=t;return e==="right"?r-=n:e==="center"&&(r-=n/2),r}function aO(t,e,r){let{y:n,height:i}=t;return e==="top"?n+=r:e==="bottom"?n-=i+r:n-=i/2,n}function Em(t,e,r,n){const{caretSize:i,caretPadding:s,cornerRadius:a}=t,{xAlign:o,yAlign:l}=r,u=i+s,{topLeft:c,topRight:h,bottomLeft:f,bottomRight:d}=Vs(a);let g=sO(e,o);const p=aO(e,l,u);return l==="center"?o==="left"?g+=u:o==="right"&&(g-=u):o==="left"?g-=Math.max(c,f)+i:o==="right"&&(g+=Math.max(h,d)+i),{x:qr(g,0,n.width-e.width),y:qr(p,0,n.height-e.height)}}function Ll(t,e,r){const n=Nr(r.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-n.right:t.x+n.left}function Tm(t){return an([],_n(t))}function oO(t,e,r){return fa(t,{tooltip:e,tooltipItems:r,type:"tooltip"})}function km(t,e){const r=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return r?t.override(r):t}const V_={beforeTitle:vn,title(t){if(t.length>0){const e=t[0],r=e.chart.data.labels,n=r?r.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(n>0&&e.dataIndex<n)return r[e.dataIndex]}return""},afterTitle:vn,beforeBody:vn,beforeLabel:vn,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const r=t.formattedValue;return $e(r)||(e+=r),e},labelColor(t){const r=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:r.borderColor,backgroundColor:r.backgroundColor,borderWidth:r.borderWidth,borderDash:r.borderDash,borderDashOffset:r.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const r=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:r.pointStyle,rotation:r.rotation}},afterLabel:vn,afterBody:vn,beforeFooter:vn,footer:vn,afterFooter:vn};function Jt(t,e,r,n){const i=t[e].call(r,n);return typeof i>"u"?V_[e].call(r,n):i}class ed extends pi{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const r=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&r.options.animation&&n.animations,s=new P_(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=oO(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,r){const{callbacks:n}=r,i=Jt(n,"beforeTitle",this,e),s=Jt(n,"title",this,e),a=Jt(n,"afterTitle",this,e);let o=[];return o=an(o,_n(i)),o=an(o,_n(s)),o=an(o,_n(a)),o}getBeforeBody(e,r){return Tm(Jt(r.callbacks,"beforeBody",this,e))}getBody(e,r){const{callbacks:n}=r,i=[];return Ne(e,s=>{const a={before:[],lines:[],after:[]},o=km(n,s);an(a.before,_n(Jt(o,"beforeLabel",this,s))),an(a.lines,Jt(o,"label",this,s)),an(a.after,_n(Jt(o,"afterLabel",this,s))),i.push(a)}),i}getAfterBody(e,r){return Tm(Jt(r.callbacks,"afterBody",this,e))}getFooter(e,r){const{callbacks:n}=r,i=Jt(n,"beforeFooter",this,e),s=Jt(n,"footer",this,e),a=Jt(n,"afterFooter",this,e);let o=[];return o=an(o,_n(i)),o=an(o,_n(s)),o=an(o,_n(a)),o}_createItems(e){const r=this._active,n=this.chart.data,i=[],s=[],a=[];let o=[],l,u;for(l=0,u=r.length;l<u;++l)o.push(tO(this.chart,r[l]));return e.filter&&(o=o.filter((c,h,f)=>e.filter(c,h,f,n))),e.itemSort&&(o=o.sort((c,h)=>e.itemSort(c,h,n))),Ne(o,c=>{const h=km(e.callbacks,c);i.push(Jt(h,"labelColor",this,c)),s.push(Jt(h,"labelPointStyle",this,c)),a.push(Jt(h,"labelTextColor",this,c))}),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=a,this.dataPoints=o,o}update(e,r){const n=this.options.setContext(this.getContext()),i=this._active;let s,a=[];if(!i.length)this.opacity!==0&&(s={opacity:0});else{const o=Ha[n.position].call(this,i,this._eventPosition);a=this._createItems(n),this.title=this.getTitle(a,n),this.beforeBody=this.getBeforeBody(a,n),this.body=this.getBody(a,n),this.afterBody=this.getAfterBody(a,n),this.footer=this.getFooter(a,n);const l=this._size=wm(this,n),u=Object.assign({},o,l),c=Sm(this.chart,n,u),h=Em(n,u,c,this.chart);this.xAlign=c.xAlign,this.yAlign=c.yAlign,s={opacity:1,x:h.x,y:h.y,width:l.width,height:l.height,caretX:o.x,caretY:o.y}}this._tooltipItems=a,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:r})}drawCaret(e,r,n,i){const s=this.getCaretPosition(e,n,i);r.lineTo(s.x1,s.y1),r.lineTo(s.x2,s.y2),r.lineTo(s.x3,s.y3)}getCaretPosition(e,r,n){const{xAlign:i,yAlign:s}=this,{caretSize:a,cornerRadius:o}=n,{topLeft:l,topRight:u,bottomLeft:c,bottomRight:h}=Vs(o),{x:f,y:d}=e,{width:g,height:p}=r;let m,v,x,_,w,O;return s==="center"?(w=d+p/2,i==="left"?(m=f,v=m-a,_=w+a,O=w-a):(m=f+g,v=m+a,_=w-a,O=w+a),x=m):(i==="left"?v=f+Math.max(l,c)+a:i==="right"?v=f+g-Math.max(u,h)-a:v=this.caretX,s==="top"?(_=d,w=_-a,m=v-a,x=v+a):(_=d+p,w=_+a,m=v+a,x=v-a),O=_),{x1:m,x2:v,x3:x,y1:_,y2:w,y3:O}}drawTitle(e,r,n){const i=this.title,s=i.length;let a,o,l;if(s){const u=Gs(n.rtl,this.x,this.width);for(e.x=Ll(this,n.titleAlign,n),r.textAlign=u.textAlign(n.titleAlign),r.textBaseline="middle",a=Bt(n.titleFont),o=n.titleSpacing,r.fillStyle=n.titleColor,r.font=a.string,l=0;l<s;++l)r.fillText(i[l],u.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+o,l+1===s&&(e.y+=n.titleMarginBottom-o)}}_drawColorBox(e,r,n,i,s){const a=this.labelColors[n],o=this.labelPointStyles[n],{boxHeight:l,boxWidth:u}=s,c=Bt(s.bodyFont),h=Ll(this,"left",s),f=i.x(h),d=l<c.lineHeight?(c.lineHeight-l)/2:0,g=r.y+d;if(s.usePointStyle){const p={radius:Math.min(u,l)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},m=i.leftForLtr(f,u)+u/2,v=g+l/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,Ug(e,p,m,v),e.strokeStyle=a.borderColor,e.fillStyle=a.backgroundColor,Ug(e,p,m,v)}else{e.lineWidth=Ce(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,e.strokeStyle=a.borderColor,e.setLineDash(a.borderDash||[]),e.lineDashOffset=a.borderDashOffset||0;const p=i.leftForLtr(f,u),m=i.leftForLtr(i.xPlus(f,1),u-2),v=Vs(a.borderRadius);Object.values(v).some(x=>x!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,Ku(e,{x:p,y:g,w:u,h:l,radius:v}),e.fill(),e.stroke(),e.fillStyle=a.backgroundColor,e.beginPath(),Ku(e,{x:m,y:g+1,w:u-2,h:l-2,radius:v}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(p,g,u,l),e.strokeRect(p,g,u,l),e.fillStyle=a.backgroundColor,e.fillRect(m,g+1,u-2,l-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,r,n){const{body:i}=this,{bodySpacing:s,bodyAlign:a,displayColors:o,boxHeight:l,boxWidth:u,boxPadding:c}=n,h=Bt(n.bodyFont);let f=h.lineHeight,d=0;const g=Gs(n.rtl,this.x,this.width),p=function(P){r.fillText(P,g.x(e.x+d),e.y+f/2),e.y+=f+s},m=g.textAlign(a);let v,x,_,w,O,R,T;for(r.textAlign=a,r.textBaseline="middle",r.font=h.string,e.x=Ll(this,m,n),r.fillStyle=n.bodyColor,Ne(this.beforeBody,p),d=o&&m!=="right"?a==="center"?u/2+c:u+2+c:0,w=0,R=i.length;w<R;++w){for(v=i[w],x=this.labelTextColors[w],r.fillStyle=x,Ne(v.before,p),_=v.lines,o&&_.length&&(this._drawColorBox(r,e,w,g,n),f=Math.max(h.lineHeight,l)),O=0,T=_.length;O<T;++O)p(_[O]),f=h.lineHeight;Ne(v.after,p)}d=0,f=h.lineHeight,Ne(this.afterBody,p),e.y-=s}drawFooter(e,r,n){const i=this.footer,s=i.length;let a,o;if(s){const l=Gs(n.rtl,this.x,this.width);for(e.x=Ll(this,n.footerAlign,n),e.y+=n.footerMarginTop,r.textAlign=l.textAlign(n.footerAlign),r.textBaseline="middle",a=Bt(n.footerFont),r.fillStyle=n.footerColor,r.font=a.string,o=0;o<s;++o)r.fillText(i[o],l.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+n.footerSpacing}}drawBackground(e,r,n,i){const{xAlign:s,yAlign:a}=this,{x:o,y:l}=e,{width:u,height:c}=n,{topLeft:h,topRight:f,bottomLeft:d,bottomRight:g}=Vs(i.cornerRadius);r.fillStyle=i.backgroundColor,r.strokeStyle=i.borderColor,r.lineWidth=i.borderWidth,r.beginPath(),r.moveTo(o+h,l),a==="top"&&this.drawCaret(e,r,n,i),r.lineTo(o+u-f,l),r.quadraticCurveTo(o+u,l,o+u,l+f),a==="center"&&s==="right"&&this.drawCaret(e,r,n,i),r.lineTo(o+u,l+c-g),r.quadraticCurveTo(o+u,l+c,o+u-g,l+c),a==="bottom"&&this.drawCaret(e,r,n,i),r.lineTo(o+d,l+c),r.quadraticCurveTo(o,l+c,o,l+c-d),a==="center"&&s==="left"&&this.drawCaret(e,r,n,i),r.lineTo(o,l+h),r.quadraticCurveTo(o,l,o+h,l),r.closePath(),r.fill(),i.borderWidth>0&&r.stroke()}_updateAnimationTarget(e){const r=this.chart,n=this.$animations,i=n&&n.x,s=n&&n.y;if(i||s){const a=Ha[e.position].call(this,this._active,this._eventPosition);if(!a)return;const o=this._size=wm(this,e),l=Object.assign({},a,this._size),u=Sm(r,e,l),c=Em(e,l,u,r);(i._to!==c.x||s._to!==c.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=o.width,this.height=o.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,c))}}_willRender(){return!!this.opacity}draw(e){const r=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(r);const i={width:this.width,height:this.height},s={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const a=Nr(r.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;r.enabled&&o&&(e.save(),e.globalAlpha=n,this.drawBackground(s,e,i,r),O_(e,r.textDirection),s.y+=a.top,this.drawTitle(s,e,r),this.drawBody(s,e,r),this.drawFooter(s,e,r),C_(e,r.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,r){const n=this._active,i=e.map(({datasetIndex:o,index:l})=>{const u=this.chart.getDatasetMeta(o);if(!u)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:u.data[l],index:l}}),s=!Wu(n,i),a=this._positionChanged(i,r);(s||a)&&(this._active=i,this._eventPosition=r,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,r,n=!0){if(r&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,s=this._active||[],a=this._getActiveElements(e,s,r,n),o=this._positionChanged(a,e),l=r||!Wu(a,s)||o;return l&&(this._active=a,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,r))),l}_getActiveElements(e,r,n,i){const s=this.options;if(e.type==="mouseout")return[];if(!i)return r.filter(o=>this.chart.data.datasets[o.datasetIndex]&&this.chart.getDatasetMeta(o.datasetIndex).controller.getParsed(o.index)!==void 0);const a=this.chart.getElementsAtEventForMode(e,s.mode,s,n);return s.reverse&&a.reverse(),a}_positionChanged(e,r){const{caretX:n,caretY:i,options:s}=this,a=Ha[s.position].call(this,e,r);return a!==!1&&(n!==a.x||i!==a.y)}}ke(ed,"positioners",Ha);var lO={id:"tooltip",_element:ed,positioners:Ha,afterInit(t,e,r){r&&(t.tooltip=new ed({chart:t,options:r}))},beforeUpdate(t,e,r){t.tooltip&&t.tooltip.initialize(r)},reset(t,e,r){t.tooltip&&t.tooltip.initialize(r)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const r={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...r,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",r)}},afterEvent(t,e){if(t.tooltip){const r=e.replay;t.tooltip.handleEvent(e.event,r,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:V_},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const uO=(t,e,r,n)=>(typeof e=="string"?(r=t.push(e)-1,n.unshift({index:r,label:e})):isNaN(e)&&(r=null),r);function cO(t,e,r,n){const i=t.indexOf(e);if(i===-1)return uO(t,e,r,n);const s=t.lastIndexOf(e);return i!==s?r:i}const hO=(t,e)=>t===null?null:qr(Math.round(t),0,e);function bm(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class td extends da{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const r=this._addedLabels;if(r.length){const n=this.getLabels();for(const{index:i,label:s}of r)n[i]===s&&n.splice(i,1);this._addedLabels=[]}super.init(e)}parse(e,r){if($e(e))return null;const n=this.getLabels();return r=isFinite(r)&&n[r]===e?r:cO(n,e,Re(r,e),this._addedLabels),hO(r,n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:r}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(n=0),r||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const e=this.min,r=this.max,n=this.options.offset,i=[];let s=this.getLabels();s=e===0&&r===s.length-1?s:s.slice(e,r+1),this._valueRange=Math.max(s.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let a=e;a<=r;a++)i.push({value:a});return i}getLabelForValue(e){return bm.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const r=this.ticks;return e<0||e>r.length-1?null:this.getPixelForValue(r[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}ke(td,"id","category"),ke(td,"defaults",{ticks:{callback:bm}});function fO(t,e){const r=[],{bounds:i,step:s,min:a,max:o,precision:l,count:u,maxTicks:c,maxDigits:h,includeBounds:f}=t,d=s||1,g=c-1,{min:p,max:m}=e,v=!$e(a),x=!$e(o),_=!$e(u),w=(m-p)/(h+1);let O=Rg((m-p)/g/d)*d,R,T,P,F;if(O<1e-14&&!v&&!x)return[{value:p},{value:m}];F=Math.ceil(m/O)-Math.floor(p/O),F>g&&(O=Rg(F*O/g/d)*d),$e(l)||(R=Math.pow(10,l),O=Math.ceil(O*R)/R),i==="ticks"?(T=Math.floor(p/O)*O,P=Math.ceil(m/O)*O):(T=p,P=m),v&&x&&s&&dk((o-a)/s,O/1e3)?(F=Math.round(Math.min((o-a)/O,c)),O=(o-a)/F,T=a,P=o):_?(T=v?a:T,P=x?o:P,F=u-1,O=(P-T)/F):(F=(P-T)/O,pu(F,Math.round(F),O/1e3)?F=Math.round(F):F=Math.ceil(F));const N=Math.max(Fg(O),Fg(T));R=Math.pow(10,$e(l)?N:l),T=Math.round(T*R)/R,P=Math.round(P*R)/R;let U=0;for(v&&(f&&T!==a?(r.push({value:a}),T<a&&U++,pu(Math.round((T+U*O)*R)/R,a,Am(a,w,t))&&U++):T<a&&U++);U<F;++U){const H=Math.round((T+U*O)*R)/R;if(x&&H>o)break;r.push({value:H})}return x&&f&&P!==o?r.length&&pu(r[r.length-1].value,o,Am(o,w,t))?r[r.length-1].value=o:r.push({value:o}):(!x||P===o)&&r.push({value:P}),r}function Am(t,e,{horizontal:r,minRotation:n}){const i=Wi(n),s=(r?Math.sin(i):Math.cos(i))||.001,a=.75*e*(""+t).length;return Math.min(e/s,a)}class dO extends da{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,r){return $e(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:r,maxDefined:n}=this.getUserBounds();let{min:i,max:s}=this;const a=l=>i=r?i:l,o=l=>s=n?s:l;if(e){const l=ci(i),u=ci(s);l<0&&u<0?o(0):l>0&&u>0&&a(0)}if(i===s){let l=s===0?1:Math.abs(s*.05);o(s+l),e||a(i-l)}this.min=i,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:r,stepSize:n}=e,i;return n?(i=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),r=r||11),r&&(i=Math.min(r,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,r=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const i={maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:r.precision,step:r.stepSize,count:r.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:r.minRotation||0,includeBounds:r.includeBounds!==!1},s=this._range||this,a=fO(i,s);return e.bounds==="ticks"&&pk(a,this,"value"),e.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const e=this.ticks;let r=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const i=(n-r)/Math.max(e.length-1,1)/2;r-=i,n+=i}this._startValue=r,this._endValue=n,this._valueRange=n-r}getLabelForValue(e){return x_(e,this.chart.options.locale,this.options.ticks.format)}}class rd extends dO{determineDataLimits(){const{min:e,max:r}=this.getMinMax(!0);this.min=Dr(e)?e:0,this.max=Dr(r)?r:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),r=e?this.width:this.height,n=Wi(this.options.ticks.minRotation),i=(e?Math.sin(n):Math.cos(n))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(r/Math.min(40,s.lineHeight/i))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}ke(rd,"id","linear"),ke(rd,"defaults",{ticks:{callback:__.formatters.numeric}});const Lc={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Zt=Object.keys(Lc);function Om(t,e){return t-e}function Cm(t,e){if($e(e))return null;const r=t._adapter,{parser:n,round:i,isoWeekday:s}=t._parseOpts;let a=e;return typeof n=="function"&&(a=n(a)),Dr(a)||(a=typeof n=="string"?r.parse(a,n):r.parse(a)),a===null?null:(i&&(a=i==="week"&&(Gu(s)||s===!0)?r.startOf(a,"isoWeek",s):r.startOf(a,i)),+a)}function Pm(t,e,r,n){const i=Zt.length;for(let s=Zt.indexOf(t);s<i-1;++s){const a=Lc[Zt[s]],o=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((r-e)/(o*a.size))<=n)return Zt[s]}return Zt[i-1]}function pO(t,e,r,n,i){for(let s=Zt.length-1;s>=Zt.indexOf(r);s--){const a=Zt[s];if(Lc[a].common&&t._adapter.diff(i,n,a)>=e-1)return a}return Zt[r?Zt.indexOf(r):0]}function gO(t){for(let e=Zt.indexOf(t)+1,r=Zt.length;e<r;++e)if(Lc[Zt[e]].common)return Zt[e]}function Rm(t,e,r){if(!r)t[e]=!0;else if(r.length){const{lo:n,hi:i}=_0(r,e),s=r[n]>=e?r[n]:r[i];t[s]=!0}}function mO(t,e,r,n){const i=t._adapter,s=+i.startOf(e[0].value,n),a=e[e.length-1].value;let o,l;for(o=s;o<=a;o=+i.add(o,1,n))l=r[o],l>=0&&(e[l].major=!0);return e}function Fm(t,e,r){const n=[],i={},s=e.length;let a,o;for(a=0;a<s;++a)o=e[a],i[o]=a,n.push({value:o,major:!1});return s===0||!r?n:mO(t,n,i,r)}class qu extends da{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,r={}){const n=e.time||(e.time={}),i=this._adapter=new Ib._date(e.adapters.date);i.init(r),no(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=r.normalized}parse(e,r){return e===void 0?null:Cm(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,r=this._adapter,n=e.time.unit||"day";let{min:i,max:s,minDefined:a,maxDefined:o}=this.getUserBounds();function l(u){!a&&!isNaN(u.min)&&(i=Math.min(i,u.min)),!o&&!isNaN(u.max)&&(s=Math.max(s,u.max))}(!a||!o)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),i=Dr(i)&&!isNaN(i)?i:+r.startOf(Date.now(),n),s=Dr(s)&&!isNaN(s)?s:+r.endOf(Date.now(),n)+1,this.min=Math.min(i,s-1),this.max=Math.max(i+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let r=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(r=e[0],n=e[e.length-1]),{min:r,max:n}}buildTicks(){const e=this.options,r=e.time,n=e.ticks,i=n.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const s=this.min,a=this.max,o=wk(i,s,a);return this._unit=r.unit||(n.autoSkip?Pm(r.minUnit,this.min,this.max,this._getLabelCapacity(s)):pO(this,o.length,r.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:gO(this._unit),this.initOffsets(i),e.reverse&&o.reverse(),Fm(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let r=0,n=0,i,s;this.options.offset&&e.length&&(i=this.getDecimalForValue(e[0]),e.length===1?r=1-i:r=(this.getDecimalForValue(e[1])-i)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?n=s:n=(s-this.getDecimalForValue(e[e.length-2]))/2);const a=e.length<3?.5:.25;r=qr(r,0,a),n=qr(n,0,a),this._offsets={start:r,end:n,factor:1/(r+1+n)}}_generate(){const e=this._adapter,r=this.min,n=this.max,i=this.options,s=i.time,a=s.unit||Pm(s.minUnit,r,n,this._getLabelCapacity(r)),o=Re(i.ticks.stepSize,1),l=a==="week"?s.isoWeekday:!1,u=Gu(l)||l===!0,c={};let h=r,f,d;if(u&&(h=+e.startOf(h,"isoWeek",l)),h=+e.startOf(h,u?"day":a),e.diff(n,r,a)>1e5*o)throw new Error(r+" and "+n+" are too far apart with stepSize of "+o+" "+a);const g=i.ticks.source==="data"&&this.getDataTimestamps();for(f=h,d=0;f<n;f=+e.add(f,o,a),d++)Rm(c,f,g);return(f===n||i.bounds==="ticks"||d===1)&&Rm(c,f,g),Object.keys(c).sort(Om).map(p=>+p)}getLabelForValue(e){const r=this._adapter,n=this.options.time;return n.tooltipFormat?r.format(e,n.tooltipFormat):r.format(e,n.displayFormats.datetime)}format(e,r){const i=this.options.time.displayFormats,s=this._unit,a=r||i[s];return this._adapter.format(e,a)}_tickFormatFunction(e,r,n,i){const s=this.options,a=s.ticks.callback;if(a)return Ve(a,[e,r,n],this);const o=s.time.displayFormats,l=this._unit,u=this._majorUnit,c=l&&o[l],h=u&&o[u],f=n[r],d=u&&h&&f&&f.major;return this._adapter.format(e,i||(d?h:c))}generateTickLabels(e){let r,n,i;for(r=0,n=e.length;r<n;++r)i=e[r],i.label=this._tickFormatFunction(i.value,r,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const r=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((r.start+n)*r.factor)}getValueForPixel(e){const r=this._offsets,n=this.getDecimalForPixel(e)/r.factor-r.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const r=this.options.ticks,n=this.ctx.measureText(e).width,i=Wi(this.isHorizontal()?r.maxRotation:r.minRotation),s=Math.cos(i),a=Math.sin(i),o=this._resolveTickFontOptions(0).size;return{w:n*s+o*a,h:n*a+o*s}}_getLabelCapacity(e){const r=this.options.time,n=r.displayFormats,i=n[r.unit]||n.millisecond,s=this._tickFormatFunction(e,0,Fm(this,[e],this._majorUnit),i),a=this._getLabelSize(s),o=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return o>0?o:1}getDataTimestamps(){let e=this._cache.data||[],r,n;if(e.length)return e;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(r=0,n=i.length;r<n;++r)e=e.concat(i[r].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let r,n;if(e.length)return e;const i=this.getLabels();for(r=0,n=i.length;r<n;++r)e.push(Cm(this,i[r]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return p_(e.sort(Om))}}ke(qu,"id","time"),ke(qu,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Ml(t,e,r){let n=0,i=t.length-1,s,a,o,l;r?(e>=t[n].pos&&e<=t[i].pos&&({lo:n,hi:i}=qf(t,"pos",e)),{pos:s,time:o}=t[n],{pos:a,time:l}=t[i]):(e>=t[n].time&&e<=t[i].time&&({lo:n,hi:i}=qf(t,"time",e)),{time:s,pos:o}=t[n],{time:a,pos:l}=t[i]);const u=a-s;return u?o+(l-o)*(e-s)/u:o}class Im extends qu{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),r=this._table=this.buildLookupTable(e);this._minPos=Ml(r,this.min),this._tableRange=Ml(r,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:r,max:n}=this,i=[],s=[];let a,o,l,u,c;for(a=0,o=e.length;a<o;++a)u=e[a],u>=r&&u<=n&&i.push(u);if(i.length<2)return[{time:r,pos:0},{time:n,pos:1}];for(a=0,o=i.length;a<o;++a)c=i[a+1],l=i[a-1],u=i[a],Math.round((c+l)/2)!==u&&s.push({time:u,pos:a/(o-1)});return s}_generate(){const e=this.min,r=this.max;let n=super.getDataTimestamps();return(!n.includes(e)||!n.length)&&n.splice(0,0,e),(!n.includes(r)||n.length===1)&&n.push(r),n.sort((i,s)=>i-s)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const r=this.getDataTimestamps(),n=this.getLabelTimestamps();return r.length&&n.length?e=this.normalize(r.concat(n)):e=r.length?r:n,e=this._cache.all=e,e}getDecimalForValue(e){return(Ml(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const r=this._offsets,n=this.getDecimalForPixel(e)/r.factor-r.end;return Ml(this._table,n*this._tableRange+this._minPos,!0)}}ke(Im,"id","timeseries"),ke(Im,"defaults",qu.defaults);const G_="label";function Dm(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function vO(t,e){const r=t.options;r&&e&&Object.assign(r,e)}function K_(t,e){t.labels=e}function Y_(t,e,r=G_){const n=[];t.datasets=e.map(i=>{const s=t.datasets.find(a=>a[r]===i[r]);return!s||!i.data||n.includes(s)?{...i}:(n.push(s),Object.assign(s,i),s)})}function xO(t,e=G_){const r={labels:[],datasets:[]};return K_(r,t.labels),Y_(r,t.datasets,e),r}function _O(t,e){const{height:r=150,width:n=300,redraw:i=!1,datasetIdKey:s,type:a,data:o,options:l,plugins:u=[],fallbackContent:c,updateMode:h,...f}=t,d=lr.useRef(null),g=lr.useRef(null),p=()=>{d.current&&(g.current=new Nc(d.current,{type:a,data:xO(o,s),options:l&&{...l},plugins:u}),Dm(e,g.current))},m=()=>{Dm(e,null),g.current&&(g.current.destroy(),g.current=null)};return lr.useEffect(()=>{!i&&g.current&&l&&vO(g.current,l)},[i,l]),lr.useEffect(()=>{!i&&g.current&&K_(g.current.config.data,o.labels)},[i,o.labels]),lr.useEffect(()=>{!i&&g.current&&o.datasets&&Y_(g.current.config.data,o.datasets,s)},[i,o.datasets]),lr.useEffect(()=>{g.current&&(i?(m(),setTimeout(p)):g.current.update(h))},[i,l,o.labels,o.datasets,h]),lr.useEffect(()=>{g.current&&(m(),setTimeout(p))},[a]),lr.useEffect(()=>(p(),()=>m()),[]),z.jsx("canvas",{ref:d,role:"img",height:r,width:n,...f,children:c})}const yO=lr.forwardRef(_O);function wO(t,e){return Nc.register(e),lr.forwardRef((r,n)=>z.jsx(yO,{...r,ref:n,type:t}))}const SO=wO("bar",gu);Nc.register(td,rd,xu,eO,lO,QA);const EO=({students:t,subjects:e,ratings:r,year:n,term:i})=>{const{counts:s,filtered:a}=Ue.useMemo(()=>PT(r,{year:n,term:i}),[r,n,i]),o=Ue.useMemo(()=>RT(r,e,{year:n,term:i}),[r,e,n,i]),l=Ue.useMemo(()=>FT(t,e,r),[t,e,r]),u=a.length>0,c=Ue.useMemo(()=>({labels:Kr,datasets:[{label:`${ro[i]} ${n}`,data:Kr.map(f=>s[f]??0),backgroundColor:["#22c55e","#f97316","#ef4444"],borderRadius:6}]}),[s,i,n]),h=Ue.useMemo(()=>({responsive:!0,plugins:{legend:{display:!1},title:{display:!0,text:`Distribution for ${ro[i]} ${n}`}},scales:{y:{ticks:{precision:0},beginAtZero:!0}}}),[i,n]);return z.jsxs("section",{className:"panel","aria-labelledby":"dashboard-heading",children:[z.jsx("header",{className:"panel__header",children:z.jsxs("div",{children:[z.jsx("h2",{id:"dashboard-heading",children:"Dashboard"}),z.jsx("p",{className:"panel__subtitle",children:"Quick view of coverage, level distribution, and subject summaries."})]})}),z.jsxs("div",{className:"kpi-grid",children:[z.jsxs("article",{className:"kpi-card",children:[z.jsx("span",{children:"Students"}),z.jsx("strong",{children:l.students})]}),z.jsxs("article",{className:"kpi-card",children:[z.jsx("span",{children:"Subjects"}),z.jsx("strong",{children:l.subjects})]}),z.jsxs("article",{className:"kpi-card",children:[z.jsx("span",{children:"Stored ratings"}),z.jsx("strong",{children:l.ratings})]})]}),z.jsx("div",{className:"chart-container",role:"img","aria-label":"Ratings distribution chart",children:u?z.jsx(SO,{data:c,options:h}):z.jsxs("p",{className:"helper-text",children:["No ratings recorded yet for ",ro[i]," ",n,". Enter scores to populate the chart."]})}),z.jsxs("div",{children:[z.jsx("h3",{children:"Distribution snapshot"}),z.jsxs("table",{className:"summary-table",children:[z.jsx("thead",{children:z.jsxs("tr",{children:[z.jsx("th",{scope:"col",children:"Level"}),z.jsx("th",{scope:"col",children:"Count"})]})}),z.jsx("tbody",{children:Kr.map(f=>z.jsxs("tr",{children:[z.jsx("th",{scope:"row",children:f}),z.jsx("td",{children:s[f]??0})]},f))})]})]}),z.jsxs("div",{children:[z.jsx("h3",{children:"Per-subject summary"}),z.jsxs("table",{className:"summary-table",children:[z.jsx("thead",{children:z.jsxs("tr",{children:[z.jsx("th",{scope:"col",children:"Subject"}),Kr.map(f=>z.jsx("th",{scope:"col",children:f},f)),z.jsx("th",{scope:"col",children:"Total"})]})}),z.jsxs("tbody",{children:[o.map(f=>z.jsxs("tr",{children:[z.jsx("th",{scope:"row",children:f.subjectName}),Kr.map(d=>z.jsx("td",{children:f.counts[d]},d)),z.jsx("td",{children:f.total})]},f.subjectId)),o.length===0&&z.jsx("tr",{children:z.jsx("td",{colSpan:Kr.length+2,className:"helper-text",children:"Add subjects to see breakdowns."})})]})]})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Ju={};Ju.version="0.18.5";var X_=1252,TO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],q_=function(t){TO.indexOf(t)!=-1&&(X_=t)};function kO(){q_(1252)}var Bo=function(t){q_(t)};function bO(){Bo(1200),kO()}var Bl=function(e){return String.fromCharCode(e)},Nm=function(e){return String.fromCharCode(e)},Qu,Qn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function jo(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),a=(r&3)<<4|n>>4,i=t.charCodeAt(u++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=Qn.charAt(s)+Qn.charAt(a)+Qn.charAt(o)+Qn.charAt(l);return e}function Dn(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=Qn.indexOf(t.charAt(u++)),a=Qn.indexOf(t.charAt(u++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Qn.indexOf(t.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Qn.indexOf(t.charAt(u++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Pe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Mn=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ts(t){return Pe?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Lm(t){return Pe?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Yr=function(e){return Pe?Mn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Mc(t){if(typeof ArrayBuffer>"u")return Yr(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function el(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function AO(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var At=Pe?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Mn(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function OO(t){for(var e=[],r=0,n=t.length+250,i=ts(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=ts(65535),n=65530)}return e.push(i.slice(0,r)),At(e)}var oo=/\u0000/g,jl=/[\u0001-\u0006]/g;function Ks(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Jr(t,e){var r=""+t;return r.length>=e?r:nt("0",e-r.length)+r}function C0(t,e){var r=""+t;return r.length>=e?r:nt(" ",e-r.length)+r}function Zu(t,e){var r=""+t;return r.length>=e?r:r+nt(" ",e-r.length)}function CO(t,e){var r=""+Math.round(t);return r.length>=e?r:nt("0",e-r.length)+r}function PO(t,e){var r=""+t;return r.length>=e?r:nt("0",e-r.length)+r}var Mm=Math.pow(2,32);function ps(t,e){if(t>Mm||t<-Mm)return CO(t,e);var r=Math.round(t);return PO(r,e)}function ec(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Bm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Lh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function RO(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var it={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},jm={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},FO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function tc(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,u=0,c=0,h=Math.floor(i);u<e&&(h=Math.floor(i),o=h*a+s,c=h*u+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=u,u=c;if(c>e&&(u>e?(c=l,o=s):(c=u,o=a)),!r)return[0,n*o,c];var f=Math.floor(n*o/c);return[f,n*o-f*c,c]}function Ul(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=jO(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var J_=new Date(1899,11,31,0,0,0),IO=J_.getTime(),DO=new Date(1900,2,1,0,0,0);function Q_(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=DO&&(r+=24*60*60*1e3),(r-(IO+(t.getTimezoneOffset()-J_.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function P0(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function NO(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function LO(t){var e=t<0?12:11,r=P0(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function MO(t){var e=P0(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function BO(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=LO(t):e===10?r=t.toFixed(10).substr(0,12):r=MO(t),P0(NO(r.toUpperCase()))}function nd(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):BO(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return gi(14,Q_(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function jO(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function UO(t,e,r,n){var i="",s=0,a=0,o=r.y,l,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return Lh[r.m-1][1];case 5:return Lh[r.m-1][0];default:return Lh[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return Bm[r.q][0];default:return Bm[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Jr(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Jr(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var c=u>0?Jr(l,u):"";return c}function Zn(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var Z_=/%/g;function $O(t,e,r){var n=e.replace(Z_,""),i=e.length-n.length;return An(t,n,r*Math.pow(10,2*i))+nt("%",i)}function zO(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return An(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function ey(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+ey(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,c){return l+u+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var ty=/# (\?+)( ?)\/( ?)(\d+)/;function WO(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?nt(" ",t[1].length+1+t[4].length):C0(a,t[1].length)+t[2]+"/"+t[3]+Jr(o,t[4].length))}function HO(t,e,r){return r+(e===0?"":""+e)+nt(" ",t[1].length+2+t[4].length)}var ry=/^#*0*\.([0#]+)/,ny=/\).*[0#]/,iy=/\(###\) ###\\?-####/;function Ht(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Um(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function $m(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function VO(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function GO(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Tr(t,e,r){if(t.charCodeAt(0)===40&&!e.match(ny)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Tr("n",n,r):"("+Tr("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return zO(t,e,r);if(e.indexOf("%")!==-1)return $O(t,e,r);if(e.indexOf("E")!==-1)return ey(e,r);if(e.charCodeAt(0)===36)return"$"+Tr(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+ps(l,e.length);if(e.match(/^[#?]+$/))return i=ps(r,0),i==="0"&&(i=""),i.length>e.length?i:Ht(e.substr(0,e.length-i.length))+i;if(s=e.match(ty))return WO(s,l,u);if(e.match(/^#+0+$/))return u+ps(l,e.length-e.indexOf("0"));if(s=e.match(ry))return i=Um(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Ht(s[1])).replace(/\.$/,"."+Ht(s[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+nt("0",Ht(s[1]).length-p.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+Um(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Zn(ps(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Tr(t,e,-r):Zn(""+(Math.floor(r)+VO(r,s[1].length)))+"."+Jr($m(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Tr(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ks(Tr(t,e.replace(/[\\-]/g,""),r)),a=0,Ks(Ks(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(e.match(iy))return i=Tr(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=tc(l,Math.pow(10,a)-1,!1),i=""+u,c=An("n",s[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=Zu(o[2],a),c.length<s[4].length&&(c=Ht(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=tc(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?C0(o[1],a)+s[2]+"/"+s[3]+Zu(o[2],a):nt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=ps(r,0),e.length<=i.length?i:Ht(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,f=e.length-i.length-h;return Ht(e.substr(0,h)+i+e.substr(e.length-f))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=$m(r,s[1].length),r<0?"-"+Tr(t,e,-r):Zn(GO(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Jr(0,3-g.length):"")+g})+"."+Jr(a,s[1].length);switch(e){case"###,##0.00":return Tr(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=Zn(ps(l,0));return d!=="0"?u+d:"";case"###,###.00":return Tr(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Tr(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function KO(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return An(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function YO(t,e,r){var n=e.replace(Z_,""),i=e.length-n.length;return An(t,n,r*Math.pow(10,2*i))+nt("%",i)}function sy(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+sy(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,c){return l+u+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function on(t,e,r){if(t.charCodeAt(0)===40&&!e.match(ny)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?on("n",n,r):"("+on("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return KO(t,e,r);if(e.indexOf("%")!==-1)return YO(t,e,r);if(e.indexOf("E")!==-1)return sy(e,r);if(e.charCodeAt(0)===36)return"$"+on(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Jr(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Ht(e.substr(0,e.length-i.length))+i;if(s=e.match(ty))return HO(s,l,u);if(e.match(/^#+0+$/))return u+Jr(l,e.length-e.indexOf("0"));if(s=e.match(ry))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Ht(s[1])).replace(/\.$/,"."+Ht(s[1])),i=i.replace(/\.(\d*)$/,function(g,p){return"."+p+nt("0",Ht(s[1]).length-p.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Zn(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+on(t,e,-r):Zn(""+r)+"."+nt("0",s[1].length);if(s=e.match(/^#,#*,#0/))return on(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ks(on(t,e.replace(/[\\-]/g,""),r)),a=0,Ks(Ks(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(e.match(iy))return i=on(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=tc(l,Math.pow(10,a)-1,!1),i=""+u,c=An("n",s[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=Zu(o[2],a),c.length<s[4].length&&(c=Ht(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=tc(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?C0(o[1],a)+s[2]+"/"+s[3]+Zu(o[2],a):nt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Ht(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,f=e.length-i.length-h;return Ht(e.substr(0,h)+i+e.substr(e.length-f))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+on(t,e,-r):Zn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Jr(0,3-g.length):"")+g})+"."+Jr(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var d=Zn(""+l);return d!=="0"?u+d:"";default:if(e.match(/\.[0#?]*$/))return on(t,e.slice(0,e.lastIndexOf(".")),r)+Ht(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function An(t,e,r){return(r|0)===r?on(t,e,r):Tr(t,e,r)}function XO(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var ay=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function oy(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":ec(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(ay))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function qO(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",u,c,h,f="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!ec(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var d=t.charAt(++a),g=d==="("||d===")"?d:"t";i[i.length]={t:g,v:d},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(u==null&&(u=Ul(e,r,t.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=Ul(e,r),u==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=f),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var p={t:o,v:o};if(u==null&&(u=Ul(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",f="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",a+=5,f="h"):t.substr(a,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",a+=5,f="h"):(p.t="t",++a),u==null&&p.t==="T")return"";i[i.length]=p,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(ay)){if(u==null&&(u=Ul(e,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",oy(t)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var m=0,v=0,x;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=f,l="h",m<1&&(m=1);break;case"s":(x=i[a].v.match(/\.0+$/))&&(v=Math.max(v,x[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&i[a].v.match(/[Hh]/)&&(m=1),m<2&&i[a].v.match(/[Mm]/)&&(m=2),m<3&&i[a].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",w;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=UO(i[a].t.charCodeAt(0),i[a].v,u,v),i[a].t="t";break;case"n":case"?":for(w=a+1;i[w]!=null&&((o=i[w].t)==="?"||o==="D"||(o===" "||o==="t")&&i[w+1]!=null&&(i[w+1].t==="?"||i[w+1].t==="t"&&i[w+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[w].v==="/"||i[w].v===" "&&i[w+1]!=null&&i[w+1].t=="?"));)i[a].v+=i[w].v,i[w]={v:"",t:";"},++w;_+=i[a].v,a=w-1;break;case"G":i[a].t="t",i[a].v=nd(e,r);break}var O="",R,T;if(_.length>0){_.charCodeAt(0)==40?(R=e<0&&_.charCodeAt(0)===45?-e:e,T=An("n",_,R)):(R=e<0&&n>1?-e:e,T=An("n",_,R),R<0&&i[0]&&i[0].t=="t"&&(T=T.substr(1),i[0].v="-"+i[0].v)),w=T.length-1;var P=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){P=a;break}var F=i.length;if(P===i.length&&T.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(w>=i[a].v.length-1?(w-=i[a].v.length,i[a].v=T.substr(w+1,i[a].v.length)):w<0?i[a].v="":(i[a].v=T.substr(0,w+1),w=-1),i[a].t="t",F=a);w>=0&&F<i.length&&(i[F].v=T.substr(0,w+1)+i[F].v)}else if(P!==i.length&&T.indexOf("E")===-1){for(w=T.indexOf(".")-1,a=P;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(c=i[a].v.indexOf(".")>-1&&a===P?i[a].v.indexOf(".")-1:i[a].v.length-1,O=i[a].v.substr(c+1);c>=0;--c)w>=0&&(i[a].v.charAt(c)==="0"||i[a].v.charAt(c)==="#")&&(O=T.charAt(w--)+O);i[a].v=O,i[a].t="t",F=a}for(w>=0&&F<i.length&&(i[F].v=T.substr(0,w+1)+i[F].v),w=T.indexOf(".")+1,a=P;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==P)){for(c=i[a].v.indexOf(".")>-1&&a===P?i[a].v.indexOf(".")+1:0,O=i[a].v.substr(0,c);c<i[a].v.length;++c)w<T.length&&(O+=T.charAt(w++));i[a].v=O,i[a].t="t",F=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(R=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=An(i[a].t,i[a].v,R),i[a].t="t");var N="";for(a=0;a!==i.length;++a)i[a]!=null&&(N+=i[a].v);return N}var zm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Wm(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function JO(t,e){var r=XO(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(zm),o=r[1].match(zm);return Wm(e,a)?[n,r[0]]:Wm(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function gi(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:it)[t],n==null&&(n=r.table&&r.table[jm[t]]||it[jm[t]]),n==null&&(n=FO[t]||"General");break}if(ec(n,0))return nd(e,r);e instanceof Date&&(e=Q_(e,r.date1904));var i=JO(n,e);if(ec(i[1]))return nd(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return qO(i[1],e,r,i[0])}function ly(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(it[r]==null){e<0&&(e=r);continue}if(it[r]==t){e=r;break}}e<0&&(e=391)}return it[e]=t,e}function Bc(t){for(var e=0;e!=392;++e)t[e]!==void 0&&ly(t[e],e)}function jc(){it=RO()}var uy=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function QO(t){var e=typeof t=="number"?it[t]:t;return e=e.replace(uy,"(\\d+)"),new RegExp("^"+e+"$")}function ZO(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(uy)||[]).forEach(function(h,f){var d=parseInt(r[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=d;break;case"d":s=d;break;case"h":a=d;break;case"s":l=d;break;case"m":a>=0?o=d:i=d;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var c=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:n==-1&&i==-1&&s==-1?c:u+"T"+c}var eC=function(){var t={};t.version="1.2.0";function e(){for(var T=0,P=new Array(256),F=0;F!=256;++F)T=F,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,P[F]=T;return typeof Int32Array<"u"?new Int32Array(P):P}var r=e();function n(T){var P=0,F=0,N=0,U=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(N=0;N!=256;++N)U[N]=T[N];for(N=0;N!=256;++N)for(F=T[N],P=256+N;P<4096;P+=256)F=U[P]=F>>>8^T[F&255];var H=[];for(N=1;N!=16;++N)H[N-1]=typeof Int32Array<"u"?U.subarray(N*256,N*256+256):U.slice(N*256,N*256+256);return H}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],c=i[5],h=i[6],f=i[7],d=i[8],g=i[9],p=i[10],m=i[11],v=i[12],x=i[13],_=i[14];function w(T,P){for(var F=P^-1,N=0,U=T.length;N<U;)F=F>>>8^r[(F^T.charCodeAt(N++))&255];return~F}function O(T,P){for(var F=P^-1,N=T.length-15,U=0;U<N;)F=_[T[U++]^F&255]^x[T[U++]^F>>8&255]^v[T[U++]^F>>16&255]^m[T[U++]^F>>>24]^p[T[U++]]^g[T[U++]]^d[T[U++]]^f[T[U++]]^h[T[U++]]^c[T[U++]]^u[T[U++]]^l[T[U++]]^o[T[U++]]^a[T[U++]]^s[T[U++]]^r[T[U++]];for(N+=15;U<N;)F=F>>>8^r[(F^T[U++])&255];return~F}function R(T,P){for(var F=P^-1,N=0,U=T.length,H=0,Z=0;N<U;)H=T.charCodeAt(N++),H<128?F=F>>>8^r[(F^H)&255]:H<2048?(F=F>>>8^r[(F^(192|H>>6&31))&255],F=F>>>8^r[(F^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,Z=T.charCodeAt(N++)&1023,F=F>>>8^r[(F^(240|H>>8&7))&255],F=F>>>8^r[(F^(128|H>>2&63))&255],F=F>>>8^r[(F^(128|Z>>6&15|(H&3)<<4))&255],F=F>>>8^r[(F^(128|Z&63))&255]):(F=F>>>8^r[(F^(224|H>>12&15))&255],F=F>>>8^r[(F^(128|H>>6&63))&255],F=F>>>8^r[(F^(128|H&63))&255]);return~F}return t.table=r,t.bstr=w,t.buf=O,t.str=R,t}(),je=function(){var e={};e.version="1.2.1";function r(y,k){for(var S=y.split("/"),E=k.split("/"),b=0,A=0,B=Math.min(S.length,E.length);b<B;++b){if(A=S[b].length-E[b].length)return A;if(S[b]!=E[b])return S[b]<E[b]?-1:1}return S.length-E.length}function n(y){if(y.charAt(y.length-1)=="/")return y.slice(0,-1).indexOf("/")===-1?y:n(y.slice(0,-1));var k=y.lastIndexOf("/");return k===-1?y:y.slice(0,k+1)}function i(y){if(y.charAt(y.length-1)=="/")return i(y.slice(0,-1));var k=y.lastIndexOf("/");return k===-1?y:y.slice(k+1)}function s(y,k){typeof k=="string"&&(k=new Date(k));var S=k.getHours();S=S<<6|k.getMinutes(),S=S<<5|k.getSeconds()>>>1,y.write_shift(2,S);var E=k.getFullYear()-1980;E=E<<4|k.getMonth()+1,E=E<<5|k.getDate(),y.write_shift(2,E)}function a(y){var k=y.read_shift(2)&65535,S=y.read_shift(2)&65535,E=new Date,b=S&31;S>>>=5;var A=S&15;S>>>=4,E.setMilliseconds(0),E.setFullYear(S+1980),E.setMonth(A-1),E.setDate(b);var B=k&31;k>>>=5;var K=k&63;return k>>>=6,E.setHours(k),E.setMinutes(K),E.setSeconds(B<<1),E}function o(y){cr(y,0);for(var k={},S=0;y.l<=y.length-4;){var E=y.read_shift(2),b=y.read_shift(2),A=y.l+b,B={};switch(E){case 21589:S=y.read_shift(1),S&1&&(B.mtime=y.read_shift(4)),b>5&&(S&2&&(B.atime=y.read_shift(4)),S&4&&(B.ctime=y.read_shift(4))),B.mtime&&(B.mt=new Date(B.mtime*1e3));break}y.l=A,k[E]=B}return k}var l;function u(){return l||(l={})}function c(y,k){if(y[0]==80&&y[1]==75)return pp(y,k);if((y[0]|32)==109&&(y[1]|32)==105)return W2(y,k);if(y.length<512)throw new Error("CFB file size "+y.length+" < 512");var S=3,E=512,b=0,A=0,B=0,K=0,M=0,j=[],W=y.slice(0,512);cr(W,0);var J=h(W);switch(S=J[0],S){case 3:E=512;break;case 4:E=4096;break;case 0:if(J[1]==0)return pp(y,k);default:throw new Error("Major Version: Expected 3 or 4 saw "+S)}E!==512&&(W=y.slice(0,E),cr(W,28));var ne=y.slice(0,E);f(W,S);var ue=W.read_shift(4,"i");if(S===3&&ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ue);W.l+=4,B=W.read_shift(4,"i"),W.l+=4,W.chk("00100000","Mini Stream Cutoff Size: "),K=W.read_shift(4,"i"),b=W.read_shift(4,"i"),M=W.read_shift(4,"i"),A=W.read_shift(4,"i");for(var ee=-1,se=0;se<109&&(ee=W.read_shift(4,"i"),!(ee<0));++se)j[se]=ee;var ye=d(y,E);m(M,A,ye,E,j);var qe=x(ye,B,j,E);qe[B].name="!Directory",b>0&&K!==Z&&(qe[K].name="!MiniFAT"),qe[j[0]].name="!FAT",qe.fat_addrs=j,qe.ssz=E;var Je={},It=[],wa=[],Sa=[];_(B,qe,ye,It,b,Je,wa,K),g(wa,Sa,It),It.shift();var Ea={FileIndex:wa,FullPaths:Sa};return k&&k.raw&&(Ea.raw={header:ne,sectors:ye}),Ea}function h(y){if(y[y.l]==80&&y[y.l+1]==75)return[0,0];y.chk(ve,"Header Signature: "),y.l+=16;var k=y.read_shift(2,"u");return[y.read_shift(2,"u"),k]}function f(y,k){var S=9;switch(y.l+=2,S=y.read_shift(2)){case 9:if(k!=3)throw new Error("Sector Shift: Expected 9 saw "+S);break;case 12:if(k!=4)throw new Error("Sector Shift: Expected 12 saw "+S);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+S)}y.chk("0600","Mini Sector Shift: "),y.chk("000000000000","Reserved: ")}function d(y,k){for(var S=Math.ceil(y.length/k)-1,E=[],b=1;b<S;++b)E[b-1]=y.slice(b*k,(b+1)*k);return E[S-1]=y.slice(S*k),E}function g(y,k,S){for(var E=0,b=0,A=0,B=0,K=0,M=S.length,j=[],W=[];E<M;++E)j[E]=W[E]=E,k[E]=S[E];for(;K<W.length;++K)E=W[K],b=y[E].L,A=y[E].R,B=y[E].C,j[E]===E&&(b!==-1&&j[b]!==b&&(j[E]=j[b]),A!==-1&&j[A]!==A&&(j[E]=j[A])),B!==-1&&(j[B]=E),b!==-1&&E!=j[E]&&(j[b]=j[E],W.lastIndexOf(b)<K&&W.push(b)),A!==-1&&E!=j[E]&&(j[A]=j[E],W.lastIndexOf(A)<K&&W.push(A));for(E=1;E<M;++E)j[E]===E&&(A!==-1&&j[A]!==A?j[E]=j[A]:b!==-1&&j[b]!==b&&(j[E]=j[b]));for(E=1;E<M;++E)if(y[E].type!==0){if(K=E,K!=j[K])do K=j[K],k[E]=k[K]+"/"+k[E];while(K!==0&&j[K]!==-1&&K!=j[K]);j[E]=-1}for(k[0]+="/",E=1;E<M;++E)y[E].type!==2&&(k[E]+="/")}function p(y,k,S){for(var E=y.start,b=y.size,A=[],B=E;S&&b>0&&B>=0;)A.push(k.slice(B*H,B*H+H)),b-=H,B=Li(S,B*4);return A.length===0?V(0):At(A).slice(0,y.size)}function m(y,k,S,E,b){var A=Z;if(y===Z){if(k!==0)throw new Error("DIFAT chain shorter than expected")}else if(y!==-1){var B=S[y],K=(E>>>2)-1;if(!B)return;for(var M=0;M<K&&(A=Li(B,M*4))!==Z;++M)b.push(A);m(Li(B,E-4),k-1,S,E,b)}}function v(y,k,S,E,b){var A=[],B=[];b||(b=[]);var K=E-1,M=0,j=0;for(M=k;M>=0;){b[M]=!0,A[A.length]=M,B.push(y[M]);var W=S[Math.floor(M*4/E)];if(j=M*4&K,E<4+j)throw new Error("FAT boundary crossed: "+M+" 4 "+E);if(!y[W])break;M=Li(y[W],j)}return{nodes:A,data:Jm([B])}}function x(y,k,S,E){var b=y.length,A=[],B=[],K=[],M=[],j=E-1,W=0,J=0,ne=0,ue=0;for(W=0;W<b;++W)if(K=[],ne=W+k,ne>=b&&(ne-=b),!B[ne]){M=[];var ee=[];for(J=ne;J>=0;){ee[J]=!0,B[J]=!0,K[K.length]=J,M.push(y[J]);var se=S[Math.floor(J*4/E)];if(ue=J*4&j,E<4+ue)throw new Error("FAT boundary crossed: "+J+" 4 "+E);if(!y[se]||(J=Li(y[se],ue),ee[J]))break}A[ne]={nodes:K,data:Jm([M])}}return A}function _(y,k,S,E,b,A,B,K){for(var M=0,j=E.length?2:0,W=k[y].data,J=0,ne=0,ue;J<W.length;J+=128){var ee=W.slice(J,J+128);cr(ee,64),ne=ee.read_shift(2),ue=N0(ee,0,ne-j),E.push(ue);var se={name:ue,type:ee.read_shift(1),color:ee.read_shift(1),L:ee.read_shift(4,"i"),R:ee.read_shift(4,"i"),C:ee.read_shift(4,"i"),clsid:ee.read_shift(16),state:ee.read_shift(4,"i"),start:0,size:0},ye=ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2);ye!==0&&(se.ct=w(ee,ee.l-8));var qe=ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2);qe!==0&&(se.mt=w(ee,ee.l-8)),se.start=ee.read_shift(4,"i"),se.size=ee.read_shift(4,"i"),se.size<0&&se.start<0&&(se.size=se.type=0,se.start=Z,se.name=""),se.type===5?(M=se.start,b>0&&M!==Z&&(k[M].name="!StreamData")):se.size>=4096?(se.storage="fat",k[se.start]===void 0&&(k[se.start]=v(S,se.start,k.fat_addrs,k.ssz)),k[se.start].name=se.name,se.content=k[se.start].data.slice(0,se.size)):(se.storage="minifat",se.size<0?se.size=0:M!==Z&&se.start!==Z&&k[M]&&(se.content=p(se,k[M].data,(k[K]||{}).data))),se.content&&cr(se.content,0),A[ue]=se,B.push(se)}}function w(y,k){return new Date((fr(y,k+4)/1e7*Math.pow(2,32)+fr(y,k)/1e7-11644473600)*1e3)}function O(y,k){return u(),c(l.readFileSync(y),k)}function R(y,k){var S=k&&k.type;switch(S||Pe&&Buffer.isBuffer(y)&&(S="buffer"),S||"base64"){case"file":return O(y,k);case"base64":return c(Yr(Dn(y)),k);case"binary":return c(Yr(y),k)}return c(y,k)}function T(y,k){var S=k||{},E=S.root||"Root Entry";if(y.FullPaths||(y.FullPaths=[]),y.FileIndex||(y.FileIndex=[]),y.FullPaths.length!==y.FileIndex.length)throw new Error("inconsistent CFB structure");y.FullPaths.length===0&&(y.FullPaths[0]=E+"/",y.FileIndex[0]={name:E,type:5}),S.CLSID&&(y.FileIndex[0].clsid=S.CLSID),P(y)}function P(y){var k="Sh33tJ5";if(!je.find(y,"/"+k)){var S=V(4);S[0]=55,S[1]=S[3]=50,S[2]=54,y.FileIndex.push({name:k,type:2,content:S,size:4,L:69,R:69,C:69}),y.FullPaths.push(y.FullPaths[0]+k),F(y)}}function F(y,k){T(y);for(var S=!1,E=!1,b=y.FullPaths.length-1;b>=0;--b){var A=y.FileIndex[b];switch(A.type){case 0:E?S=!0:(y.FileIndex.pop(),y.FullPaths.pop());break;case 1:case 2:case 5:E=!0,isNaN(A.R*A.L*A.C)&&(S=!0),A.R>-1&&A.L>-1&&A.R==A.L&&(S=!0);break;default:S=!0;break}}if(!(!S&&!k)){var B=new Date(1987,1,19),K=0,M=Object.create?Object.create(null):{},j=[];for(b=0;b<y.FullPaths.length;++b)M[y.FullPaths[b]]=!0,y.FileIndex[b].type!==0&&j.push([y.FullPaths[b],y.FileIndex[b]]);for(b=0;b<j.length;++b){var W=n(j[b][0]);E=M[W],E||(j.push([W,{name:i(W).replace("/",""),type:1,clsid:we,ct:B,mt:B,content:null}]),M[W]=!0)}for(j.sort(function(ue,ee){return r(ue[0],ee[0])}),y.FullPaths=[],y.FileIndex=[],b=0;b<j.length;++b)y.FullPaths[b]=j[b][0],y.FileIndex[b]=j[b][1];for(b=0;b<j.length;++b){var J=y.FileIndex[b],ne=y.FullPaths[b];if(J.name=i(ne).replace("/",""),J.L=J.R=J.C=-(J.color=1),J.size=J.content?J.content.length:0,J.start=0,J.clsid=J.clsid||we,b===0)J.C=j.length>1?1:-1,J.size=0,J.type=5;else if(ne.slice(-1)=="/"){for(K=b+1;K<j.length&&n(y.FullPaths[K])!=ne;++K);for(J.C=K>=j.length?-1:K,K=b+1;K<j.length&&n(y.FullPaths[K])!=n(ne);++K);J.R=K>=j.length?-1:K,J.type=1}else n(y.FullPaths[b+1]||"")==n(ne)&&(J.R=b+1),J.type=2}}}function N(y,k){var S=k||{};if(S.fileType=="mad")return H2(y,S);switch(F(y),S.fileType){case"zip":return M2(y,S)}var E=function(ue){for(var ee=0,se=0,ye=0;ye<ue.FileIndex.length;++ye){var qe=ue.FileIndex[ye];if(qe.content){var Je=qe.content.length;Je>0&&(Je<4096?ee+=Je+63>>6:se+=Je+511>>9)}}for(var It=ue.FullPaths.length+3>>2,wa=ee+7>>3,Sa=ee+127>>7,Ea=wa+se+It+Sa,ki=Ea+127>>7,Jc=ki<=109?0:Math.ceil((ki-109)/127);Ea+ki+Jc+127>>7>ki;)Jc=++ki<=109?0:Math.ceil((ki-109)/127);var mn=[1,Jc,ki,Sa,It,se,ee,0];return ue.FileIndex[0].size=ee<<6,mn[7]=(ue.FileIndex[0].start=mn[0]+mn[1]+mn[2]+mn[3]+mn[4]+mn[5])+(mn[6]+7>>3),mn}(y),b=V(E[7]<<9),A=0,B=0;{for(A=0;A<8;++A)b.write_shift(1,oe[A]);for(A=0;A<8;++A)b.write_shift(2,0);for(b.write_shift(2,62),b.write_shift(2,3),b.write_shift(2,65534),b.write_shift(2,9),b.write_shift(2,6),A=0;A<3;++A)b.write_shift(2,0);for(b.write_shift(4,0),b.write_shift(4,E[2]),b.write_shift(4,E[0]+E[1]+E[2]+E[3]-1),b.write_shift(4,0),b.write_shift(4,4096),b.write_shift(4,E[3]?E[0]+E[1]+E[2]-1:Z),b.write_shift(4,E[3]),b.write_shift(-4,E[1]?E[0]-1:Z),b.write_shift(4,E[1]),A=0;A<109;++A)b.write_shift(-4,A<E[2]?E[1]+A:-1)}if(E[1])for(B=0;B<E[1];++B){for(;A<236+B*127;++A)b.write_shift(-4,A<E[2]?E[1]+A:-1);b.write_shift(-4,B===E[1]-1?Z:B+1)}var K=function(ue){for(B+=ue;A<B-1;++A)b.write_shift(-4,A+1);ue&&(++A,b.write_shift(-4,Z))};for(B=A=0,B+=E[1];A<B;++A)b.write_shift(-4,_e.DIFSECT);for(B+=E[2];A<B;++A)b.write_shift(-4,_e.FATSECT);K(E[3]),K(E[4]);for(var M=0,j=0,W=y.FileIndex[0];M<y.FileIndex.length;++M)W=y.FileIndex[M],W.content&&(j=W.content.length,!(j<4096)&&(W.start=B,K(j+511>>9)));for(K(E[6]+7>>3);b.l&511;)b.write_shift(-4,_e.ENDOFCHAIN);for(B=A=0,M=0;M<y.FileIndex.length;++M)W=y.FileIndex[M],W.content&&(j=W.content.length,!(!j||j>=4096)&&(W.start=B,K(j+63>>6)));for(;b.l&511;)b.write_shift(-4,_e.ENDOFCHAIN);for(A=0;A<E[4]<<2;++A){var J=y.FullPaths[A];if(!J||J.length===0){for(M=0;M<17;++M)b.write_shift(4,0);for(M=0;M<3;++M)b.write_shift(4,-1);for(M=0;M<12;++M)b.write_shift(4,0);continue}W=y.FileIndex[A],A===0&&(W.start=W.size?W.start-1:Z);var ne=A===0&&S.root||W.name;if(j=2*(ne.length+1),b.write_shift(64,ne,"utf16le"),b.write_shift(2,j),b.write_shift(1,W.type),b.write_shift(1,W.color),b.write_shift(-4,W.L),b.write_shift(-4,W.R),b.write_shift(-4,W.C),W.clsid)b.write_shift(16,W.clsid,"hex");else for(M=0;M<4;++M)b.write_shift(4,0);b.write_shift(4,W.state||0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,W.start),b.write_shift(4,W.size),b.write_shift(4,0)}for(A=1;A<y.FileIndex.length;++A)if(W=y.FileIndex[A],W.size>=4096)if(b.l=W.start+1<<9,Pe&&Buffer.isBuffer(W.content))W.content.copy(b,b.l,0,W.size),b.l+=W.size+511&-512;else{for(M=0;M<W.size;++M)b.write_shift(1,W.content[M]);for(;M&511;++M)b.write_shift(1,0)}for(A=1;A<y.FileIndex.length;++A)if(W=y.FileIndex[A],W.size>0&&W.size<4096)if(Pe&&Buffer.isBuffer(W.content))W.content.copy(b,b.l,0,W.size),b.l+=W.size+63&-64;else{for(M=0;M<W.size;++M)b.write_shift(1,W.content[M]);for(;M&63;++M)b.write_shift(1,0)}if(Pe)b.l=b.length;else for(;b.l<b.length;)b.write_shift(1,0);return b}function U(y,k){var S=y.FullPaths.map(function(M){return M.toUpperCase()}),E=S.map(function(M){var j=M.split("/");return j[j.length-(M.slice(-1)=="/"?2:1)]}),b=!1;k.charCodeAt(0)===47?(b=!0,k=S[0].slice(0,-1)+k):b=k.indexOf("/")!==-1;var A=k.toUpperCase(),B=b===!0?S.indexOf(A):E.indexOf(A);if(B!==-1)return y.FileIndex[B];var K=!A.match(jl);for(A=A.replace(oo,""),K&&(A=A.replace(jl,"!")),B=0;B<S.length;++B)if((K?S[B].replace(jl,"!"):S[B]).replace(oo,"")==A||(K?E[B].replace(jl,"!"):E[B]).replace(oo,"")==A)return y.FileIndex[B];return null}var H=64,Z=-2,ve="d0cf11e0a1b11ae1",oe=[208,207,17,224,161,177,26,225],we="00000000000000000000000000000000",_e={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Z,FREESECT:-1,HEADER_SIGNATURE:ve,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:we,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Y(y,k,S){u();var E=N(y,S);l.writeFileSync(k,E)}function q(y){for(var k=new Array(y.length),S=0;S<y.length;++S)k[S]=String.fromCharCode(y[S]);return k.join("")}function he(y,k){var S=N(y,k);switch(k&&k.type||"buffer"){case"file":return u(),l.writeFileSync(k.filename,S),S;case"binary":return typeof S=="string"?S:q(S);case"base64":return jo(typeof S=="string"?S:q(S));case"buffer":if(Pe)return Buffer.isBuffer(S)?S:Mn(S);case"array":return typeof S=="string"?Yr(S):S}return S}var xe;function C(y){try{var k=y.InflateRaw,S=new k;if(S._processChunk(new Uint8Array([3,0]),S._finishFlushFlag),S.bytesRead)xe=y;else throw new Error("zlib does not expose bytesRead")}catch(E){console.error("cannot use native zlib: "+(E.message||E))}}function L(y,k){if(!xe)return fp(y,k);var S=xe.InflateRaw,E=new S,b=E._processChunk(y.slice(y.l),E._finishFlushFlag);return y.l+=E.bytesRead,b}function I(y){return xe?xe.deflateRawSync(y):ap(y)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(y){var k=(y<<1|y<<11)&139536|(y<<5|y<<15)&558144;return(k>>16|k>>8|k)&255}for(var fe=typeof Uint8Array<"u",ie=fe?new Uint8Array(256):[],Fe=0;Fe<256;++Fe)ie[Fe]=ae(Fe);function Te(y,k){var S=ie[y&255];return k<=8?S>>>8-k:(S=S<<8|ie[y>>8&255],k<=16?S>>>16-k:(S=S<<8|ie[y>>16&255],S>>>24-k))}function St(y,k){var S=k&7,E=k>>>3;return(y[E]|(S<=6?0:y[E+1]<<8))>>>S&3}function Ae(y,k){var S=k&7,E=k>>>3;return(y[E]|(S<=5?0:y[E+1]<<8))>>>S&7}function Mr(y,k){var S=k&7,E=k>>>3;return(y[E]|(S<=4?0:y[E+1]<<8))>>>S&15}function Ye(y,k){var S=k&7,E=k>>>3;return(y[E]|(S<=3?0:y[E+1]<<8))>>>S&31}function de(y,k){var S=k&7,E=k>>>3;return(y[E]|(S<=1?0:y[E+1]<<8))>>>S&127}function wr(y,k,S){var E=k&7,b=k>>>3,A=(1<<S)-1,B=y[b]>>>E;return S<8-E||(B|=y[b+1]<<8-E,S<16-E)||(B|=y[b+2]<<16-E,S<24-E)||(B|=y[b+3]<<24-E),B&A}function gn(y,k,S){var E=k&7,b=k>>>3;return E<=5?y[b]|=(S&7)<<E:(y[b]|=S<<E&255,y[b+1]=(S&7)>>8-E),k+3}function Ei(y,k,S){var E=k&7,b=k>>>3;return S=(S&1)<<E,y[b]|=S,k+1}function hs(y,k,S){var E=k&7,b=k>>>3;return S<<=E,y[b]|=S&255,S>>>=8,y[b+1]=S,k+8}function sp(y,k,S){var E=k&7,b=k>>>3;return S<<=E,y[b]|=S&255,S>>>=8,y[b+1]=S&255,y[b+2]=S>>>8,k+16}function Kc(y,k){var S=y.length,E=2*S>k?2*S:k+5,b=0;if(S>=k)return y;if(Pe){var A=Lm(E);if(y.copy)y.copy(A);else for(;b<y.length;++b)A[b]=y[b];return A}else if(fe){var B=new Uint8Array(E);if(B.set)B.set(y);else for(;b<S;++b)B[b]=y[b];return B}return y.length=E,y}function rn(y){for(var k=new Array(y),S=0;S<y;++S)k[S]=0;return k}function ol(y,k,S){var E=1,b=0,A=0,B=0,K=0,M=y.length,j=fe?new Uint16Array(32):rn(32);for(A=0;A<32;++A)j[A]=0;for(A=M;A<S;++A)y[A]=0;M=y.length;var W=fe?new Uint16Array(M):rn(M);for(A=0;A<M;++A)j[b=y[A]]++,E<b&&(E=b),W[A]=0;for(j[0]=0,A=1;A<=E;++A)j[A+16]=K=K+j[A-1]<<1;for(A=0;A<M;++A)K=y[A],K!=0&&(W[A]=j[K+16]++);var J=0;for(A=0;A<M;++A)if(J=y[A],J!=0)for(K=Te(W[A],E)>>E-J,B=(1<<E+4-J)-1;B>=0;--B)k[K|B<<J]=J&15|A<<4;return E}var Yc=fe?new Uint16Array(512):rn(512),Xc=fe?new Uint16Array(32):rn(32);if(!fe){for(var Ti=0;Ti<512;++Ti)Yc[Ti]=0;for(Ti=0;Ti<32;++Ti)Xc[Ti]=0}(function(){for(var y=[],k=0;k<32;k++)y.push(5);ol(y,Xc,32);var S=[];for(k=0;k<=143;k++)S.push(8);for(;k<=255;k++)S.push(9);for(;k<=279;k++)S.push(7);for(;k<=287;k++)S.push(8);ol(S,Yc,288)})();var I2=function(){for(var k=fe?new Uint8Array(32768):[],S=0,E=0;S<le.length-1;++S)for(;E<le[S+1];++E)k[E]=S;for(;E<32768;++E)k[E]=29;var b=fe?new Uint8Array(259):[];for(S=0,E=0;S<G.length-1;++S)for(;E<G[S+1];++E)b[E]=S;function A(K,M){for(var j=0;j<K.length;){var W=Math.min(65535,K.length-j),J=j+W==K.length;for(M.write_shift(1,+J),M.write_shift(2,W),M.write_shift(2,~W&65535);W-- >0;)M[M.l++]=K[j++]}return M.l}function B(K,M){for(var j=0,W=0,J=fe?new Uint16Array(32768):[];W<K.length;){var ne=Math.min(65535,K.length-W);if(ne<10){for(j=gn(M,j,+(W+ne==K.length)),j&7&&(j+=8-(j&7)),M.l=j/8|0,M.write_shift(2,ne),M.write_shift(2,~ne&65535);ne-- >0;)M[M.l++]=K[W++];j=M.l*8;continue}j=gn(M,j,+(W+ne==K.length)+2);for(var ue=0;ne-- >0;){var ee=K[W];ue=(ue<<5^ee)&32767;var se=-1,ye=0;if((se=J[ue])&&(se|=W&-32768,se>W&&(se-=32768),se<W))for(;K[se+ye]==K[W+ye]&&ye<250;)++ye;if(ye>2){ee=b[ye],ee<=22?j=hs(M,j,ie[ee+1]>>1)-1:(hs(M,j,3),j+=5,hs(M,j,ie[ee-23]>>5),j+=3);var qe=ee<8?0:ee-4>>2;qe>0&&(sp(M,j,ye-G[ee]),j+=qe),ee=k[W-se],j=hs(M,j,ie[ee]>>3),j-=3;var Je=ee<4?0:ee-2>>1;Je>0&&(sp(M,j,W-se-le[ee]),j+=Je);for(var It=0;It<ye;++It)J[ue]=W&32767,ue=(ue<<5^K[W])&32767,++W;ne-=ye-1}else ee<=143?ee=ee+48:j=Ei(M,j,1),j=hs(M,j,ie[ee]),J[ue]=W&32767,++W}j=hs(M,j,0)-1}return M.l=(j+7)/8|0,M.l}return function(M,j){return M.length<8?A(M,j):B(M,j)}}();function ap(y){var k=V(50+Math.floor(y.length*1.1)),S=I2(y,k);return k.slice(0,S)}var op=fe?new Uint16Array(32768):rn(32768),lp=fe?new Uint16Array(32768):rn(32768),up=fe?new Uint16Array(128):rn(128),cp=1,hp=1;function D2(y,k){var S=Ye(y,k)+257;k+=5;var E=Ye(y,k)+1;k+=5;var b=Mr(y,k)+4;k+=4;for(var A=0,B=fe?new Uint8Array(19):rn(19),K=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],M=1,j=fe?new Uint8Array(8):rn(8),W=fe?new Uint8Array(8):rn(8),J=B.length,ne=0;ne<b;++ne)B[D[ne]]=A=Ae(y,k),M<A&&(M=A),j[A]++,k+=3;var ue=0;for(j[0]=0,ne=1;ne<=M;++ne)W[ne]=ue=ue+j[ne-1]<<1;for(ne=0;ne<J;++ne)(ue=B[ne])!=0&&(K[ne]=W[ue]++);var ee=0;for(ne=0;ne<J;++ne)if(ee=B[ne],ee!=0){ue=ie[K[ne]]>>8-ee;for(var se=(1<<7-ee)-1;se>=0;--se)up[ue|se<<ee]=ee&7|ne<<3}var ye=[];for(M=1;ye.length<S+E;)switch(ue=up[de(y,k)],k+=ue&7,ue>>>=3){case 16:for(A=3+St(y,k),k+=2,ue=ye[ye.length-1];A-- >0;)ye.push(ue);break;case 17:for(A=3+Ae(y,k),k+=3;A-- >0;)ye.push(0);break;case 18:for(A=11+de(y,k),k+=7;A-- >0;)ye.push(0);break;default:ye.push(ue),M<ue&&(M=ue);break}var qe=ye.slice(0,S),Je=ye.slice(S);for(ne=S;ne<286;++ne)qe[ne]=0;for(ne=E;ne<30;++ne)Je[ne]=0;return cp=ol(qe,op,286),hp=ol(Je,lp,30),k}function N2(y,k){if(y[0]==3&&!(y[1]&3))return[ts(k),2];for(var S=0,E=0,b=Lm(k||1<<18),A=0,B=b.length>>>0,K=0,M=0;!(E&1);){if(E=Ae(y,S),S+=3,E>>>1)E>>1==1?(K=9,M=5):(S=D2(y,S),K=cp,M=hp);else{S&7&&(S+=8-(S&7));var j=y[S>>>3]|y[(S>>>3)+1]<<8;if(S+=32,j>0)for(!k&&B<A+j&&(b=Kc(b,A+j),B=b.length);j-- >0;)b[A++]=y[S>>>3],S+=8;continue}for(;;){!k&&B<A+32767&&(b=Kc(b,A+32767),B=b.length);var W=wr(y,S,K),J=E>>>1==1?Yc[W]:op[W];if(S+=J&15,J>>>=4,!(J>>>8&255))b[A++]=J;else{if(J==256)break;J-=257;var ne=J<8?0:J-4>>2;ne>5&&(ne=0);var ue=A+G[J];ne>0&&(ue+=wr(y,S,ne),S+=ne),W=wr(y,S,M),J=E>>>1==1?Xc[W]:lp[W],S+=J&15,J>>>=4;var ee=J<4?0:J-2>>1,se=le[J];for(ee>0&&(se+=wr(y,S,ee),S+=ee),!k&&B<ue&&(b=Kc(b,ue+100),B=b.length);A<ue;)b[A]=b[A-se],++A}}}return k?[b,S+7>>>3]:[b.slice(0,A),S+7>>>3]}function fp(y,k){var S=y.slice(y.l||0),E=N2(S,k);return y.l+=E[1],E[0]}function dp(y,k){if(y)typeof console<"u"&&console.error(k);else throw new Error(k)}function pp(y,k){var S=y;cr(S,0);var E=[],b=[],A={FileIndex:E,FullPaths:b};T(A,{root:k.root});for(var B=S.length-4;(S[B]!=80||S[B+1]!=75||S[B+2]!=5||S[B+3]!=6)&&B>=0;)--B;S.l=B+4,S.l+=4;var K=S.read_shift(2);S.l+=6;var M=S.read_shift(4);for(S.l=M,B=0;B<K;++B){S.l+=20;var j=S.read_shift(4),W=S.read_shift(4),J=S.read_shift(2),ne=S.read_shift(2),ue=S.read_shift(2);S.l+=8;var ee=S.read_shift(4),se=o(S.slice(S.l+J,S.l+J+ne));S.l+=J+ne+ue;var ye=S.l;S.l=ee+4,L2(S,j,W,A,se),S.l=ye}return A}function L2(y,k,S,E,b){y.l+=2;var A=y.read_shift(2),B=y.read_shift(2),K=a(y);if(A&8257)throw new Error("Unsupported ZIP encryption");for(var M=y.read_shift(4),j=y.read_shift(4),W=y.read_shift(4),J=y.read_shift(2),ne=y.read_shift(2),ue="",ee=0;ee<J;++ee)ue+=String.fromCharCode(y[y.l++]);if(ne){var se=o(y.slice(y.l,y.l+ne));(se[21589]||{}).mt&&(K=se[21589].mt),((b||{})[21589]||{}).mt&&(K=b[21589].mt)}y.l+=ne;var ye=y.slice(y.l,y.l+j);switch(B){case 8:ye=L(y,W);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+B)}var qe=!1;A&8&&(M=y.read_shift(4),M==134695760&&(M=y.read_shift(4),qe=!0),j=y.read_shift(4),W=y.read_shift(4)),j!=k&&dp(qe,"Bad compressed size: "+k+" != "+j),W!=S&&dp(qe,"Bad uncompressed size: "+S+" != "+W),qc(E,ue,ye,{unsafe:!0,mt:K})}function M2(y,k){var S=k||{},E=[],b=[],A=V(1),B=S.compression?8:0,K=0,M=0,j=0,W=0,J=0,ne=y.FullPaths[0],ue=ne,ee=y.FileIndex[0],se=[],ye=0;for(M=1;M<y.FullPaths.length;++M)if(ue=y.FullPaths[M].slice(ne.length),ee=y.FileIndex[M],!(!ee.size||!ee.content||ue=="Sh33tJ5")){var qe=W,Je=V(ue.length);for(j=0;j<ue.length;++j)Je.write_shift(1,ue.charCodeAt(j)&127);Je=Je.slice(0,Je.l),se[J]=eC.buf(ee.content,0);var It=ee.content;B==8&&(It=I(It)),A=V(30),A.write_shift(4,67324752),A.write_shift(2,20),A.write_shift(2,K),A.write_shift(2,B),ee.mt?s(A,ee.mt):A.write_shift(4,0),A.write_shift(-4,se[J]),A.write_shift(4,It.length),A.write_shift(4,ee.content.length),A.write_shift(2,Je.length),A.write_shift(2,0),W+=A.length,E.push(A),W+=Je.length,E.push(Je),W+=It.length,E.push(It),A=V(46),A.write_shift(4,33639248),A.write_shift(2,0),A.write_shift(2,20),A.write_shift(2,K),A.write_shift(2,B),A.write_shift(4,0),A.write_shift(-4,se[J]),A.write_shift(4,It.length),A.write_shift(4,ee.content.length),A.write_shift(2,Je.length),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(4,0),A.write_shift(4,qe),ye+=A.l,b.push(A),ye+=Je.length,b.push(Je),++J}return A=V(22),A.write_shift(4,101010256),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,J),A.write_shift(2,J),A.write_shift(4,ye),A.write_shift(4,W),A.write_shift(2,0),At([At(E),At(b),A])}var ll={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function B2(y,k){if(y.ctype)return y.ctype;var S=y.name||"",E=S.match(/\.([^\.]+)$/);return E&&ll[E[1]]||k&&(E=(S=k).match(/[\.\\]([^\.\\])+$/),E&&ll[E[1]])?ll[E[1]]:"application/octet-stream"}function j2(y){for(var k=jo(y),S=[],E=0;E<k.length;E+=76)S.push(k.slice(E,E+76));return S.join(`\r
`)+`\r
`}function U2(y){var k=y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(j){var W=j.charCodeAt(0).toString(16).toUpperCase();return"="+(W.length==1?"0"+W:W)});k=k.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),k.charAt(0)==`
`&&(k="=0D"+k.slice(1)),k=k.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var S=[],E=k.split(`\r
`),b=0;b<E.length;++b){var A=E[b];if(A.length==0){S.push("");continue}for(var B=0;B<A.length;){var K=76,M=A.slice(B,B+K);M.charAt(K-1)=="="?K--:M.charAt(K-2)=="="?K-=2:M.charAt(K-3)=="="&&(K-=3),M=A.slice(B,B+K),B+=K,B<A.length&&(M+="="),S.push(M)}}return S.join(`\r
`)}function $2(y){for(var k=[],S=0;S<y.length;++S){for(var E=y[S];S<=y.length&&E.charAt(E.length-1)=="=";)E=E.slice(0,E.length-1)+y[++S];k.push(E)}for(var b=0;b<k.length;++b)k[b]=k[b].replace(/[=][0-9A-Fa-f]{2}/g,function(A){return String.fromCharCode(parseInt(A.slice(1),16))});return Yr(k.join(`\r
`))}function z2(y,k,S){for(var E="",b="",A="",B,K=0;K<10;++K){var M=k[K];if(!M||M.match(/^\s*$/))break;var j=M.match(/^(.*?):\s*([^\s].*)$/);if(j)switch(j[1].toLowerCase()){case"content-location":E=j[2].trim();break;case"content-type":A=j[2].trim();break;case"content-transfer-encoding":b=j[2].trim();break}}switch(++K,b.toLowerCase()){case"base64":B=Yr(Dn(k.slice(K).join("")));break;case"quoted-printable":B=$2(k.slice(K));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+b)}var W=qc(y,E.slice(S.length),B,{unsafe:!0});A&&(W.ctype=A)}function W2(y,k){if(q(y.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var S=k&&k.root||"",E=(Pe&&Buffer.isBuffer(y)?y.toString("binary"):q(y)).split(`\r
`),b=0,A="";for(b=0;b<E.length;++b)if(A=E[b],!!/^Content-Location:/i.test(A)&&(A=A.slice(A.indexOf("file")),S||(S=A.slice(0,A.lastIndexOf("/")+1)),A.slice(0,S.length)!=S))for(;S.length>0&&(S=S.slice(0,S.length-1),S=S.slice(0,S.lastIndexOf("/")+1),A.slice(0,S.length)!=S););var B=(E[1]||"").match(/boundary="(.*?)"/);if(!B)throw new Error("MAD cannot find boundary");var K="--"+(B[1]||""),M=[],j=[],W={FileIndex:M,FullPaths:j};T(W);var J,ne=0;for(b=0;b<E.length;++b){var ue=E[b];ue!==K&&ue!==K+"--"||(ne++&&z2(W,E.slice(J,b),S),J=b)}return W}function H2(y,k){var S=k||{},E=S.boundary||"SheetJS";E="------="+E;for(var b=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+E.slice(2)+'"',"","",""],A=y.FullPaths[0],B=A,K=y.FileIndex[0],M=1;M<y.FullPaths.length;++M)if(B=y.FullPaths[M].slice(A.length),K=y.FileIndex[M],!(!K.size||!K.content||B=="Sh33tJ5")){B=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ye){return"_x"+ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ye){return"_u"+ye.charCodeAt(0).toString(16)+"_"});for(var j=K.content,W=Pe&&Buffer.isBuffer(j)?j.toString("binary"):q(j),J=0,ne=Math.min(1024,W.length),ue=0,ee=0;ee<=ne;++ee)(ue=W.charCodeAt(ee))>=32&&ue<128&&++J;var se=J>=ne*4/5;b.push(E),b.push("Content-Location: "+(S.root||"file:///C:/SheetJS/")+B),b.push("Content-Transfer-Encoding: "+(se?"quoted-printable":"base64")),b.push("Content-Type: "+B2(K,B)),b.push(""),b.push(se?U2(W):j2(W))}return b.push(E+`--\r
`),b.join(`\r
`)}function V2(y){var k={};return T(k,y),k}function qc(y,k,S,E){var b=E&&E.unsafe;b||T(y);var A=!b&&je.find(y,k);if(!A){var B=y.FullPaths[0];k.slice(0,B.length)==B?B=k:(B.slice(-1)!="/"&&(B+="/"),B=(B+k).replace("//","/")),A={name:i(k),type:2},y.FileIndex.push(A),y.FullPaths.push(B),b||je.utils.cfb_gc(y)}return A.content=S,A.size=S?S.length:0,E&&(E.CLSID&&(A.clsid=E.CLSID),E.mt&&(A.mt=E.mt),E.ct&&(A.ct=E.ct)),A}function G2(y,k){T(y);var S=je.find(y,k);if(S){for(var E=0;E<y.FileIndex.length;++E)if(y.FileIndex[E]==S)return y.FileIndex.splice(E,1),y.FullPaths.splice(E,1),!0}return!1}function K2(y,k,S){T(y);var E=je.find(y,k);if(E){for(var b=0;b<y.FileIndex.length;++b)if(y.FileIndex[b]==E)return y.FileIndex[b].name=i(S),y.FullPaths[b]=S,!0}return!1}function Y2(y){F(y,!0)}return e.find=U,e.read=R,e.parse=c,e.write=he,e.writeFile=Y,e.utils={cfb_new:V2,cfb_add:qc,cfb_del:G2,cfb_mov:K2,cfb_gc:Y2,ReadShift:uo,CheckField:Ay,prep_blob:cr,bconcat:At,use_zlib:C,_deflateRaw:ap,_inflateRaw:fp,consts:_e},e}();function tC(t){return typeof t=="string"?Mc(t):Array.isArray(t)?AO(t):t}function tl(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Mc(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?$o(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([tC(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=el(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function Ft(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Hm(t,e){for(var r=[],n=Ft(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function R0(t){for(var e=[],r=Ft(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Uc(t){for(var e=[],r=Ft(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function rC(t){for(var e=[],r=Ft(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var rc=new Date(1899,11,30,0,0,0);function sr(t,e){var r=t.getTime(),n=rc.getTime()+(t.getTimezoneOffset()-rc.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var cy=new Date,nC=rc.getTime()+(cy.getTimezoneOffset()-rc.getTimezoneOffset())*6e4,Vm=cy.getTimezoneOffset();function hy(t){var e=new Date;return e.setTime(t*24*60*60*1e3+nC),e.getTimezoneOffset()!==Vm&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Vm)*6e4),e}var Gm=new Date("2017-02-19T19:06:09.000Z"),fy=isNaN(Gm.getFullYear())?new Date("2/19/17"):Gm,iC=fy.getFullYear()==2017;function Yt(t,e){var r=new Date(t);if(iC)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(fy.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function $c(t,e){if(Pe&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function ar(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=ar(t[r]));return e}function nt(t,e){for(var r="";r.length<e;)r+=t;return r}function On(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var sC=["january","february","march","april","may","june","july","august","september","october","november","december"];function Uo(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&sC.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}function Se(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Pe?n=Mn(r):n=OO(r),je.utils.cfb_add(t,e,n)}je.utils.cfb_add(t,e,r)}else t.file(e,r)}function F0(){return je.utils.cfb_new()}var ht=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,aC={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},I0=R0(aC),D0=/[&<>'"]/g,oC=/[\u0000-\u0008\u000b-\u001f]/g;function Le(t){var e=t+"";return e.replace(D0,function(r){return I0[r]}).replace(oC,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Km(t){return Le(t).replace(/ /g,"_x0020_")}var dy=/[\u0000-\u001f]/g;function lC(t){var e=t+"";return e.replace(D0,function(r){return I0[r]}).replace(/\n/g,"<br/>").replace(dy,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function uC(t){var e=t+"";return e.replace(D0,function(r){return I0[r]}).replace(dy,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function cC(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function hC(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Mh(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Ym(t){var e=ts(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function Xm(t){return Mn(t,"binary").toString("utf8")}var $l="foo bar baz",lo=Pe&&(Xm($l)==Mh($l)&&Xm||Ym($l)==Mh($l)&&Ym)||Mh,$o=Pe?function(t){return Mn(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},fC=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),py=/(^\s|\s$|\n)/;function Ot(t,e){return"<"+t+(e.match(py)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function zo(t){return Ft(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function te(t,e,r){return"<"+t+(r!=null?zo(r):"")+(e!=null?(e.match(py)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function id(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function dC(t,e){switch(typeof t){case"string":var r=te("vt:lpwstr",Le(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return te((t|0)==t?"vt:i4":"vt:r8",Le(String(t)));case"boolean":return te("vt:bool",t?"true":"false")}if(t instanceof Date)return te("vt:filetime",id(t));throw new Error("Unable to serialize "+t)}var xt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},pa=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],hr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function pC(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function gC(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var qm=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},Jm=Pe?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Mn(e)})):qm(t)}:qm,Qm=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Va(t,i)));return n.join("").replace(oo,"")},N0=Pe?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(oo,""):Qm(t,e,r)}:Qm,Zm=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},gy=Pe?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Zm(t,e,r)}:Zm,e1=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Ss(t,i)));return n.join("")},rl=Pe?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):e1(e,r,n)}:e1,my=function(t,e){var r=fr(t,e);return r>0?rl(t,e+4,e+4+r-1):""},vy=my,xy=function(t,e){var r=fr(t,e);return r>0?rl(t,e+4,e+4+r-1):""},_y=xy,yy=function(t,e){var r=2*fr(t,e);return r>0?rl(t,e+4,e+4+r-1):""},wy=yy,Sy=function(e,r){var n=fr(e,r);return n>0?N0(e,r+4,r+4+n):""},Ey=Sy,Ty=function(t,e){var r=fr(t,e);return r>0?rl(t,e+4,e+4+r):""},ky=Ty,by=function(t,e){return pC(t,e)},nc=by,L0=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Pe&&(vy=function(e,r){if(!Buffer.isBuffer(e))return my(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},_y=function(e,r){if(!Buffer.isBuffer(e))return xy(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},wy=function(e,r){if(!Buffer.isBuffer(e))return yy(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Ey=function(e,r){if(!Buffer.isBuffer(e))return Sy(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},ky=function(e,r){if(!Buffer.isBuffer(e))return Ty(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},nc=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):by(e,r)},L0=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Ss=function(t,e){return t[e]},Va=function(t,e){return t[e+1]*256+t[e]},mC=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},fr=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Li=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},vC=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function uo(t,e){var r="",n,i,s=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,Pe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Va(this,u)),u+=2;t*=2;break;case"utf8":r=rl(this,this.l,this.l+t);break;case"utf16le":t*=2,r=N0(this,this.l,this.l+t);break;case"wstr":return uo.call(this,t,"dbcs");case"lpstr-ansi":r=vy(this,this.l),t=4+fr(this,this.l);break;case"lpstr-cp":r=_y(this,this.l),t=4+fr(this,this.l);break;case"lpwstr":r=wy(this,this.l),t=4+2*fr(this,this.l);break;case"lpp4":t=4+fr(this,this.l),r=Ey(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+fr(this,this.l),r=ky(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Ss(this,this.l+t++))!==0;)s.push(Bl(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=Va(this,this.l+t))!==0;)s.push(Bl(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Ss(this,u),this.l=u+1,o=uo.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Bl(Va(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Ss(this,u),this.l=u+1,o=uo.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Bl(Ss(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=Ss(this,this.l),this.l++,n;case 2:return n=(e==="i"?mC:Va)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Li:vC)(this,this.l),this.l+=4,n):(i=fr(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=nc(this,this.l):i=nc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=gy(this,this.l,t);break}}return this.l+=t,r}var xC=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},_C=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},yC=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function wC(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)yC(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,xC(this,e,this.l);break;case 8:if(n=8,r==="f"){gC(this,e,this.l);break}case 16:break;case-4:n=4,_C(this,e,this.l);break}return this.l+=n,this}function Ay(t,e){var r=gy(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function cr(t,e){t.l=e,t.read_shift=uo,t.chk=Ay,t.write_shift=wC}function pn(t,e){t.l+=e}function V(t){var e=ts(t);return cr(e,0),e}function ir(){var t=[],e=Pe?256:2048,r=function(u){var c=V(u);return cr(c,0),c},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},a=function(){return i(),At(t)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function X(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=pI[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&L0(r)&&t.push(r)}}function co(t,e,r){var n=ar(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function t1(t,e,r){var n=ar(t);return n.s=co(n.s,e.s,r),n.e=co(n.e,e.s,r),n}function ho(t,e){if(t.cRel&&t.c<0)for(t=ar(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=ar(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Be(t);return!t.cRel&&t.cRel!=null&&(r=TC(r)),!t.rRel&&t.rRel!=null&&(r=SC(r)),r}function Bh(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Ut(t.s.c)+":"+(t.e.cRel?"":"$")+Ut(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Pt(t.s.r)+":"+(t.e.rRel?"":"$")+Pt(t.e.r):ho(t.s,e.biff)+":"+ho(t.e,e.biff)}function M0(t){return parseInt(EC(t),10)-1}function Pt(t){return""+(t+1)}function SC(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function EC(t){return t.replace(/\$(\d+)$/,"$1")}function B0(t){for(var e=kC(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Ut(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function TC(t){return t.replace(/^([A-Z])/,"$$$1")}function kC(t){return t.replace(/^\$([A-Z])/,"$1")}function bC(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function _t(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function Be(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function xr(t){var e=t.indexOf(":");return e==-1?{s:_t(t),e:_t(t)}:{s:_t(t.slice(0,e)),e:_t(t.slice(e+1))}}function ct(t,e){return typeof e>"u"||typeof e=="number"?ct(t.s,t.e):(typeof t!="string"&&(t=Be(t)),typeof e!="string"&&(e=Be(e)),t==e?t:t+":"+e)}function Ke(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function r1(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=gi(t.z,r?sr(e):e)}catch{}try{return t.w=gi((t.XF||{}).numFmtId||(r?14:0),r?sr(e):e)}catch{return""+e}}function Nn(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?nl[t.v]||t.v:e==null?r1(t,t.v):r1(t,e))}function as(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Oy(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?_t(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var c=Ke(s["!ref"]);u.s.c=c.s.c,u.s.r=c.s.r,u.e.c=Math.max(u.e.c,c.e.c),u.e.r=Math.max(u.e.r,c.e.r),a==-1&&(u.e.r=a=c.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=e[h].length;++f)if(!(typeof e[h][f]>"u")){var d={v:e[h][f]},g=a+h,p=o+f;if(u.s.r>g&&(u.s.r=g),u.s.c>p&&(u.s.c=p),u.e.r<g&&(u.e.r=g),u.e.c<p&&(u.e.c=p),e[h][f]&&typeof e[h][f]=="object"&&!Array.isArray(e[h][f])&&!(e[h][f]instanceof Date))d=e[h][f];else if(Array.isArray(d.v)&&(d.f=e[h][f][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||it[14],n.cellDates?(d.t="d",d.w=gi(d.z,sr(d.v))):(d.t="n",d.v=sr(d.v),d.w=gi(d.z,d.v))):d.t="s";if(i)s[g]||(s[g]=[]),s[g][p]&&s[g][p].z&&(d.z=s[g][p].z),s[g][p]=d;else{var m=Be({c:p,r:g});s[m]&&s[m].z&&(d.z=s[m].z),s[m]=d}}}return u.s.c<1e7&&(s["!ref"]=ct(u)),s}function ga(t,e){return Oy(null,t,e)}function AC(t){return t.read_shift(4,"i")}function en(t,e){return e||(e=V(4)),e.write_shift(4,t),e}function $t(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function yt(t,e){var r=!1;return e==null&&(r=!0,e=V(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function OC(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function CC(t,e){return e||(e=V(4)),e.write_shift(2,0),e.write_shift(2,0),e}function j0(t,e){var r=t.l,n=t.read_shift(1),i=$t(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(OC(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function PC(t,e){var r=!1;return e==null&&(r=!0,e=V(15+4*t.t.length)),e.write_shift(1,0),yt(t.t,e),r?e.slice(0,e.l):e}var RC=j0;function FC(t,e){var r=!1;return e==null&&(r=!0,e=V(23+4*t.t.length)),e.write_shift(1,1),yt(t.t,e),e.write_shift(4,1),CC({},e),r?e.slice(0,e.l):e}function Lr(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function os(t,e){return e==null&&(e=V(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function ls(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function us(t,e){return e==null&&(e=V(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var IC=$t,Cy=yt;function U0(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function ic(t,e){var r=!1;return e==null&&(r=!0,e=V(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var DC=$t,sd=U0,$0=ic;function Py(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?nc([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Li(e,0)>>2;return r?i/100:i}function Ry(t,e){e==null&&(e=V(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function Fy(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function NC(t,e){return e||(e=V(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var cs=Fy,ma=NC;function va(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function rs(t,e){return(e||V(8)).write_shift(8,t,"f")}function LC(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=VC[i];u&&(e.rgb=d1(u));break;case 2:e.rgb=d1([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function sc(t,e){if(e||(e=V(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function MC(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function BC(t,e){e||(e=V(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}var Iy=2,or=3,zl=11,ac=19,Wl=64,jC=65,UC=71,$C=4108,zC=4126,bt=80,n1={1:{n:"CodePage",t:Iy},2:{n:"Category",t:bt},3:{n:"PresentationFormat",t:bt},4:{n:"ByteCount",t:or},5:{n:"LineCount",t:or},6:{n:"ParagraphCount",t:or},7:{n:"SlideCount",t:or},8:{n:"NoteCount",t:or},9:{n:"HiddenCount",t:or},10:{n:"MultimediaClipCount",t:or},11:{n:"ScaleCrop",t:zl},12:{n:"HeadingPairs",t:$C},13:{n:"TitlesOfParts",t:zC},14:{n:"Manager",t:bt},15:{n:"Company",t:bt},16:{n:"LinksUpToDate",t:zl},17:{n:"CharacterCount",t:or},19:{n:"SharedDoc",t:zl},22:{n:"HyperlinksChanged",t:zl},23:{n:"AppVersion",t:or,p:"version"},24:{n:"DigSig",t:jC},26:{n:"ContentType",t:bt},27:{n:"ContentStatus",t:bt},28:{n:"Language",t:bt},29:{n:"Version",t:bt},255:{},2147483648:{n:"Locale",t:ac},2147483651:{n:"Behavior",t:ac},1919054434:{}},i1={1:{n:"CodePage",t:Iy},2:{n:"Title",t:bt},3:{n:"Subject",t:bt},4:{n:"Author",t:bt},5:{n:"Keywords",t:bt},6:{n:"Comments",t:bt},7:{n:"Template",t:bt},8:{n:"LastAuthor",t:bt},9:{n:"RevNumber",t:bt},10:{n:"EditTime",t:Wl},11:{n:"LastPrinted",t:Wl},12:{n:"CreatedDate",t:Wl},13:{n:"ModifiedDate",t:Wl},14:{n:"PageCount",t:or},15:{n:"WordCount",t:or},16:{n:"CharCount",t:or},17:{n:"Thumbnail",t:UC},18:{n:"Application",t:bt},19:{n:"DocSecurity",t:or},255:{},2147483648:{n:"Locale",t:ac},2147483651:{n:"Behavior",t:ac},1919054434:{}};function WC(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var HC=WC([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),VC=ar(HC),nl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},GC={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Hl={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Dy(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Ny(t,e){var r=rC(GC),n=[],i;n[n.length]=ht,n[n.length]=te("Types",null,{xmlns:xt.CT,"xmlns:xsd":xt.xsd,"xmlns:xsi":xt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return te("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=te("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Hl[l][e.bookType]||Hl[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(u){n[n.length]=te("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Hl[l][e.bookType]||Hl[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(u){n[n.length]=te("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Oe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ly(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Ys(t){var e=[ht,te("Relationships",null,{xmlns:xt.RELS})];return Ft(t["!id"]).forEach(function(r){e[e.length]=te("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function De(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[Oe.HLINK,Oe.XPATH,Oe.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}function KC(t){var e=[ht];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function s1(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function YC(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function XC(t){var e=[ht];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(s1(t[r][0],t[r][1])),e.push(YC("",t[r][0]));return e.push(s1("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function My(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ju.version+"</meta:generator></office:meta></office:document-meta>"}var Yi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function jh(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Le(e),n[n.length]=r?te(t,e,r):Ot(t,e))}function By(t,e){var r=e||{},n=[ht,te("cp:coreProperties",null,{"xmlns:cp":xt.CORE_PROPS,"xmlns:dc":xt.dc,"xmlns:dcterms":xt.dcterms,"xmlns:dcmitype":xt.dcmitype,"xmlns:xsi":xt.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&jh("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:id(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&jh("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:id(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Yi.length;++s){var a=Yi[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&jh(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Xs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],jy=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Uy(t){var e=[],r=te;return t||(t={}),t.Application="SheetJS",e[e.length]=ht,e[e.length]=te("Properties",null,{xmlns:xt.EXT_PROPS,"xmlns:vt":xt.vt}),Xs.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Le(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Le(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function $y(t){var e=[ht,te("Properties",null,{xmlns:xt.CUST_PROPS,"xmlns:vt":xt.vt})];if(!t)return e.join("");var r=1;return Ft(t).forEach(function(i){++r,e[e.length]=te("property",dC(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Le(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var a1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function qC(t,e){var r=[];return Ft(a1).map(function(n){for(var i=0;i<Yi.length;++i)if(Yi[i][1]==n)return Yi[i];for(i=0;i<Xs.length;++i)if(Xs[i][1]==n)return Xs[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Ot(a1[n[1]]||n[1],i))}}),te("DocumentProperties",r.join(""),{xmlns:hr.o})}function JC(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Ft(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<Yi.length;++a)if(s==Yi[a][1])return;for(a=0;a<Xs.length;++a)if(s==Xs[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(te(Km(s),o,{"dt:dt":l}))}}),e&&Ft(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(te(Km(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+hr.o+'">'+i.join("")+"</"+n+">"}function QC(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=V(8);return a.write_shift(4,n),a.write_shift(4,i),a}function o1(t,e){var r=V(4),n=V(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=V(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=QC(e);break;case 31:case 80:for(n=V(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return At([r,n])}var zy=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ZC(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function l1(t,e,r){var n=V(8),i=[],s=[],a=8,o=0,l=V(8),u=V(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!e){u=V(8),u.write_shift(4,0),i.unshift(u);var c=[V(4)];for(c[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(l=V(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);c.push(l)}l=At(c),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(zy.indexOf(t[o][0])>-1||jy.indexOf(t[o][0])>-1)&&t[o][1]!=null){var f=t[o][1],d=0;if(e){d=+e[t[o][0]];var g=r[d];if(g.p=="version"&&typeof f=="string"){var p=f.split(".");f=(+p[0]<<16)+(+p[1]||0)}l=o1(g.t,f)}else{var m=ZC(f);m==-1&&(m=31,f=String(f)),l=o1(m,f)}s.push(l),u=V(8),u.write_shift(4,e?d:2+o),i.push(u),a+=8+l.length}var v=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,v),v+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),At([n].concat(i).concat(s))}function u1(t,e,r,n,i,s){var a=V(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,je.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=l1(t,r,n);if(o.push(l),i){var u=l1(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return At(o)}function e4(t,e){e||(e=V(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function t4(t,e){return t.read_shift(e)===1}function Vt(t,e){return e||(e=V(2)),e.write_shift(2,+!!t),e}function Wy(t){return t.read_shift(2,"u")}function kr(t,e){return e||(e=V(2)),e.write_shift(2,t),e}function Hy(t,e,r){return r||(r=V(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Vy(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function r4(t){var e=t.t||"",r=V(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=V(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return At(i)}function n4(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function i4(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):n4(t,n,r)}function s4(t,e,r){if(r.biff>5)return i4(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function Gy(t,e,r){return r||(r=V(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function c1(t,e){e||(e=V(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function a4(t){var e=V(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),c1(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&c1(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function ns(t,e,r,n){return n||(n=V(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function o4(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function l4(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function Ky(t,e){return e||(e=V(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function z0(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=V(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function u4(t,e){var r=!e||e.biff==8,n=V(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function c4(t,e){var r=!e||e.biff>=8?2:1,n=V(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function h4(t,e){var r=V(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=r4(t[i]);var s=At([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function f4(){var t=V(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function d4(t){var e=V(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function p4(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=V(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function g4(t,e,r,n){var i=V(10);return ns(t,e,n,i),i.write_shift(4,r),i}function m4(t,e,r,n,i){var s=!i||i.biff==8,a=V(8+ +s+(1+s)*r.length);return ns(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function v4(t,e,r,n){var i=r&&r.biff==5;n||(n=V(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function x4(t,e){var r=e.biff==8||!e.biff?4:2,n=V(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function h1(t,e,r,n){var i=r&&r.biff==5;n||(n=V(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function _4(t){var e=V(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function y4(t,e,r,n,i,s){var a=V(8);return ns(t,e,n,a),Hy(r,s,a),a}function w4(t,e,r,n){var i=V(14);return ns(t,e,n,i),rs(r,i),i}function S4(t,e,r){if(r.biff<8)return E4(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(o4(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function E4(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Vy(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function T4(t){var e=V(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)Ky(t[r],e);return e}function k4(t){var e=V(24),r=_t(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return At([e,a4(t[1])])}function b4(t){var e=t[1].Tooltip,r=V(10+2*(e.length+1));r.write_shift(2,2048);var n=_t(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function A4(t){return t||(t=V(4)),t.write_shift(2,1),t.write_shift(2,1),t}function O4(t,e,r){if(!r.cellStyles)return pn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function C4(t,e){var r=V(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function P4(t){for(var e=V(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}function R4(t,e,r){var n=V(15);return sl(n,t,e),n.write_shift(8,r,"f"),n}function F4(t,e,r){var n=V(9);return sl(n,t,e),n.write_shift(2,r),n}var I4=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=R0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],c=ts(1);switch(l.type){case"base64":c=Yr(Dn(o));break;case"binary":c=Yr(o);break;case"buffer":case"array":c=o;break}cr(c,0);var h=c.read_shift(1),f=!!(h&136),d=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,f=!0;break;case 49:d=!0,f=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var p=0,m=521;h==2&&(p=c.read_shift(2)),c.l+=3,h!=2&&(p=c.read_shift(4)),p>1048576&&(p=1e6),h!=2&&(m=c.read_shift(2));var v=c.read_shift(2),x=l.codepage||1252;h!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(x=t[c[c.l]]),c.l+=1,c.l+=2),g&&(c.l+=36);for(var _=[],w={},O=Math.min(c.length,h==2?521:m-10-(d?264:0)),R=g?32:11;c.l<O&&c[c.l]!=13;)switch(w={},w.name=Qu.utils.decode(x,c.slice(c.l,c.l+R)).replace(/[\u0000\r\n].*$/g,""),c.l+=R,w.type=String.fromCharCode(c.read_shift(1)),h!=2&&!g&&(w.offset=c.read_shift(4)),w.len=c.read_shift(1),h==2&&(w.offset=c.read_shift(2)),w.dec=c.read_shift(1),w.name.length&&_.push(w),h!=2&&(c.l+=g?13:14),w.type){case"B":(!d||w.len!=8)&&l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(c[c.l]!==13&&(c.l=m-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=m;var T=0,P=0;for(u[0]=[],P=0;P!=_.length;++P)u[0][P]=_[P].name;for(;p-- >0;){if(c[c.l]===42){c.l+=v;continue}for(++c.l,u[++T]=[],P=0,P=0;P!=_.length;++P){var F=c.slice(c.l,c.l+_[P].len);c.l+=_[P].len,cr(F,0);var N=Qu.utils.decode(x,F);switch(_[P].type){case"C":N.trim().length&&(u[T][P]=N.replace(/\s+$/,""));break;case"D":N.length===8?u[T][P]=new Date(+N.slice(0,4),+N.slice(4,6)-1,+N.slice(6,8)):u[T][P]=N;break;case"F":u[T][P]=parseFloat(N.trim());break;case"+":case"I":u[T][P]=g?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(N.trim().toUpperCase()){case"Y":case"T":u[T][P]=!0;break;case"N":case"F":u[T][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+N+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[T][P]="##MEMO##"+(g?parseInt(N.trim(),10):F.read_shift(4));break;case"N":N=N.replace(/\u0000/g,"").trim(),N&&N!="."&&(u[T][P]=+N||0);break;case"@":u[T][P]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":u[T][P]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":u[T][P]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[T][P]=-F.read_shift(-8,"f");break;case"B":if(d&&_[P].len==8){u[T][P]=F.read_shift(8,"f");break}case"G":case"P":F.l+=_[P].len;break;case"0":if(_[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[P].type)}}}if(h!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=_,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var c=ga(r(o,u),u);return c["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,c}function i(o,l){try{return as(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&Bo(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var c=ir(),h=hc(o,{header:1,raw:!0,cellDates:!0}),f=h[0],d=h.slice(1),g=o["!cols"]||[],p=0,m=0,v=0,x=1;for(p=0;p<f.length;++p){if(((g[p]||{}).DBF||{}).name){f[p]=g[p].DBF.name,++v;continue}if(f[p]!=null){if(++v,typeof f[p]=="number"&&(f[p]=f[p].toString(10)),typeof f[p]!="string")throw new Error("DBF Invalid column name "+f[p]+" |"+typeof f[p]+"|");if(f.indexOf(f[p])!==p){for(m=0;m<1024;++m)if(f.indexOf(f[p]+"_"+m)==-1){f[p]+="_"+m;break}}}}var _=Ke(o["!ref"]),w=[],O=[],R=[];for(p=0;p<=_.e.c-_.s.c;++p){var T="",P="",F=0,N=[];for(m=0;m<d.length;++m)d[m][p]!=null&&N.push(d[m][p]);if(N.length==0||f[p]==null){w[p]="?";continue}for(m=0;m<N.length;++m){switch(typeof N[m]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=N[m]instanceof Date?"D":"C";break;default:P="C"}F=Math.max(F,String(N[m]).length),T=T&&T!=P?"C":P}F>250&&(F=250),P=((g[p]||{}).DBF||{}).type,P=="C"&&g[p].DBF.len>F&&(F=g[p].DBF.len),T=="B"&&P=="N"&&(T="N",R[p]=g[p].DBF.dec,F=g[p].DBF.len),O[p]=T=="C"||P=="N"?F:s[T]||0,x+=O[p],w[p]=T}var U=c.next(32);for(U.write_shift(4,318902576),U.write_shift(4,d.length),U.write_shift(2,296+32*v),U.write_shift(2,x),p=0;p<4;++p)U.write_shift(4,0);for(U.write_shift(4,0|(+e[X_]||3)<<8),p=0,m=0;p<f.length;++p)if(f[p]!=null){var H=c.next(32),Z=(f[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);H.write_shift(1,Z,"sbcs"),H.write_shift(1,w[p]=="?"?"C":w[p],"sbcs"),H.write_shift(4,m),H.write_shift(1,O[p]||s[w[p]]||0),H.write_shift(1,R[p]||0),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(1,0),H.write_shift(4,0),H.write_shift(4,0),m+=O[p]||s[w[p]]||0}var ve=c.next(264);for(ve.write_shift(4,13),p=0;p<65;++p)ve.write_shift(4,0);for(p=0;p<d.length;++p){var oe=c.next(x);for(oe.write_shift(1,0),m=0;m<f.length;++m)if(f[m]!=null)switch(w[m]){case"L":oe.write_shift(1,d[p][m]==null?63:d[p][m]?84:70);break;case"B":oe.write_shift(8,d[p][m]||0,"f");break;case"N":var we="0";for(typeof d[p][m]=="number"&&(we=d[p][m].toFixed(R[m]||0)),v=0;v<O[m]-we.length;++v)oe.write_shift(1,32);oe.write_shift(1,we,"sbcs");break;case"D":d[p][m]?(oe.write_shift(4,("0000"+d[p][m].getFullYear()).slice(-4),"sbcs"),oe.write_shift(2,("00"+(d[p][m].getMonth()+1)).slice(-2),"sbcs"),oe.write_shift(2,("00"+d[p][m].getDate()).slice(-2),"sbcs")):oe.write_shift(8,"00000000","sbcs");break;case"C":var _e=String(d[p][m]!=null?d[p][m]:"").slice(0,O[m]);for(oe.write_shift(1,_e,"sbcs"),v=0;v<O[m]-_e.length;++v)oe.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),D4=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ft(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,d){var g=t[d];return typeof g=="number"?Nm(g):g},n=function(f,d,g){var p=d.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?f:Nm(p)};t["|"]=254;function i(f,d){switch(d.type){case"base64":return s(Dn(f),d);case"binary":return s(f,d);case"buffer":return s(Pe&&Buffer.isBuffer(f)?f.toString("binary"):el(f),d);case"array":return s($c(f),d)}throw new Error("Unrecognized type "+d.type)}function s(f,d){var g=f.split(/[\n\r]+/),p=-1,m=-1,v=0,x=0,_=[],w=[],O=null,R={},T=[],P=[],F=[],N=0,U;for(+d.codepage>=0&&Bo(+d.codepage);v!==g.length;++v){N=0;var H=g[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),Z=H.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),ve=Z[0],oe;if(H.length>0)switch(ve){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Z[1].charAt(0)=="P"&&w.push(H.slice(3).replace(/;;/g,";"));break;case"C":var we=!1,_e=!1,Y=!1,q=!1,he=-1,xe=-1;for(x=1;x<Z.length;++x)switch(Z[x].charAt(0)){case"A":break;case"X":m=parseInt(Z[x].slice(1))-1,_e=!0;break;case"Y":for(p=parseInt(Z[x].slice(1))-1,_e||(m=0),U=_.length;U<=p;++U)_[U]=[];break;case"K":oe=Z[x].slice(1),oe.charAt(0)==='"'?oe=oe.slice(1,oe.length-1):oe==="TRUE"?oe=!0:oe==="FALSE"?oe=!1:isNaN(On(oe))?isNaN(Uo(oe).getDate())||(oe=Yt(oe)):(oe=On(oe),O!==null&&oy(O)&&(oe=hy(oe))),we=!0;break;case"E":q=!0;var C=FP(Z[x].slice(1),{r:p,c:m});_[p][m]=[_[p][m],C];break;case"S":Y=!0,_[p][m]=[_[p][m],"S5S"];break;case"G":break;case"R":he=parseInt(Z[x].slice(1))-1;break;case"C":xe=parseInt(Z[x].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+H)}if(we&&(_[p][m]&&_[p][m].length==2?_[p][m][0]=oe:_[p][m]=oe,O=null),Y){if(q)throw new Error("SYLK shared formula cannot have own formula");var L=he>-1&&_[he][xe];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");_[p][m][1]=IP(L[1],{r:p-he,c:m-xe})}break;case"F":var I=0;for(x=1;x<Z.length;++x)switch(Z[x].charAt(0)){case"X":m=parseInt(Z[x].slice(1))-1,++I;break;case"Y":for(p=parseInt(Z[x].slice(1))-1,U=_.length;U<=p;++U)_[U]=[];break;case"M":N=parseInt(Z[x].slice(1))/20;break;case"F":break;case"G":break;case"P":O=w[parseInt(Z[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=Z[x].slice(1).split(" "),U=parseInt(F[0],10);U<=parseInt(F[1],10);++U)N=parseInt(F[2],10),P[U-1]=N===0?{hidden:!0}:{wch:N},W0(P[U-1]);break;case"C":m=parseInt(Z[x].slice(1))-1,P[m]||(P[m]={});break;case"R":p=parseInt(Z[x].slice(1))-1,T[p]||(T[p]={}),N>0?(T[p].hpt=N,T[p].hpx=Qy(N)):N===0&&(T[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+H)}I<1&&(O=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+H)}}return T.length>0&&(R["!rows"]=T),P.length>0&&(R["!cols"]=P),d&&d.sheetRows&&(_=_.slice(0,d.sheetRows)),[_,R]}function a(f,d){var g=i(f,d),p=g[0],m=g[1],v=ga(p,d);return Ft(m).forEach(function(x){v[x]=m[x]}),v}function o(f,d){return as(a(f,d),d)}function l(f,d,g,p){var m="C;Y"+(g+1)+";X"+(p+1)+";K";switch(f.t){case"n":m+=f.v||0,f.f&&!f.F&&(m+=";E"+V0(f.f,{r:g,c:p}));break;case"b":m+=f.v?"TRUE":"FALSE";break;case"e":m+=f.w||f.v;break;case"d":m+='"'+(f.w||f.v)+'"';break;case"s":m+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function u(f,d){d.forEach(function(g,p){var m="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?m+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=oc(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=lc(g.wpx)),typeof g.wch=="number"&&(m+=Math.round(g.wch))),m.charAt(m.length-1)!=" "&&f.push(m)})}function c(f,d){d.forEach(function(g,p){var m="F;";g.hidden?m+="M0;":g.hpt?m+="M"+20*g.hpt+";":g.hpx&&(m+="M"+20*uc(g.hpx)+";"),m.length>2&&f.push(m+"R"+(p+1))})}function h(f,d){var g=["ID;PWXL;N;E"],p=[],m=Ke(f["!ref"]),v,x=Array.isArray(f),_=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),f["!cols"]&&u(g,f["!cols"]),f["!rows"]&&c(g,f["!rows"]),g.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var w=m.s.r;w<=m.e.r;++w)for(var O=m.s.c;O<=m.e.c;++O){var R=Be({r:w,c:O});v=x?(f[w]||[])[O]:f[R],!(!v||v.v==null&&(!v.f||v.F))&&p.push(l(v,f,w,O))}return g.join(_)+_+p.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),N4=function(){function t(s,a){switch(a.type){case"base64":return e(Dn(s),a);case"binary":return e(s,a);case"buffer":return e(Pe&&Buffer.isBuffer(s)?s.toString("binary"):el(s),a);case"array":return e($c(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,u=-1,c=0,h=[];c!==o.length;++c){if(o[c].trim()==="BOT"){h[++l]=[],u=0;continue}if(!(l<0)){var f=o[c].trim().split(","),d=f[0],g=f[1];++c;for(var p=o[c]||"";(p.match(/["]/g)||[]).length&1&&c<o.length-1;)p+=`
`+o[++c];switch(p=p.trim(),+d){case-1:if(p==="BOT"){h[++l]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?h[l][u]=!0:p==="FALSE"?h[l][u]=!1:isNaN(On(g))?isNaN(Uo(g).getDate())?h[l][u]=g:h[l][u]=Yt(g):h[l][u]=On(g),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),h[l][u++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return ga(t(s,a),a)}function n(s,a){return as(r(s,a),a)}var i=function(){var s=function(l,u,c,h,f){l.push(u),l.push(c+","+h),l.push('"'+f.replace(/"/g,'""')+'"')},a=function(l,u,c,h){l.push(u+","+c),l.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var u=[],c=Ke(l["!ref"]),h,f=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,c.e.r-c.s.r+1,""),s(u,"TUPLES",0,c.e.c-c.s.c+1,""),s(u,"DATA",0,0,"");for(var d=c.s.r;d<=c.e.r;++d){a(u,-1,0,"BOT");for(var g=c.s.c;g<=c.e.c;++g){var p=Be({r:d,c:g});if(h=f?(l[d]||[])[g]:l[p],!h){a(u,1,0,"");continue}switch(h.t){case"n":var m=h.w;!m&&h.v!=null&&(m=h.v),m==null?h.f&&!h.F?a(u,1,0,"="+h.f):a(u,1,0,""):a(u,0,m,"V");break;case"b":a(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=gi(h.z||it[14],sr(Yt(h.v)))),a(u,0,h.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var v=`\r
`,x=u.join(v);return x}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),Yy=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,f){for(var d=h.split(`
`),g=-1,p=-1,m=0,v=[];m!==d.length;++m){var x=d[m].trim().split(":");if(x[0]==="cell"){var _=_t(x[1]);if(v.length<=_.r)for(g=v.length;g<=_.r;++g)v[g]||(v[g]=[]);switch(g=_.r,p=_.c,x[2]){case"t":v[g][p]=t(x[3]);break;case"v":v[g][p]=+x[3];break;case"vtf":var w=x[x.length-1];case"vtc":switch(x[3]){case"nl":v[g][p]=!!+x[4];break;default:v[g][p]=+x[4];break}x[2]=="vtf"&&(v[g][p]=[v[g][p],w])}}}return f&&f.sheetRows&&(v=v.slice(0,f.sheetRows)),v}function n(h,f){return ga(r(h,f),f)}function i(h,f){return as(n(h,f),f)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var f=[],d=[],g,p="",m=xr(h["!ref"]),v=Array.isArray(h),x=m.s.r;x<=m.e.r;++x)for(var _=m.s.c;_<=m.e.c;++_)if(p=Be({r:x,c:_}),g=v?(h[x]||[])[_]:h[p],!(!g||g.v==null||g.t==="z")){switch(d=["cell",p,"t"],g.t){case"s":case"str":d.push(e(g.v));break;case"n":g.f?(d[2]="vtf",d[3]="n",d[4]=g.v,d[5]=e(g.f)):(d[2]="v",d[3]=g.v);break;case"b":d[2]="vt"+(g.f?"f":"c"),d[3]="nl",d[4]=g.v?"1":"0",d[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var w=sr(Yt(g.v));d[2]="vtc",d[3]="nd",d[4]=""+w,d[5]=g.w||gi(g.z||it[14],w);break;case"e":continue}f.push(d.join(":"))}return f.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function c(h){return[s,a,o,a,u(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:c}}(),L4=function(){function t(c,h,f,d,g){g.raw?h[f][d]=c:c===""||(c==="TRUE"?h[f][d]=!0:c==="FALSE"?h[f][d]=!1:isNaN(On(c))?isNaN(Uo(c).getDate())?h[f][d]=c:h[f][d]=Yt(c):h[f][d]=On(c))}function e(c,h){var f=h||{},d=[];if(!c||c.length===0)return d;for(var g=c.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var m=10,v=0,x=0;x<=p;++x)v=g[x].indexOf(" "),v==-1?v=g[x].length:v++,m=Math.max(m,v);for(x=0;x<=p;++x){d[x]=[];var _=0;for(t(g[x].slice(0,m).trim(),d,x,_,f),_=1;_<=(g[x].length-m)/10+1;++_)t(g[x].slice(m+(_-1)*10,m+_*10).trim(),d,x,_,f)}return f.sheetRows&&(d=d.slice(0,f.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(c){for(var h={},f=!1,d=0,g=0;d<c.length;++d)(g=c.charCodeAt(d))==34?f=!f:!f&&g in r&&(h[g]=(h[g]||0)+1);g=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&g.push([h[d],d]);if(!g.length){h=n;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&g.push([h[d],d])}return g.sort(function(p,m){return p[0]-m[0]||n[p[1]]-n[m[1]]}),r[g.pop()[1]]||44}function s(c,h){var f=h||{},d="",g=f.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(d=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(d=c.charAt(4),c=c.slice(6)):d=i(c.slice(0,1024)):f&&f.FS?d=f.FS:d=i(c.slice(0,1024));var m=0,v=0,x=0,_=0,w=0,O=d.charCodeAt(0),R=!1,T=0,P=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var F=f.dateNF!=null?QO(f.dateNF):null;function N(){var U=c.slice(_,w),H={};if(U.charAt(0)=='"'&&U.charAt(U.length-1)=='"'&&(U=U.slice(1,-1).replace(/""/g,'"')),U.length===0)H.t="z";else if(f.raw)H.t="s",H.v=U;else if(U.trim().length===0)H.t="s",H.v=U;else if(U.charCodeAt(0)==61)U.charCodeAt(1)==34&&U.charCodeAt(U.length-1)==34?(H.t="s",H.v=U.slice(2,-1).replace(/""/g,'"')):DP(U)?(H.t="n",H.f=U.slice(1)):(H.t="s",H.v=U);else if(U=="TRUE")H.t="b",H.v=!0;else if(U=="FALSE")H.t="b",H.v=!1;else if(!isNaN(x=On(U)))H.t="n",f.cellText!==!1&&(H.w=U),H.v=x;else if(!isNaN(Uo(U).getDate())||F&&U.match(F)){H.z=f.dateNF||it[14];var Z=0;F&&U.match(F)&&(U=ZO(U,f.dateNF,U.match(F)||[]),Z=1),f.cellDates?(H.t="d",H.v=Yt(U,Z)):(H.t="n",H.v=sr(Yt(U,Z))),f.cellText!==!1&&(H.w=gi(H.z,H.v instanceof Date?sr(H.v):H.v)),f.cellNF||delete H.z}else H.t="s",H.v=U;if(H.t=="z"||(f.dense?(g[m]||(g[m]=[]),g[m][v]=H):g[Be({c:v,r:m})]=H),_=w+1,P=c.charCodeAt(_),p.e.c<v&&(p.e.c=v),p.e.r<m&&(p.e.r=m),T==O)++v;else if(v=0,++m,f.sheetRows&&f.sheetRows<=m)return!0}e:for(;w<c.length;++w)switch(T=c.charCodeAt(w)){case 34:P===34&&(R=!R);break;case O:case 10:case 13:if(!R&&N())break e;break}return w-_>0&&N(),g["!ref"]=ct(p),g}function a(c,h){return!(h&&h.PRN)||h.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?s(c,h):ga(e(c,h),h)}function o(c,h){var f="",d=h.type=="string"?[0,0,0,0]:YI(c,h);switch(h.type){case"base64":f=Dn(c);break;case"binary":f=c;break;case"buffer":h.codepage==65001?f=c.toString("utf8"):h.codepage&&typeof Qu<"u"||(f=Pe&&Buffer.isBuffer(c)?c.toString("binary"):el(c));break;case"array":f=$c(c);break;case"string":f=c;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?f=lo(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=lo(f):h.type=="binary"&&typeof Qu<"u",f.slice(0,19)=="socialcalc:version:"?Yy.to_sheet(h.type=="string"?f:lo(f),h):a(f,h)}function l(c,h){return as(o(c,h),h)}function u(c){for(var h=[],f=Ke(c["!ref"]),d,g=Array.isArray(c),p=f.s.r;p<=f.e.r;++p){for(var m=[],v=f.s.c;v<=f.e.c;++v){var x=Be({r:p,c:v});if(d=g?(c[p]||[])[v]:c[x],!d||d.v==null){m.push("          ");continue}for(var _=(d.w||(Nn(d),d.w)||"").slice(0,10);_.length<10;)_+=" ";m.push(_+(v===0?" ":""))}h.push(m.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}(),f1=function(){function t(C,L,I){if(C){cr(C,C.l||0);for(var D=I.Enum||he;C.l<C.length;){var G=C.read_shift(2),le=D[G]||D[65535],ae=C.read_shift(2),fe=C.l+ae,ie=le.f&&le.f(C,ae,I);if(C.l=fe,L(ie,le,G))return}}}function e(C,L){switch(L.type){case"base64":return r(Yr(Dn(C)),L);case"binary":return r(Yr(C),L);case"buffer":case"array":return r(C,L)}throw"Unsupported type "+L.type}function r(C,L){if(!C)return C;var I=L||{},D=I.dense?[]:{},G="Sheet1",le="",ae=0,fe={},ie=[],Fe=[],Te={s:{r:0,c:0},e:{r:0,c:0}},St=I.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)I.Enum=he,t(C,function(de,wr,gn){switch(gn){case 0:I.vers=de,de>=4096&&(I.qpro=!0);break;case 6:Te=de;break;case 204:de&&(le=de);break;case 222:le=de;break;case 15:case 51:I.qpro||(de[1].v=de[1].v.slice(1));case 13:case 14:case 16:gn==14&&(de[2]&112)==112&&(de[2]&15)>1&&(de[2]&15)<15&&(de[1].z=I.dateNF||it[14],I.cellDates&&(de[1].t="d",de[1].v=hy(de[1].v))),I.qpro&&de[3]>ae&&(D["!ref"]=ct(Te),fe[G]=D,ie.push(G),D=I.dense?[]:{},Te={s:{r:0,c:0},e:{r:0,c:0}},ae=de[3],G=le||"Sheet"+(ae+1),le="");var Ei=I.dense?(D[de[0].r]||[])[de[0].c]:D[Be(de[0])];if(Ei){Ei.t=de[1].t,Ei.v=de[1].v,de[1].z!=null&&(Ei.z=de[1].z),de[1].f!=null&&(Ei.f=de[1].f);break}I.dense?(D[de[0].r]||(D[de[0].r]=[]),D[de[0].r][de[0].c]=de[1]):D[Be(de[0])]=de[1];break}},I);else if(C[2]==26||C[2]==14)I.Enum=xe,C[2]==14&&(I.qpro=!0,C.l=0),t(C,function(de,wr,gn){switch(gn){case 204:G=de;break;case 22:de[1].v=de[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(de[3]>ae&&(D["!ref"]=ct(Te),fe[G]=D,ie.push(G),D=I.dense?[]:{},Te={s:{r:0,c:0},e:{r:0,c:0}},ae=de[3],G="Sheet"+(ae+1)),St>0&&de[0].r>=St)break;I.dense?(D[de[0].r]||(D[de[0].r]=[]),D[de[0].r][de[0].c]=de[1]):D[Be(de[0])]=de[1],Te.e.c<de[0].c&&(Te.e.c=de[0].c),Te.e.r<de[0].r&&(Te.e.r=de[0].r);break;case 27:de[14e3]&&(Fe[de[14e3][0]]=de[14e3][1]);break;case 1537:Fe[de[0]]=de[1],de[0]==ae&&(G=de[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(D["!ref"]=ct(Te),fe[le||G]=D,ie.push(le||G),!Fe.length)return{SheetNames:ie,Sheets:fe};for(var Ae={},Mr=[],Ye=0;Ye<Fe.length;++Ye)fe[ie[Ye]]?(Mr.push(Fe[Ye]||ie[Ye]),Ae[Fe[Ye]]=fe[Fe[Ye]]||fe[ie[Ye]]):(Mr.push(Fe[Ye]),Ae[Fe[Ye]]={"!ref":"A1"});return{SheetNames:Mr,Sheets:Ae}}function n(C,L){var I=L||{};if(+I.codepage>=0&&Bo(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var D=ir(),G=Ke(C["!ref"]),le=Array.isArray(C),ae=[];re(D,0,s(1030)),re(D,6,l(G));for(var fe=Math.min(G.e.r,8191),ie=G.s.r;ie<=fe;++ie)for(var Fe=Pt(ie),Te=G.s.c;Te<=G.e.c;++Te){ie===G.s.r&&(ae[Te]=Ut(Te));var St=ae[Te]+Fe,Ae=le?(C[ie]||[])[Te]:C[St];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")(Ae.v|0)==Ae.v&&Ae.v>=-32768&&Ae.v<=32767?re(D,13,d(ie,Te,Ae.v)):re(D,14,p(ie,Te,Ae.v));else{var Mr=Nn(Ae);re(D,15,h(ie,Te,Mr.slice(0,239)))}}return re(D,1),D.end()}function i(C,L){var I=L||{};if(+I.codepage>=0&&Bo(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var D=ir();re(D,0,a(C));for(var G=0,le=0;G<C.SheetNames.length;++G)(C.Sheets[C.SheetNames[G]]||{})["!ref"]&&re(D,27,q(C.SheetNames[G],le++));var ae=0;for(G=0;G<C.SheetNames.length;++G){var fe=C.Sheets[C.SheetNames[G]];if(!(!fe||!fe["!ref"])){for(var ie=Ke(fe["!ref"]),Fe=Array.isArray(fe),Te=[],St=Math.min(ie.e.r,8191),Ae=ie.s.r;Ae<=St;++Ae)for(var Mr=Pt(Ae),Ye=ie.s.c;Ye<=ie.e.c;++Ye){Ae===ie.s.r&&(Te[Ye]=Ut(Ye));var de=Te[Ye]+Mr,wr=Fe?(fe[Ae]||[])[Ye]:fe[de];if(!(!wr||wr.t=="z"))if(wr.t=="n")re(D,23,N(Ae,Ye,ae,wr.v));else{var gn=Nn(wr);re(D,22,T(Ae,Ye,ae,gn.slice(0,239)))}}++ae}}return re(D,1),D.end()}function s(C){var L=V(2);return L.write_shift(2,C),L}function a(C){var L=V(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var I=0,D=0,G=0,le=0;le<C.SheetNames.length;++le){var ae=C.SheetNames[le],fe=C.Sheets[ae];if(!(!fe||!fe["!ref"])){++G;var ie=xr(fe["!ref"]);I<ie.e.r&&(I=ie.e.r),D<ie.e.c&&(D=ie.e.c)}}return I>8191&&(I=8191),L.write_shift(2,I),L.write_shift(1,G),L.write_shift(1,D),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function o(C,L,I){var D={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&I.qpro?(D.s.c=C.read_shift(1),C.l++,D.s.r=C.read_shift(2),D.e.c=C.read_shift(1),C.l++,D.e.r=C.read_shift(2),D):(D.s.c=C.read_shift(2),D.s.r=C.read_shift(2),L==12&&I.qpro&&(C.l+=2),D.e.c=C.read_shift(2),D.e.r=C.read_shift(2),L==12&&I.qpro&&(C.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function l(C){var L=V(8);return L.write_shift(2,C.s.c),L.write_shift(2,C.s.r),L.write_shift(2,C.e.c),L.write_shift(2,C.e.r),L}function u(C,L,I){var D=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(D[0].c=C.read_shift(1),D[3]=C.read_shift(1),D[0].r=C.read_shift(2),C.l+=2):(D[2]=C.read_shift(1),D[0].c=C.read_shift(2),D[0].r=C.read_shift(2)),D}function c(C,L,I){var D=C.l+L,G=u(C,L,I);if(G[1].t="s",I.vers==20768){C.l++;var le=C.read_shift(1);return G[1].v=C.read_shift(le,"utf8"),G}return I.qpro&&C.l++,G[1].v=C.read_shift(D-C.l,"cstr"),G}function h(C,L,I){var D=V(7+I.length);D.write_shift(1,255),D.write_shift(2,L),D.write_shift(2,C),D.write_shift(1,39);for(var G=0;G<D.length;++G){var le=I.charCodeAt(G);D.write_shift(1,le>=128?95:le)}return D.write_shift(1,0),D}function f(C,L,I){var D=u(C,L,I);return D[1].v=C.read_shift(2,"i"),D}function d(C,L,I){var D=V(7);return D.write_shift(1,255),D.write_shift(2,L),D.write_shift(2,C),D.write_shift(2,I,"i"),D}function g(C,L,I){var D=u(C,L,I);return D[1].v=C.read_shift(8,"f"),D}function p(C,L,I){var D=V(13);return D.write_shift(1,255),D.write_shift(2,L),D.write_shift(2,C),D.write_shift(8,I,"f"),D}function m(C,L,I){var D=C.l+L,G=u(C,L,I);if(G[1].v=C.read_shift(8,"f"),I.qpro)C.l=D;else{var le=C.read_shift(2);w(C.slice(C.l,C.l+le),G),C.l+=le}return G}function v(C,L,I){var D=L&32768;return L&=-32769,L=(D?C:0)+(L>=8192?L-16384:L),(D?"":"$")+(I?Ut(L):Pt(L))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(C,L){cr(C,0);for(var I=[],D=0,G="",le="",ae="",fe="";C.l<C.length;){var ie=C[C.l++];switch(ie){case 0:I.push(C.read_shift(8,"f"));break;case 1:le=v(L[0].c,C.read_shift(2),!0),G=v(L[0].r,C.read_shift(2),!1),I.push(le+G);break;case 2:{var Fe=v(L[0].c,C.read_shift(2),!0),Te=v(L[0].r,C.read_shift(2),!1);le=v(L[0].c,C.read_shift(2),!0),G=v(L[0].r,C.read_shift(2),!1),I.push(Fe+Te+":"+le+G)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(C.read_shift(2));break;case 6:{for(var St="";ie=C[C.l++];)St+=String.fromCharCode(ie);I.push('"'+St.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:fe=I.pop(),ae=I.pop(),I.push(["AND","OR"][ie-20]+"("+ae+","+fe+")");break;default:if(ie<32&&_[ie])fe=I.pop(),ae=I.pop(),I.push(ae+_[ie]+fe);else if(x[ie]){if(D=x[ie][1],D==69&&(D=C[C.l++]),D>I.length){console.error("WK1 bad formula parse 0x"+ie.toString(16)+":|"+I.join("|")+"|");return}var Ae=I.slice(-D);I.length-=D,I.push(x[ie][0]+"("+Ae.join(",")+")")}else return ie<=7?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=24?console.error("WK1 unsupported op "+ie.toString(16)):ie<=30?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=115?console.error("WK1 unsupported function opcode "+ie.toString(16)):console.error("WK1 unrecognized opcode "+ie.toString(16))}}I.length==1?L[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function O(C){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=C.read_shift(2),L[3]=C[C.l++],L[0].c=C[C.l++],L}function R(C,L){var I=O(C);return I[1].t="s",I[1].v=C.read_shift(L-4,"cstr"),I}function T(C,L,I,D){var G=V(6+D.length);G.write_shift(2,C),G.write_shift(1,I),G.write_shift(1,L),G.write_shift(1,39);for(var le=0;le<D.length;++le){var ae=D.charCodeAt(le);G.write_shift(1,ae>=128?95:ae)}return G.write_shift(1,0),G}function P(C,L){var I=O(C);I[1].v=C.read_shift(2);var D=I[1].v>>1;if(I[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return I[1].v=D,I}function F(C,L){var I=O(C),D=C.read_shift(4),G=C.read_shift(4),le=C.read_shift(2);if(le==65535)return D===0&&G===3221225472?(I[1].t="e",I[1].v=15):D===0&&G===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var ae=le&32768;return le=(le&32767)-16446,I[1].v=(1-ae*2)*(G*Math.pow(2,le+32)+D*Math.pow(2,le)),I}function N(C,L,I,D){var G=V(14);if(G.write_shift(2,C),G.write_shift(1,I),G.write_shift(1,L),D==0)return G.write_shift(4,0),G.write_shift(4,0),G.write_shift(2,65535),G;var le=0,ae=0,fe=0,ie=0;return D<0&&(le=1,D=-D),ae=Math.log2(D)|0,D/=Math.pow(2,ae-31),ie=D>>>0,ie&2147483648||(D/=2,++ae,ie=D>>>0),D-=ie,ie|=2147483648,ie>>>=0,D*=Math.pow(2,32),fe=D>>>0,G.write_shift(4,fe),G.write_shift(4,ie),ae+=16383+(le?32768:0),G.write_shift(2,ae),G}function U(C,L){var I=F(C);return C.l+=L-14,I}function H(C,L){var I=O(C),D=C.read_shift(4);return I[1].v=D>>6,I}function Z(C,L){var I=O(C),D=C.read_shift(8,"f");return I[1].v=D,I}function ve(C,L){var I=Z(C);return C.l+=L-10,I}function oe(C,L){return C[C.l+L-1]==0?C.read_shift(L,"cstr"):""}function we(C,L){var I=C[C.l++];I>L-1&&(I=L-1);for(var D="";D.length<I;)D+=String.fromCharCode(C[C.l++]);return D}function _e(C,L,I){if(!(!I.qpro||L<21)){var D=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var G=C.read_shift(L-21,"cstr");return[D,G]}}function Y(C,L){for(var I={},D=C.l+L;C.l<D;){var G=C.read_shift(2);if(G==14e3){for(I[G]=[0,""],I[G][0]=C.read_shift(2);C[C.l];)I[G][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return I}function q(C,L){var I=V(5+C.length);I.write_shift(2,14e3),I.write_shift(2,L);for(var D=0;D<C.length;++D){var G=C.charCodeAt(D);I[I.l++]=G>127?95:G}return I[I.l++]=0,I}var he={0:{n:"BOF",f:Wy},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:oe},222:{n:"SHEETNAMELP",f:we},65535:{n:""}},xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:U},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Y},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:H},38:{n:"??"},39:{n:"NUMBER27",f:Z},40:{n:"FORMULA28",f:ve},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:oe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:_e},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}(),M4=/^\s|\s$|[\t\n\r]/;function Xy(t,e){if(!e.bookSST)return"";var r=[ht];r[r.length]=te("sst",null,{xmlns:pa[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(M4)&&(s+=' xml:space="preserve"'),s+=">"+Le(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function B4(t){return[t.read_shift(4),t.read_shift(4)]}function j4(t,e){return e||(e=V(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var U4=PC;function $4(t){var e=ir();X(e,159,j4(t));for(var r=0;r<t.length;++r)X(e,19,U4(t[r]));return X(e,160),e.end()}function z4(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function qy(t){var e=0,r,n=z4(t),i=n.length+1,s,a,o,l,u;for(r=ts(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var W4=function(){function t(i,s){switch(s.type){case"base64":return e(Dn(i),s);case"binary":return e(i,s);case"buffer":return e(Pe&&Buffer.isBuffer(i)?i.toString("binary"):el(i),s);case"array":return e($c(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(c,h){Array.isArray(o)&&(o[h]=[]);for(var f=/\\\w+\b/g,d=0,g,p=-1;g=f.exec(c);){switch(g[0]){case"\\cell":var m=c.slice(d,f.lastIndex-g[0].length);if(m[0]==" "&&(m=m.slice(1)),++p,m.length){var v={v:m,t:"s"};Array.isArray(o)?o[h][p]=v:o[Be({r:h,c:p})]=v}break}d=f.lastIndex}p>u.e.c&&(u.e.c=p)}),o["!ref"]=ct(u),o}function r(i,s){return as(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Ke(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var c=a.s.c;c<=a.e.c;++c)s.push("\\cellx"+(c+1));for(s.push("\\pard\\intbl"),c=a.s.c;c<=a.e.c;++c){var h=Be({r:u,c});o=l?(i[u]||[])[c]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Nn(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function d1(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}var H4=6,Cn=H4;function oc(t){return Math.floor((t+Math.round(128/Cn)/256)*Cn)}function lc(t){return Math.floor((t-5)/Cn*100+.5)/100}function ad(t){return Math.round((t*Cn+5)/Cn*256)/256}function W0(t){t.width?(t.wpx=oc(t.width),t.wch=lc(t.wpx),t.MDW=Cn):t.wpx?(t.wch=lc(t.wpx),t.width=ad(t.wch),t.MDW=Cn):typeof t.wch=="number"&&(t.width=ad(t.wch),t.wpx=oc(t.width),t.MDW=Cn),t.customWidth&&delete t.customWidth}var V4=96,Jy=V4;function uc(t){return t*96/Jy}function Qy(t){return t*Jy/96}function G4(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=te("numFmt",null,{numFmtId:n,formatCode:Le(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=te("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function K4(t){var e=[];return e[e.length]=te("cellXfs",null),t.forEach(function(r){e[e.length]=te("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=te("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function Zy(t,e){var r=[ht,te("styleSheet",null,{xmlns:pa[0],"xmlns:vt":xt.vt})],n;return t.SSF&&(n=G4(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=K4(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Y4(t,e){var r=t.read_shift(2),n=$t(t);return[r,n]}function X4(t,e,r){r||(r=V(6+4*e.length)),r.write_shift(2,t),yt(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function q4(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=MC(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=LC(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=$t(t),n}function J4(t,e){e||(e=V(25+4*32)),e.write_shift(2,t.sz*20),BC(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),sc(t.color,e);var n=0;return n=2,e.write_shift(1,n),yt(t.name,e),e.length>e.l?e.slice(0,e.l):e}var Q4=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Uh,Z4=pn;function p1(t,e){e||(e=V(4*3+8*7+16*1)),Uh||(Uh=R0(Q4));var r=Uh[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(sc({auto:1},e),sc({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function eP(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function ew(t,e,r){r||(r=V(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ma(t,e){return e||(e=V(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var tP=pn;function rP(t,e){return e||(e=V(51)),e.write_shift(1,0),Ma(null,e),Ma(null,e),Ma(null,e),Ma(null,e),Ma(null,e),e.length>e.l?e.slice(0,e.l):e}function nP(t,e){return e||(e=V(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),ic(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function iP(t,e,r){var n=V(2052);return n.write_shift(4,t),ic(e,n),ic(r,n),n.length>n.l?n.slice(0,n.l):n}function sP(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(X(t,615,en(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&X(t,44,X4(i,e[i]))}),X(t,616))}}function aP(t){var e=1;X(t,611,en(e)),X(t,43,J4({sz:12,color:{theme:1},name:"Calibri",family:2})),X(t,612)}function oP(t){var e=2;X(t,603,en(e)),X(t,45,p1({patternType:"none"})),X(t,45,p1({patternType:"gray125"})),X(t,604)}function lP(t){var e=1;X(t,613,en(e)),X(t,46,rP()),X(t,614)}function uP(t){var e=1;X(t,626,en(e)),X(t,47,ew({numFmtId:0},65535)),X(t,627)}function cP(t,e){X(t,617,en(e.length)),e.forEach(function(r){X(t,47,ew(r,0))}),X(t,618)}function hP(t){var e=1;X(t,619,en(e)),X(t,48,nP({xfId:0,name:"Normal"})),X(t,620)}function fP(t){var e=0;X(t,505,en(e)),X(t,506)}function dP(t){var e=0;X(t,508,iP(e,"TableStyleMedium9","PivotStyleMedium4")),X(t,509)}function pP(t,e){var r=ir();return X(r,278),sP(r,t.SSF),aP(r),oP(r),lP(r),uP(r),cP(r,e.cellXfs),hP(r),fP(r),dP(r),X(r,279),r.end()}function tw(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[ht];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function gP(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:$t(t)}}function mP(t){var e=V(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),yt(t.name,e),e.slice(0,e.l)}function vP(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function xP(t){var e=V(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function _P(t,e){var r=V(8+2*e.length);return r.write_shift(4,t),yt(e,r),r.slice(0,r.l)}function yP(t){return t.l+=4,t.read_shift(4)!=0}function wP(t,e){var r=V(8);return r.write_shift(4,t),r.write_shift(4,1),r}function SP(){var t=ir();return X(t,332),X(t,334,en(1)),X(t,335,mP({name:"XLDAPR",version:12e4,flags:3496657072})),X(t,336),X(t,339,_P(1,"XLDAPR")),X(t,52),X(t,35,en(514)),X(t,4096,en(0)),X(t,4097,kr(1)),X(t,36),X(t,53),X(t,340),X(t,337,wP(1)),X(t,51,xP([[1,0]])),X(t,338),X(t,333),t.end()}function rw(){var t=[ht];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function EP(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Be(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var Bs=1024;function nw(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[te("xml",null,{"xmlns:v":hr.v,"xmlns:o":hr.o,"xmlns:x":hr.x,"xmlns:mv":hr.mv}).replace(/\/>/,">"),te("o:shapelayout",te("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),te("v:shapetype",[te("v:stroke",null,{joinstyle:"miter"}),te("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Bs<t*1e3;)Bs+=1e3;return e.forEach(function(s){var a=_t(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?te("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=te("v:fill",l,o),c={on:"t",obscured:"t"};++Bs,i=i.concat(["<v:shape"+zo({id:"_x0000_s"+Bs,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,te("v:shadow",null,c),te("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ot("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Ot("x:AutoFill","False"),Ot("x:Row",String(a.r)),Ot("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function iw(t){var e=[ht,te("comments",null,{xmlns:pa[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=Le(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Le(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Ot("t",Le(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Ot("t",Le(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function TP(t,e,r){var n=[ht,te("ThreadedComments",null,{xmlns:xt.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(te("threadedComment",Ot("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function kP(t){var e=[ht,te("personList",null,{xmlns:xt.TCMNT,"xmlns:x":pa[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(te("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function bP(t){var e={};e.iauthor=t.read_shift(4);var r=cs(t);return e.rfx=r.s,e.ref=Be(r.s),t.l+=16,e}function AP(t,e){return e==null&&(e=V(36)),e.write_shift(4,t[1].iauthor),ma(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var OP=$t;function CP(t){return yt(t.slice(0,54))}function PP(t){var e=ir(),r=[];return X(e,628),X(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),X(e,632,CP(i.a)))})}),X(e,631),X(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:_t(n[0]),e:_t(n[0])};X(e,635,AP([s,i])),i.t&&i.t.length>0&&X(e,637,FC(i)),X(e,636),delete i.iauthor})}),X(e,634),X(e,629),e.end()}function RP(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&je.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var sw=["xlsb","xlsm","xlam","biff8","xla"],FP=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,c=a.length>0?parseInt(a,10)|0:0;return o?c+=e.c:--c,l?u+=e.r:--u,i+(o?"":"$")+Ut(c)+(l?"":"$")+Pt(u)}return function(i,s){return e=s,i.replace(t,r)}}(),H0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,V0=function(){return function(e,r){return e.replace(H0,function(n,i,s,a,o,l){var u=B0(a)-(s?0:r.c),c=M0(l)-(o?0:r.r),h=c==0?"":o?c+1:"["+c+"]",f=u==0?"":s?u+1:"["+u+"]";return i+"R"+h+"C"+f})}}();function IP(t,e){return t.replace(H0,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Ut(B0(s)+e.c))+(a=="$"?a+o:Pt(M0(o)+e.r))})}function DP(t){return t.length!=1}function ot(t){t.l+=1}function mi(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function aw(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return ow(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=mi(t),o=mi(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function ow(t){var e=mi(t),r=mi(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function NP(t,e,r){if(r.biff<8)return ow(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=mi(t),a=mi(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function lw(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return LP(t);var n=t.read_shift(r&&r.biff==12?4:2),i=mi(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function LP(t){var e=mi(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function MP(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function BP(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return jP(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function jP(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function UP(t,e,r){var n=(t[t.l++]&96)>>5,i=aw(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function $P(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=aw(t,s,r);return[n,i,a]}function zP(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function WP(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function HP(t,e,r){var n=(t[t.l++]&96)>>5,i=NP(t,e-1,r);return[n,i]}function VP(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function g1(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function GP(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function KP(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function YP(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function XP(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function qP(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function uw(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function JP(t){return t.read_shift(2),uw(t)}function QP(t){return t.read_shift(2),uw(t)}function ZP(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=lw(t,0,r);return[n,i]}function eR(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=BP(t,0,r);return[n,i]}function tR(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=lw(t,0,r);return[n,i,s]}function rR(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[r3[i],fw[i],n]}function nR(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:iR(t);return[i,(s[0]===0?fw:t3)[s[1]]]}function iR(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function sR(t,e,r){t.l+=r&&r.biff==2?3:4}function aR(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function oR(t){return t.l++,nl[t.read_shift(1)]}function lR(t){return t.l++,t.read_shift(2)}function uR(t){return t.l++,t.read_shift(1)!==0}function cR(t){return t.l++,va(t)}function hR(t,e,r){return t.l++,Vy(t,e-1,r)}function fR(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=t4(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=nl[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=va(t);break;case 2:r[1]=s4(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function dR(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?cs:l4)(t));return i}function pR(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=fR(t,r.biff);return a}function gR(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function mR(t,e,r){if(r.biff==5)return vR(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function vR(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function xR(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function _R(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function yR(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function wR(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var SR=pn,ER=pn,TR=pn;function il(t,e,r){return t.l+=2,[MP(t)]}function G0(t){return t.l+=6,[]}var kR=il,bR=G0,AR=G0,OR=il;function cw(t){return t.l+=2,[Wy(t),t.read_shift(2)&1]}var CR=il,PR=cw,RR=G0,FR=il,IR=il,DR=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function NR(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=DR[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function LR(t){return t.l+=2,[t.read_shift(4)]}function MR(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function BR(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function jR(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function UR(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function $R(t){return t.l+=4,[0,0]}var m1={1:{n:"PtgExp",f:aR},2:{n:"PtgTbl",f:TR},3:{n:"PtgAdd",f:ot},4:{n:"PtgSub",f:ot},5:{n:"PtgMul",f:ot},6:{n:"PtgDiv",f:ot},7:{n:"PtgPower",f:ot},8:{n:"PtgConcat",f:ot},9:{n:"PtgLt",f:ot},10:{n:"PtgLe",f:ot},11:{n:"PtgEq",f:ot},12:{n:"PtgGe",f:ot},13:{n:"PtgGt",f:ot},14:{n:"PtgNe",f:ot},15:{n:"PtgIsect",f:ot},16:{n:"PtgUnion",f:ot},17:{n:"PtgRange",f:ot},18:{n:"PtgUplus",f:ot},19:{n:"PtgUminus",f:ot},20:{n:"PtgPercent",f:ot},21:{n:"PtgParen",f:ot},22:{n:"PtgMissArg",f:ot},23:{n:"PtgStr",f:hR},26:{n:"PtgSheet",f:MR},27:{n:"PtgEndSheet",f:BR},28:{n:"PtgErr",f:oR},29:{n:"PtgBool",f:uR},30:{n:"PtgInt",f:lR},31:{n:"PtgNum",f:cR},32:{n:"PtgArray",f:VP},33:{n:"PtgFunc",f:rR},34:{n:"PtgFuncVar",f:nR},35:{n:"PtgName",f:gR},36:{n:"PtgRef",f:ZP},37:{n:"PtgArea",f:UP},38:{n:"PtgMemArea",f:xR},39:{n:"PtgMemErr",f:SR},40:{n:"PtgMemNoMem",f:ER},41:{n:"PtgMemFunc",f:_R},42:{n:"PtgRefErr",f:yR},43:{n:"PtgAreaErr",f:zP},44:{n:"PtgRefN",f:eR},45:{n:"PtgAreaN",f:HP},46:{n:"PtgMemAreaN",f:jR},47:{n:"PtgMemNoMemN",f:UR},57:{n:"PtgNameX",f:mR},58:{n:"PtgRef3d",f:tR},59:{n:"PtgArea3d",f:$P},60:{n:"PtgRefErr3d",f:wR},61:{n:"PtgAreaErr3d",f:WP},255:{}},zR={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},WR={1:{n:"PtgElfLel",f:cw},2:{n:"PtgElfRw",f:FR},3:{n:"PtgElfCol",f:kR},6:{n:"PtgElfRwV",f:IR},7:{n:"PtgElfColV",f:OR},10:{n:"PtgElfRadical",f:CR},11:{n:"PtgElfRadicalS",f:RR},13:{n:"PtgElfColS",f:bR},15:{n:"PtgElfColSV",f:AR},16:{n:"PtgElfRadicalLel",f:PR},25:{n:"PtgList",f:NR},29:{n:"PtgSxName",f:LR},255:{}},HR={0:{n:"PtgAttrNoop",f:$R},1:{n:"PtgAttrSemi",f:qP},2:{n:"PtgAttrIf",f:YP},4:{n:"PtgAttrChoose",f:GP},8:{n:"PtgAttrGoto",f:KP},16:{n:"PtgAttrSum",f:sR},32:{n:"PtgAttrBaxcel",f:g1},33:{n:"PtgAttrBaxcel",f:g1},64:{n:"PtgAttrSpace",f:JP},65:{n:"PtgAttrSpaceSemi",f:QP},128:{n:"PtgAttrIfError",f:XP},255:{}};function VR(t,e,r,n){if(n.biff<8)return pn(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=pR(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=dR(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(pn(t,e)),s}function GR(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=m1[s]||m1[zR[s]],(s===24||s===25)&&(i=(s===24?WR:HR)[t[t.l+1]]),!i||!i.f?pn(t,e):a.push([i.n,i.f(t,e,r)]);return a}function KR(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var YR={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function XR(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function hw(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function v1(t,e,r){var n=hw(t,e,r);return n=="#REF"?n:XR(n,r)}function oa(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,c,h=0,f=0,d,g="";if(!t[0]||!t[0][0])return"";for(var p=-1,m="",v=0,x=t[0].length;v<x;++v){var _=t[0][v];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),p>=0){switch(t[0][p][1][0]){case 0:m=nt(" ",t[0][p][1][1]);break;case 1:m=nt("\r",t[0][p][1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}u=u+m,p=-1}o.push(u+YR[_[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=co(_[1][1],a,i),o.push(ho(c,s));break;case"PtgRefN":c=r?co(_[1][1],r,i):_[1][1],o.push(ho(c,s));break;case"PtgRef3d":h=_[1][1],c=co(_[1][2],a,i),g=v1(n,h,i),o.push(g+"!"+ho(c,s));break;case"PtgFunc":case"PtgFuncVar":var w=_[1][0],O=_[1][1];w||(w=0),w&=127;var R=w==0?[]:o.slice(-w);o.length-=w,O==="User"&&(O=R.shift()),o.push(O+"("+R.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":d=t1(_[1][1],r?{s:r}:a,i),o.push(Bh(d,i));break;case"PtgArea":d=t1(_[1][1],a,i),o.push(Bh(d,i));break;case"PtgArea3d":h=_[1][1],d=_[1][2],g=v1(n,h,i),o.push(g+"!"+Bh(d,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=_[1][2];var T=(n.names||[])[f-1]||(n[0]||[])[f],P=T?T.Name:"SH33TJSNAME"+String(f);P&&P.slice(0,6)=="_xlfn."&&!i.xlfn&&(P=P.slice(6)),o.push(P);break;case"PtgNameX":var F=_[1][1];f=_[1][2];var N;if(i.biff<=5)F<0&&(F=-F),n[F]&&(N=n[F][f]);else{var U="";if(((n[F]||[])[0]||[])[0]==14849||(((n[F]||[])[0]||[])[0]==1025?n[F][f]&&n[F][f].itab>0&&(U=n.SheetNames[n[F][f].itab-1]+"!"):U=n.SheetNames[f-1]+"!"),n[F]&&n[F][f])U+=n[F][f].Name;else if(n[0]&&n[0][f])U+=n[0][f].Name;else{var H=(hw(n,F,i)||"").split(";;");H[f-1]?U=H[f-1]:U+="SH33TJSERRX"}o.push(U);break}N||(N={Name:"SH33TJSERRY"}),o.push(N.Name);break;case"PtgParen":var Z="(",ve=")";if(p>=0){switch(m="",t[0][p][1][0]){case 2:Z=nt(" ",t[0][p][1][1])+Z;break;case 3:Z=nt("\r",t[0][p][1][1])+Z;break;case 4:ve=nt(" ",t[0][p][1][1])+ve;break;case 5:ve=nt("\r",t[0][p][1][1])+ve;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}p=-1}o.push(Z+o.pop()+ve);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":c={c:_[1][1],r:_[1][0]};var oe={c:r.c,r:r.r};if(n.sharedf[Be(c)]){var we=n.sharedf[Be(c)];o.push(oa(we,a,oe,n,i))}else{var _e=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(c.c<u[0].s.c||c.c>u[0].e.c)&&!(c.r<u[0].s.r||c.r>u[0].e.r)){o.push(oa(u[1],a,oe,n,i)),_e=!0;break}_e||o.push(_[1])}break;case"PtgArray":o.push("{"+KR(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var Y=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&Y.indexOf(t[0][v][0])==-1){_=t[0][p];var q=!0;switch(_[1][0]){case 4:q=!1;case 0:m=nt(" ",_[1][1]);break;case 5:q=!1;case 1:m=nt("\r",_[1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((q?m:"")+o.pop()+(q?"":m)),p=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function qR(t){if(t==null){var e=V(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return rs(t);return rs(0)}function JR(t,e,r,n,i){var s=ns(e,r,i),a=qR(t.v),o=V(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=V(t.bf.length),c=0;c<t.bf.length;++c)u[c]=t.bf[c];var h=At([s,a,o,u]);return h}function zc(t,e,r){var n=t.read_shift(4),i=GR(t,n,r),s=t.read_shift(4),a=s>0?VR(t,s,i,r):null;return[i,a]}var QR=zc,Wc=zc,ZR=zc,e3=zc,t3={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},fw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},r3={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function n3(t){var e="of:="+t.replace(H0,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function i3(t){return t.replace(/\./,"!")}var fo=typeof Map<"u";function K0(t,e,r){var n=0,i=t.length;if(r){if(fo?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=fo?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(fo?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Hc(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Cn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=lc(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=ad(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function dw(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function wi(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){ly(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function s3(t,e,r){if(t&&t["!ref"]){var n=Ke(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function a3(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+ct(t[r])+'"/>';return e+"</mergeCells>"}function o3(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=$o(Le(l))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),o=(o||"")+te("outlinePr",null,u)}!s&&!o||(i[i.length]=te("sheetPr",o,a))}var l3=["objects","scenarios","selectLockedCells","selectUnlockedCells"],u3=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function c3(t){var e={sheet:1};return l3.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),u3.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=qy(t.password).toString(16).toUpperCase()),te("sheetProtection",null,e)}function h3(t){return dw(t),te("pageMargins",null,t)}function f3(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=te("col",null,Hc(i,n)));return r[r.length]="</cols>",r.join("")}function d3(t,e,r,n){var i=typeof t.ref=="string"?t.ref:ct(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=xr(i);a.s.r==a.e.r&&(a.e.r=xr(e["!ref"]).e.r,i=ct(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),te("autoFilter",null,{ref:i})}function p3(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),te("sheetViews",te("sheetView",null,i),{})}function g3(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=nl[t.v];break;case"d":n&&n.cellDates?i=Yt(t.v,-1).toISOString():(t=ar(t),t.t="n",i=""+(t.v=sr(Yt(t.v)))),typeof t.z>"u"&&(t.z=it[14]);break;default:i=t.v;break}var o=Ot("v",Le(i)),l={r:e},u=wi(n.cellXfs,t,n);switch(u!==0&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Ot("v",""+K0(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var c=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=te("f",Le(t.f),c)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),te("c",o,l)}function m3(t,e,r,n){var i=[],s=[],a=Ke(t["!ref"]),o="",l,u="",c=[],h=0,f=0,d=t["!rows"],g=Array.isArray(t),p={r:u},m,v=-1;for(f=a.s.c;f<=a.e.c;++f)c[f]=Ut(f);for(h=a.s.r;h<=a.e.r;++h){for(s=[],u=Pt(h),f=a.s.c;f<=a.e.c;++f){l=c[f]+u;var x=g?(t[h]||[])[f]:t[l];x!==void 0&&(o=g3(x,l,t,e))!=null&&s.push(o)}(s.length>0||d&&d[h])&&(p={r:u},d&&d[h]&&(m=d[h],m.hidden&&(p.hidden=1),v=-1,m.hpx?v=uc(m.hpx):m.hpt&&(v=m.hpt),v>-1&&(p.ht=v,p.customHeight=1),m.level&&(p.outlineLevel=m.level)),i[i.length]=te("row",s.join(""),p))}if(d)for(;h<d.length;++h)d&&d[h]&&(p={r:h+1},m=d[h],m.hidden&&(p.hidden=1),v=-1,m.hpx?v=uc(m.hpx):m.hpt&&(v=m.hpt),v>-1&&(p.ht=v,p.customHeight=1),m.level&&(p.outlineLevel=m.level),i[i.length]=te("row","",p));return i.join("")}function pw(t,e,r,n){var i=[ht,te("worksheet",null,{xmlns:pa[0],"xmlns:r":xt.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",c=Ke(u);if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),u=ct(c)}n||(n={}),l["!comments"]=[];var h=[];o3(l,r,t,e,i),i[i.length]=te("dimension",null,{ref:u}),i[i.length]=p3(l,e,t,r),e.sheetFormat&&(i[i.length]=te("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=f3(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=m3(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=c3(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=d3(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=a3(l["!merges"]));var f=-1,d,g=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(d={ref:p[0]},p[1].Target.charAt(0)!="#"&&(g=De(n,-1,Le(p[1].Target).replace(/#.*$/,""),Oe.HLINK),d["r:id"]="rId"+g),(f=p[1].Target.indexOf("#"))>-1&&(d.location=Le(p[1].Target.slice(f+1))),p[1].Tooltip&&(d.tooltip=Le(p[1].Tooltip)),i[i.length]=te("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=h3(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Ot("ignoredErrors",te("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(g=De(n,-1,"../drawings/drawing"+(t+1)+".xml",Oe.DRAW),i[i.length]=te("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=h),l["!comments"].length>0&&(g=De(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Oe.VML),i[i.length]=te("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function v3(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function x3(t,e,r){var n=V(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=uc(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:t,c:0},c=0;c<16;++c)if(!(e.s.c>c+1<<10||e.e.c<c<<10)){for(var h=-1,f=-1,d=c<<10;d<c+1<<10;++d){u.c=d;var g=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Be(u)];g&&(h<0&&(h=d),f=d)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,f))}var p=n.l;return n.l=l,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function _3(t,e,r,n){var i=x3(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&X(t,0,i)}var y3=cs,w3=ma;function S3(){}function E3(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=IC(t),r}function T3(t,e,r){r==null&&(r=V(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return sc({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Cy(t,r),r.slice(0,r.l)}function k3(t){var e=Lr(t);return[e]}function b3(t,e,r){return r==null&&(r=V(8)),os(e,r)}function A3(t){var e=ls(t);return[e]}function O3(t,e,r){return r==null&&(r=V(4)),us(e,r)}function C3(t){var e=Lr(t),r=t.read_shift(1);return[e,r,"b"]}function P3(t,e,r){return r==null&&(r=V(9)),os(e,r),r.write_shift(1,t.v?1:0),r}function R3(t){var e=ls(t),r=t.read_shift(1);return[e,r,"b"]}function F3(t,e,r){return r==null&&(r=V(5)),us(e,r),r.write_shift(1,t.v?1:0),r}function I3(t){var e=Lr(t),r=t.read_shift(1);return[e,r,"e"]}function D3(t,e,r){return r==null&&(r=V(9)),os(e,r),r.write_shift(1,t.v),r}function N3(t){var e=ls(t),r=t.read_shift(1);return[e,r,"e"]}function L3(t,e,r){return r==null&&(r=V(8)),us(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function M3(t){var e=Lr(t),r=t.read_shift(4);return[e,r,"s"]}function B3(t,e,r){return r==null&&(r=V(12)),os(e,r),r.write_shift(4,e.v),r}function j3(t){var e=ls(t),r=t.read_shift(4);return[e,r,"s"]}function U3(t,e,r){return r==null&&(r=V(8)),us(e,r),r.write_shift(4,e.v),r}function $3(t){var e=Lr(t),r=va(t);return[e,r,"n"]}function z3(t,e,r){return r==null&&(r=V(16)),os(e,r),rs(t.v,r),r}function W3(t){var e=ls(t),r=va(t);return[e,r,"n"]}function H3(t,e,r){return r==null&&(r=V(12)),us(e,r),rs(t.v,r),r}function V3(t){var e=Lr(t),r=Py(t);return[e,r,"n"]}function G3(t,e,r){return r==null&&(r=V(12)),os(e,r),Ry(t.v,r),r}function K3(t){var e=ls(t),r=Py(t);return[e,r,"n"]}function Y3(t,e,r){return r==null&&(r=V(8)),us(e,r),Ry(t.v,r),r}function X3(t){var e=Lr(t),r=j0(t);return[e,r,"is"]}function q3(t){var e=Lr(t),r=$t(t);return[e,r,"str"]}function J3(t,e,r){return r==null&&(r=V(12+4*t.v.length)),os(e,r),yt(t.v,r),r.length>r.l?r.slice(0,r.l):r}function Q3(t){var e=ls(t),r=$t(t);return[e,r,"str"]}function Z3(t,e,r){return r==null&&(r=V(8+4*t.v.length)),us(e,r),yt(t.v,r),r.length>r.l?r.slice(0,r.l):r}function eF(t,e,r){var n=t.l+e,i=Lr(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=Wc(t,n-t.l,r);a[3]=oa(o,null,i,r.supbooks,r)}else t.l=n;return a}function tF(t,e,r){var n=t.l+e,i=Lr(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=Wc(t,n-t.l,r);a[3]=oa(o,null,i,r.supbooks,r)}else t.l=n;return a}function rF(t,e,r){var n=t.l+e,i=Lr(t);i.r=r["!row"];var s=va(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=Wc(t,n-t.l,r);a[3]=oa(o,null,i,r.supbooks,r)}else t.l=n;return a}function nF(t,e,r){var n=t.l+e,i=Lr(t);i.r=r["!row"];var s=$t(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=Wc(t,n-t.l,r);a[3]=oa(o,null,i,r.supbooks,r)}else t.l=n;return a}var iF=cs,sF=ma;function aF(t,e){return e==null&&(e=V(4)),e.write_shift(4,t),e}function oF(t,e){var r=t.l+e,n=cs(t),i=U0(t),s=$t(t),a=$t(t),o=$t(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function lF(t,e){var r=V(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));ma({s:_t(t[0]),e:_t(t[0])},r),$0("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return yt(i||"",r),yt(t[1].Tooltip||"",r),yt("",r),r.slice(0,r.l)}function uF(){}function cF(t,e,r){var n=t.l+e,i=Fy(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=QR(t,n-t.l,r);a[1]=o}else t.l=n;return a}function hF(t,e,r){var n=t.l+e,i=cs(t),s=[i];if(r.cellFormula){var a=e3(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function fF(t,e,r){r==null&&(r=V(18));var n=Hc(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var gw=["left","right","top","bottom","header","footer"];function dF(t){var e={};return gw.forEach(function(r){e[r]=va(t)}),e}function pF(t,e){return e==null&&(e=V(6*8)),dw(t),gw.forEach(function(r){rs(t[r],e)}),e}function gF(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function mF(t,e,r){r==null&&(r=V(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function vF(t){var e=V(24);return e.write_shift(4,4),e.write_shift(4,1),ma(t,e),e}function xF(t,e){return e==null&&(e=V(16*4+2)),e.write_shift(2,t.password?qy(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function _F(){}function yF(){}function wF(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=ar(e),e.z=e.z||it[14],e.v=sr(Yt(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=wi(i.cellXfs,e,i),e.l&&s["!links"].push([Be(l),e.l]),e.c&&s["!comments"].push([Be(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=K0(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?X(t,18,U3(e,l)):X(t,7,B3(e,l))):(l.t="str",a?X(t,17,Z3(e,l)):X(t,6,J3(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?X(t,13,Y3(e,l)):X(t,2,G3(e,l)):a?X(t,16,H3(e,l)):X(t,5,z3(e,l)),!0;case"b":return l.t="b",a?X(t,15,F3(e,l)):X(t,4,P3(e,l)),!0;case"e":return l.t="e",a?X(t,14,L3(e,l)):X(t,3,D3(e,l)),!0}return a?X(t,12,O3(e,l)):X(t,1,b3(e,l)),!0}function SF(t,e,r,n){var i=Ke(e["!ref"]||"A1"),s,a="",o=[];X(t,145);var l=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var c=i.s.r;c<=u;++c){a=Pt(c),_3(t,e,i,c);var h=!1;if(c<=i.e.r)for(var f=i.s.c;f<=i.e.c;++f){c===i.s.r&&(o[f]=Ut(f)),s=o[f]+a;var d=l?(e[c]||[])[f]:e[s];if(!d){h=!1;continue}h=wF(t,d,c,f,n,e,h)}}X(t,146)}function EF(t,e){!e||!e["!merges"]||(X(t,177,aF(e["!merges"].length)),e["!merges"].forEach(function(r){X(t,176,sF(r))}),X(t,178))}function TF(t,e){!e||!e["!cols"]||(X(t,390),e["!cols"].forEach(function(r,n){r&&X(t,60,fF(n,r))}),X(t,391))}function kF(t,e){!e||!e["!ref"]||(X(t,648),X(t,649,vF(Ke(e["!ref"]))),X(t,650))}function bF(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=De(r,-1,n[1].Target.replace(/#.*$/,""),Oe.HLINK);X(t,494,lF(n,i))}}),delete e["!links"]}function AF(t,e,r,n){if(e["!comments"].length>0){var i=De(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Oe.VML);X(t,551,$0("rId"+i)),e["!legacy"]=i}}function OF(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:ct(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=xr(s);o.s.r==o.e.r&&(o.e.r=xr(e["!ref"]).e.r,s=ct(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),X(t,161,ma(Ke(s))),X(t,162)}}function CF(t,e,r){X(t,133),X(t,137,mF(e,r)),X(t,138),X(t,134)}function PF(t,e){e["!protect"]&&X(t,535,xF(e["!protect"]))}function RF(t,e,r,n){var i=ir(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=Ke(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],X(i,129),(r.vbaraw||a["!outline"])&&X(i,147,T3(o,a["!outline"])),X(i,148,w3(l)),CF(i,a,r.Workbook),TF(i,a),SF(i,a,t,e),PF(i,a),OF(i,a,r,t),EF(i,a),bF(i,a,n),a["!margins"]&&X(i,476,pF(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&kF(i,a),AF(i,a,t,n),X(i,130),i.end()}function FF(t,e){t.l+=10;var r=$t(t);return{name:r}}var IF=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function DF(t){return!t.Workbook||!t.Workbook.WBProps?"false":hC(t.Workbook.WBProps.date1904)?"true":"false"}var NF="][*?/\\".split("");function mw(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return NF.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function LF(t,e,r){t.forEach(function(n,i){mw(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function MF(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];LF(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)s3(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function vw(t){var e=[ht];e[e.length]=te("workbook",null,{xmlns:pa[0],"xmlns:r":xt.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(IF.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=te("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:Le(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=te("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=te("definedName",Le(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function BF(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=sd(t),r.name=$t(t),r}function jF(t,e){return e||(e=V(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),$0(t.strRelID,e),yt(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function UF(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?$t(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function $F(t,e){e||(e=V(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),Cy(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function zF(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=DC(t),a=ZR(t,0,r),o=U0(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function WF(t,e){X(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};X(t,156,jF(i))}X(t,144)}function HF(t,e){e||(e=V(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return yt("SheetJS",e),yt(Ju.version,e),yt(Ju.version,e),yt("7262",e),e.length>e.l?e.slice(0,e.l):e}function VF(t,e){e||(e=V(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function GF(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(X(t,135),X(t,158,VF(i)),X(t,136))}}function KF(t,e){var r=ir();return X(r,131),X(r,128,HF()),X(r,153,$F(t.Workbook&&t.Workbook.WBProps||null)),GF(r,t),WF(r,t),X(r,132),r.end()}function YF(t,e,r){return(e.slice(-4)===".bin"?KF:vw)(t)}function XF(t,e,r,n,i){return(e.slice(-4)===".bin"?RF:pw)(t,r,n,i)}function qF(t,e,r){return(e.slice(-4)===".bin"?pP:Zy)(t,r)}function JF(t,e,r){return(e.slice(-4)===".bin"?$4:Xy)(t,r)}function QF(t,e,r){return(e.slice(-4)===".bin"?PP:iw)(t)}function ZF(t){return(t.slice(-4)===".bin"?SP:rw)()}function eI(t,e){var r=[];return t.Props&&r.push(qC(t.Props,e)),t.Custprops&&r.push(JC(t.Props,t.Custprops)),r.join("")}function tI(){return""}function rI(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(te("NumberFormat",null,{"ss:Format":Le(it[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(te("Style",s.join(""),a))}),te("Styles",r.join(""))}function xw(t){return te("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+V0(t.Ref,{r:0,c:0})})}function nI(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(xw(i)))}return te("Names",r.join(""))}function iI(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(xw(o)))}return s.join("")}function sI(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(te("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(te("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(te("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(te("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Ot("ProtectContents","True")),t["!protect"].objects&&i.push(Ot("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Ot("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Ot("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Ot("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":te("WorksheetOptions",i.join(""),{xmlns:hr.x})}function aI(t){return t.map(function(e){var r=cC(e.t||""),n=te("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return te("Comment",n,{"ss:Author":e.a})}).join("")}function oI(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Le(V0(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=_t(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Le(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Le(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],c=0;c!=u.length;++c)u[c].s.c!=a.c||u[c].s.r!=a.r||(u[c].e.c>u[c].s.c&&(o["ss:MergeAcross"]=u[c].e.c-u[c].s.c),u[c].e.r>u[c].s.r&&(o["ss:MergeDown"]=u[c].e.r-u[c].s.r));var h="",f="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",f=String(t.v);break;case"b":h="Boolean",f=t.v?"1":"0";break;case"e":h="Error",f=nl[t.v];break;case"d":h="DateTime",f=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||it[14]);break;case"s":h="String",f=uC(t.v||"");break}var d=wi(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=a.c+1;var g=t.v!=null?f:"",p=t.t=="z"?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(t.c||[]).length>0&&(p+=aI(t.c)),te("Cell",p,o)}function lI(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Qy(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function uI(t,e,r,n){if(!t["!ref"])return"";var i=Ke(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(m,v){W0(m);var x=!!m.width,_=Hc(v,m),w={"ss:Index":v+1};x&&(w["ss:Width"]=oc(_.width)),m.hidden&&(w["ss:Hidden"]="1"),o.push(te("Column",null,w))});for(var l=Array.isArray(t),u=i.s.r;u<=i.e.r;++u){for(var c=[lI(u,(t["!rows"]||[])[u])],h=i.s.c;h<=i.e.c;++h){var f=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>u)&&!(s[a].e.c<h)&&!(s[a].e.r<u)){(s[a].s.c!=h||s[a].s.r!=u)&&(f=!0);break}if(!f){var d={r:u,c:h},g=Be(d),p=l?(t[u]||[])[h]:t[g];c.push(oI(p,g,t,e,r,n,d))}}c.push("</Row>"),c.length>2&&o.push(c.join(""))}return o.join("")}function cI(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?iI(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?uI(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(sI(s,e,t,r)),n.join("")}function hI(t,e){e||(e={}),t.SSF||(t.SSF=ar(it)),t.SSF&&(jc(),Bc(t.SSF),e.revssf=Uc(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],wi(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(eI(t,e)),r.push(tI()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(te("Worksheet",cI(n,e,t),{"ss:Name":Le(t.SheetNames[n])}));return r[2]=rI(t,e),r[3]=nI(t),ht+te("Workbook",r.join(""),{xmlns:hr.ss,"xmlns:o":hr.o,"xmlns:x":hr.x,"xmlns:ss":hr.ss,"xmlns:dt":hr.dt,"xmlns:html":hr.html})}var $h={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function fI(t,e){var r=[],n=[],i=[],s=0,a,o=Hm(n1,"n"),l=Hm(i1,"n");if(t.Props)for(a=Ft(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Ft(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)zy.indexOf(i[s][0])>-1||jy.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&je.utils.cfb_add(e,"/SummaryInformation",u1(n,$h.SI,l,i1)),(r.length||u.length)&&je.utils.cfb_add(e,"/DocumentSummaryInformation",u1(r,$h.DSI,o,n1,u.length?u:null,$h.UDI))}function dI(t,e){var r=e||{},n=je.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return je.utils.cfb_add(n,i,_w(t,r)),r.biff==8&&(t.Props||t.Custprops)&&fI(t,n),r.biff==8&&t.vbaraw&&RP(n,je.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var pI={0:{f:v3},1:{f:k3},2:{f:V3},3:{f:I3},4:{f:C3},5:{f:$3},6:{f:q3},7:{f:M3},8:{f:nF},9:{f:rF},10:{f:eF},11:{f:tF},12:{f:A3},13:{f:K3},14:{f:N3},15:{f:R3},16:{f:W3},17:{f:Q3},18:{f:j3},19:{f:j0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:zF},40:{},42:{},43:{f:q4},44:{f:Y4},45:{f:Z4},46:{f:tP},47:{f:eP},48:{},49:{f:AC},50:{},51:{f:vP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:O4},62:{f:X3},63:{f:EP},64:{f:_F},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:pn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:gF},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:E3},148:{f:y3,p:16},151:{f:uF},152:{},153:{f:UF},154:{},155:{},156:{f:BF},157:{},158:{},159:{T:1,f:B4},160:{T:-1},161:{T:1,f:cs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:iF},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:gP},336:{T:-1},337:{f:yP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:sd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:S4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:cF},427:{f:hF},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:dF},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:S3},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:oF},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:sd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:OP},633:{T:1},634:{T:-1},635:{T:1,f:bP},636:{T:-1},637:{f:RC},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:FF},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:yF},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function re(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&L0(r)&&t.push(r)}}function gI(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return re(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var c=t.next(4);for(c.write_shift(2,s),c.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u;l<i;){for(c=t.next(4),c.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;c.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u}}}function sl(t,e,r){return t||(t=V(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function mI(t,e,r,n){var i=V(9);return sl(i,t,e),Hy(r,n||"b",i),i}function vI(t,e,r){var n=V(8+2*r.length);return sl(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function xI(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?sr(Yt(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?re(t,2,F4(r,n,i)):re(t,3,R4(r,n,i));return;case"b":case"e":re(t,5,mI(r,n,e.v,e.t));return;case"s":case"str":re(t,4,vI(r,n,(e.v||"").slice(0,255)));return}re(t,1,sl(null,r,n))}function _I(t,e,r,n){var i=Array.isArray(e),s=Ke(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=ct(s)}for(var u=s.s.r;u<=s.e.r;++u){o=Pt(u);for(var c=s.s.c;c<=s.e.c;++c){u===s.s.r&&(l[c]=Ut(c)),a=l[c]+o;var h=i?(e[u]||[])[c]:e[a];h&&xI(t,h,u,c)}}}function yI(t,e){for(var r=e||{},n=ir(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return re(n,r.biff==4?1033:r.biff==3?521:9,z0(t,16,r)),_I(n,t.Sheets[t.SheetNames[i]],i,r),re(n,10),n.end()}function wI(t,e,r){re(t,49,p4({sz:12,name:"Arial"},r))}function SI(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&re(t,1054,v4(i,e[i],r))})}function EI(t,e){var r=V(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),re(t,2151,r),r=V(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Ky(Ke(e["!ref"]||"A1"),r),r.write_shift(4,4),re(t,2152,r)}function TI(t,e){for(var r=0;r<16;++r)re(t,224,h1({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){re(t,224,h1(n,0,e))})}function kI(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];re(t,440,k4(n)),n[1].Tooltip&&re(t,2048,b4(n))}delete e["!links"]}function bI(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&re(t,125,C4(Hc(i,n),i))})}}function AI(t,e,r,n,i){var s=16+wi(i.cellXfs,e,i);if(e.v==null&&!e.bf){re(t,513,ns(r,n,s));return}if(e.bf)re(t,6,JR(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?sr(Yt(e.v)):e.v;re(t,515,w4(r,n,a,s));break;case"b":case"e":re(t,517,y4(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=K0(i.Strings,e.v,i.revStrings);re(t,253,g4(r,n,o,s))}else re(t,516,m4(r,n,(e.v||"").slice(0,255),s,i));break;default:re(t,513,ns(r,n,s))}}function OI(t,e,r){var n=ir(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),u=e.biff==8,c,h="",f=[],d=Ke(s["!ref"]||"A1"),g=u?65536:16384;if(d.e.c>255||d.e.r>=g){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,g-1)}re(n,2057,z0(r,16,e)),re(n,13,kr(1)),re(n,12,kr(100)),re(n,15,Vt(!0)),re(n,17,Vt(!1)),re(n,16,rs(.001)),re(n,95,Vt(!0)),re(n,42,Vt(!1)),re(n,43,Vt(!1)),re(n,130,kr(1)),re(n,128,_4()),re(n,131,Vt(!1)),re(n,132,Vt(!1)),u&&bI(n,s["!cols"]),re(n,512,x4(d,e)),u&&(s["!links"]=[]);for(var p=d.s.r;p<=d.e.r;++p){h=Pt(p);for(var m=d.s.c;m<=d.e.c;++m){p===d.s.r&&(f[m]=Ut(m)),c=f[m]+h;var v=l?(s[p]||[])[m]:s[c];v&&(AI(n,v,p,m,e),u&&v.l&&s["!links"].push([c,v.l]))}}var x=o.CodeName||o.name||i;return u&&re(n,574,d4((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&re(n,229,T4(s["!merges"])),u&&kI(n,s),re(n,442,Gy(x)),u&&EI(n,s),re(n,10),n.end()}function CI(t,e,r){var n=ir(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(re(n,2057,z0(t,5,r)),r.bookType=="xla"&&re(n,135),re(n,225,o?kr(1200):null),re(n,193,e4(2)),l&&re(n,191),l&&re(n,192),re(n,226),re(n,92,u4("SheetJS",r)),re(n,66,kr(o?1200:1252)),o&&re(n,353,kr(0)),o&&re(n,448),re(n,317,P4(t.SheetNames.length)),o&&t.vbaraw&&re(n,211),o&&t.vbaraw){var u=a.CodeName||"ThisWorkbook";re(n,442,Gy(u))}re(n,156,kr(17)),re(n,25,Vt(!1)),re(n,18,Vt(!1)),re(n,19,kr(0)),o&&re(n,431,Vt(!1)),o&&re(n,444,kr(0)),re(n,61,f4()),re(n,64,Vt(!1)),re(n,141,kr(0)),re(n,34,Vt(DF(t)=="true")),re(n,14,Vt(!0)),o&&re(n,439,Vt(!1)),re(n,218,kr(0)),wI(n,t,r),SI(n,t.SSF,r),TI(n,r),o&&re(n,352,Vt(!1));var c=n.end(),h=ir();o&&re(h,140,A4()),o&&r.Strings&&gI(h,252,h4(r.Strings)),re(h,10);var f=h.end(),d=ir(),g=0,p=0;for(p=0;p<t.SheetNames.length;++p)g+=(o?12:11)+(o?2:1)*t.SheetNames[p].length;var m=c.length+g+f.length;for(p=0;p<t.SheetNames.length;++p){var v=s[p]||{};re(d,133,c4({pos:m,hs:v.Hidden||0,dt:0,name:t.SheetNames[p]},r)),m+=e[p].length}var x=d.end();if(g!=x.length)throw new Error("BS8 "+g+" != "+x.length);var _=[];return c.length&&_.push(c),x.length&&_.push(x),f.length&&_.push(f),At(_)}function PI(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=ar(it)),t&&t.SSF&&(jc(),Bc(t.SSF),r.revssf=Uc(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Y0(r),r.cellXfs=[],wi(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=OI(i,r,t);return n.unshift(CI(t,n,r)),At(n)}function _w(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=xr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return PI(t,e);case 4:case 3:case 2:return yI(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function RI(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>a)&&!(i[u].e.r<r||i[u].e.c<a)){if(i[u].s.r<r||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var c=Be({r,c:a}),h=n.dense?(t[r]||[])[a]:t[c],f=h&&h.v!=null&&(h.h||lC(h.w||(Nn(h),h.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?f='<span contenteditable="true">'+f+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),d.id=(n.id||"sjs")+"-"+c,s.push(te("td",f,d))}}var g="<tr>";return g+s.join("")+"</tr>"}var FI='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',II="</body></html>";function DI(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function yw(t,e){var r=e||{},n=r.header!=null?r.header:FI,i=r.footer!=null?r.footer:II,s=[n],a=xr(t["!ref"]);r.dense=Array.isArray(t),s.push(DI(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(RI(t,a,o,r));return s.push("</table>"+i),s.join("")}function ww(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?_t(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var c=xr(t["!ref"]);u.s.r=Math.min(u.s.r,c.s.r),u.s.c=Math.min(u.s.c,c.s.c),u.e.r=Math.max(u.e.r,c.e.r),u.e.c=Math.max(u.e.c,c.e.c),i==-1&&(u.e.r=i=c.e.r+1)}var h=[],f=0,d=t["!rows"]||(t["!rows"]=[]),g=0,p=0,m=0,v=0,x=0,_=0;for(t["!cols"]||(t["!cols"]=[]);g<o.length&&p<l;++g){var w=o[g];if(x1(w)){if(n.display)continue;d[p]={hidden:!0}}var O=w.children;for(m=v=0;m<O.length;++m){var R=O[m];if(!(n.display&&x1(R))){var T=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):fC(R.innerHTML),P=R.getAttribute("data-z")||R.getAttribute("z");for(f=0;f<h.length;++f){var F=h[f];F.s.c==v+s&&F.s.r<p+i&&p+i<=F.e.r&&(v=F.e.c+1-s,f=-1)}_=+R.getAttribute("colspan")||1,((x=+R.getAttribute("rowspan")||1)>1||_>1)&&h.push({s:{r:p+i,c:v+s},e:{r:p+i+(x||1)-1,c:v+s+(_||1)-1}});var N={t:"s",v:T},U=R.getAttribute("data-t")||R.getAttribute("t")||"";T!=null&&(T.length==0?N.t=U||"z":n.raw||T.trim().length==0||U=="s"||(T==="TRUE"?N={t:"b",v:!0}:T==="FALSE"?N={t:"b",v:!1}:isNaN(On(T))?isNaN(Uo(T).getDate())||(N={t:"d",v:Yt(T)},n.cellDates||(N={t:"n",v:sr(N.v)}),N.z=n.dateNF||it[14]):N={t:"n",v:On(T)})),N.z===void 0&&P!=null&&(N.z=P);var H="",Z=R.getElementsByTagName("A");if(Z&&Z.length)for(var ve=0;ve<Z.length&&!(Z[ve].hasAttribute("href")&&(H=Z[ve].getAttribute("href"),H.charAt(0)!="#"));++ve);H&&H.charAt(0)!="#"&&(N.l={Target:H}),n.dense?(t[p+i]||(t[p+i]=[]),t[p+i][v+s]=N):t[Be({c:v+s,r:p+i})]=N,u.e.c<v+s&&(u.e.c=v+s),v+=_}}++p}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,p-1+i),t["!ref"]=ct(u),p>=l&&(t["!fullref"]=ct((u.e.r=o.length-g+p-1+i,u))),t}function Sw(t,e){var r=e||{},n=r.dense?[]:{};return ww(n,t,e)}function NI(t,e){return as(Sw(t,e),e)}function x1(t){var e="",r=LI(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function LI(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var MI=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+zo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return ht+e}}(),_1=function(){var t=function(s){return Le(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Le(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,c=0,h=xr(s["!ref"]||"A1"),f=s["!merges"]||[],d=0,g=Array.isArray(s);if(s["!cols"])for(c=0;c<=h.e.c;++c)l.push("        <table:table-column"+(s["!cols"][c]?' table:style-name="co'+s["!cols"][c].ods+'"':"")+`></table:table-column>
`);var p="",m=s["!rows"]||[];for(u=0;u<h.s.r;++u)p=m[u]?' table:style-name="ro'+m[u].ods+'"':"",l.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=h.e.r;++u){for(p=m[u]?' table:style-name="ro'+m[u].ods+'"':"",l.push("        <table:table-row"+p+`>
`),c=0;c<h.s.c;++c)l.push(e);for(;c<=h.e.c;++c){var v=!1,x={},_="";for(d=0;d!=f.length;++d)if(!(f[d].s.c>c)&&!(f[d].s.r>u)&&!(f[d].e.c<c)&&!(f[d].e.r<u)){(f[d].s.c!=c||f[d].s.r!=u)&&(v=!0),x["table:number-columns-spanned"]=f[d].e.c-f[d].s.c+1,x["table:number-rows-spanned"]=f[d].e.r-f[d].s.r+1;break}if(v){l.push(r);continue}var w=Be({r:u,c}),O=g?(s[u]||[])[c]:s[w];if(O&&O.f&&(x["table:formula"]=Le(n3(O.f)),O.F&&O.F.slice(0,w.length)==w)){var R=xr(O.F);x["table:number-matrix-columns-spanned"]=R.e.c-R.s.c+1,x["table:number-matrix-rows-spanned"]=R.e.r-R.s.r+1}if(!O){l.push(e);continue}switch(O.t){case"b":_=O.v?"TRUE":"FALSE",x["office:value-type"]="boolean",x["office:boolean-value"]=O.v?"true":"false";break;case"n":_=O.w||String(O.v||0),x["office:value-type"]="float",x["office:value"]=O.v||0;break;case"s":case"str":_=O.v==null?"":O.v,x["office:value-type"]="string";break;case"d":_=O.w||Yt(O.v).toISOString(),x["office:value-type"]="date",x["office:date-value"]=Yt(O.v).toISOString(),x["table:style-name"]="ce1";break;default:l.push(e);continue}var T=t(_);if(O.l&&O.l.Target){var P=O.l.Target;P=P.charAt(0)=="#"?"#"+i3(P.slice(1)):P,P.charAt(0)!="#"&&!P.match(/^\w+:/)&&(P="../"+P),T=te("text:a",T,{"xlink:href":P.replace(/&/g,"&amp;")})}l.push("          "+te("table:table-cell",te("text:p",T,{}),x)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var c=0;c<u["!cols"].length;++c)if(u["!cols"][c]){var h=u["!cols"][c];if(h.width==null&&h.wpx==null&&h.wch==null)continue;W0(h),h.ods=o;var f=u["!cols"][c].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var c=0;c<u["!rows"].length;++c)if(u["!rows"][c]){u["!rows"][c].ods=l;var h=u["!rows"][c].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[ht],u=zo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=zo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+c+`>
`),l.push(My().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function Ew(t,e){if(e.bookType=="fods")return _1(t,e);var r=F0(),n="",i=[],s=[];return n="mimetype",Se(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Se(r,n,_1(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Se(r,n,MI(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Se(r,n,ht+My()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Se(r,n,XC(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Se(r,n,KC(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function cc(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function BI(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Yr($o(t))}function jI(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function vi(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function UI(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function Wo(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Ie(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function qs(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function dt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Wo(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Wo(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function Et(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(Ie(n*8+i.type)),i.type==2&&e.push(Ie(i.data.length)),e.push(i.data))})}),vi(e)}function jr(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Wo(t,n),s=dt(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:qs(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=dt(o.data),u=qs(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=qs(s[3][0].data)>>>0>0),r.push(a)}return r}function gs(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Ie(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ie(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Ie(a.data.length)}],n[2].push({data:Et(a.meta),type:2})});var s=Et(n);e.push(Ie(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),vi(e)}function $I(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Wo(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[vi(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var c=vi(i);if(c.length!=n)throw new Error("Unexpected length: ".concat(c.length," != ").concat(n));return c}function Ur(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push($I(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return vi(e)}function ms(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=Ie(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return vi(e)}function zh(t,e){var r=new Uint8Array(32),n=cc(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,UI(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Wh(t,e){var r=new Uint8Array(32),n=cc(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function jn(t){var e=dt(t);return Wo(e[1][0].data)}function zI(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&qs(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=cc(t[7][0].data),c=0,h=[],f=cc(t[4][0].data),d=0,g=[],p=0;p<e.length;++p){if(e[p]==null){u.setUint16(p*2,65535,!0),f.setUint16(p*2,65535);continue}u.setUint16(p*2,c,!0),f.setUint16(p*2,d,!0);var m,v;switch(typeof e[p]){case"string":m=zh({t:"s",v:e[p]},r),v=Wh({t:"s",v:e[p]},r);break;case"number":m=zh({t:"n",v:e[p]},r),v=Wh({t:"n",v:e[p]},r);break;case"boolean":m=zh({t:"b",v:e[p]},r),v=Wh({t:"b",v:e[p]},r);break;default:throw new Error("Unsupported value "+e[p])}h.push(m),c+=m.length,g.push(v),d+=v.length,++l}for(t[2][0].data=Ie(l);p<t[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),f.setUint16(p*2,65535,!0);return t[6][0].data=vi(h),t[3][0].data=vi(g),l}function WI(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=xr(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ct(n)));var s=hc(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(L){return L.forEach(function(I){typeof I=="string"&&a.push(I)})});var o={},l=[],u=je.read(e.numbers,{type:"base64"});u.FileIndex.map(function(L,I){return[L,u.FullPaths[I]]}).forEach(function(L){var I=L[0],D=L[1];if(I.type==2&&I.name.match(/\.iwa/)){var G=I.content,le=Ur(G),ae=jr(le);ae.forEach(function(fe){l.push(fe.id),o[fe.id]={deps:[],location:D,type:qs(fe.messages[0].meta[1][0].data)}})}}),l.sort(function(L,I){return L-I});var c=l.filter(function(L){return L>1}).map(function(L){return[L,Ie(L)]});u.FileIndex.map(function(L,I){return[L,u.FullPaths[I]]}).forEach(function(L){var I=L[0];if(L[1],!!I.name.match(/\.iwa/)){var D=jr(Ur(I.content));D.forEach(function(G){G.messages.forEach(function(le){c.forEach(function(ae){G.messages.some(function(fe){return qs(fe.meta[1][0].data)!=11006&&jI(fe.data,ae[1])})&&o[ae[0]].deps.push(G.id)})})})}});for(var h=je.find(u,o[1].location),f=jr(Ur(h.content)),d,g=0;g<f.length;++g){var p=f[g];p.id==1&&(d=p)}var m=jn(dt(d.messages[0].data)[1][0].data);for(h=je.find(u,o[m].location),f=jr(Ur(h.content)),g=0;g<f.length;++g)p=f[g],p.id==m&&(d=p);for(m=jn(dt(d.messages[0].data)[2][0].data),h=je.find(u,o[m].location),f=jr(Ur(h.content)),g=0;g<f.length;++g)p=f[g],p.id==m&&(d=p);for(m=jn(dt(d.messages[0].data)[2][0].data),h=je.find(u,o[m].location),f=jr(Ur(h.content)),g=0;g<f.length;++g)p=f[g],p.id==m&&(d=p);var v=dt(d.messages[0].data);{v[6][0].data=Ie(n.e.r+1),v[7][0].data=Ie(n.e.c+1);var x=jn(v[46][0].data),_=je.find(u,o[x].location),w=jr(Ur(_.content));{for(var O=0;O<w.length&&w[O].id!=x;++O);if(w[O].id!=x)throw"Bad ColumnRowUIDMapArchive";var R=dt(w[O].messages[0].data);R[1]=[],R[2]=[],R[3]=[];for(var T=0;T<=n.e.c;++T){var P=[];P[1]=P[2]=[{type:0,data:Ie(T+420690)}],R[1].push({type:2,data:Et(P)}),R[2].push({type:0,data:Ie(T)}),R[3].push({type:0,data:Ie(T)})}R[4]=[],R[5]=[],R[6]=[];for(var F=0;F<=n.e.r;++F)P=[],P[1]=P[2]=[{type:0,data:Ie(F+726270)}],R[4].push({type:2,data:Et(P)}),R[5].push({type:0,data:Ie(F)}),R[6].push({type:0,data:Ie(F)});w[O].messages[0].data=Et(R)}_.content=ms(gs(w)),_.size=_.content.length,delete v[46];var N=dt(v[4][0].data);{N[7][0].data=Ie(n.e.r+1);var U=dt(N[1][0].data),H=jn(U[2][0].data);_=je.find(u,o[H].location),w=jr(Ur(_.content));{if(w[0].id!=H)throw"Bad HeaderStorageBucket";var Z=dt(w[0].messages[0].data);for(F=0;F<s.length;++F){var ve=dt(Z[2][0].data);ve[1][0].data=Ie(F),ve[4][0].data=Ie(s[F].length),Z[2][F]={type:Z[2][0].type,data:Et(ve)}}w[0].messages[0].data=Et(Z)}_.content=ms(gs(w)),_.size=_.content.length;var oe=jn(N[2][0].data);_=je.find(u,o[oe].location),w=jr(Ur(_.content));{if(w[0].id!=oe)throw"Bad HeaderStorageBucket";for(Z=dt(w[0].messages[0].data),T=0;T<=n.e.c;++T)ve=dt(Z[2][0].data),ve[1][0].data=Ie(T),ve[4][0].data=Ie(n.e.r+1),Z[2][T]={type:Z[2][0].type,data:Et(ve)};w[0].messages[0].data=Et(Z)}_.content=ms(gs(w)),_.size=_.content.length;var we=jn(N[4][0].data);(function(){for(var L=je.find(u,o[we].location),I=jr(Ur(L.content)),D,G=0;G<I.length;++G){var le=I[G];le.id==we&&(D=le)}var ae=dt(D.messages[0].data);{ae[3]=[];var fe=[];a.forEach(function(Te,St){fe[1]=[{type:0,data:Ie(St)}],fe[2]=[{type:0,data:Ie(1)}],fe[3]=[{type:2,data:BI(Te)}],ae[3].push({type:2,data:Et(fe)})})}D.messages[0].data=Et(ae);var ie=gs(I),Fe=ms(ie);L.content=Fe,L.size=L.content.length})();var _e=dt(N[3][0].data);{var Y=_e[1][0];delete _e[2];var q=dt(Y.data);{var he=jn(q[2][0].data);(function(){for(var L=je.find(u,o[he].location),I=jr(Ur(L.content)),D,G=0;G<I.length;++G){var le=I[G];le.id==he&&(D=le)}var ae=dt(D.messages[0].data);{delete ae[6],delete _e[7];var fe=new Uint8Array(ae[5][0].data);ae[5]=[];for(var ie=0,Fe=0;Fe<=n.e.r;++Fe){var Te=dt(fe);ie+=zI(Te,s[Fe],a),Te[1][0].data=Ie(Fe),ae[5].push({data:Et(Te),type:2})}ae[1]=[{type:0,data:Ie(n.e.c+1)}],ae[2]=[{type:0,data:Ie(n.e.r+1)}],ae[3]=[{type:0,data:Ie(ie)}],ae[4]=[{type:0,data:Ie(n.e.r+1)}]}D.messages[0].data=Et(ae);var St=gs(I),Ae=ms(St);L.content=Ae,L.size=L.content.length})()}Y.data=Et(q)}N[3][0].data=Et(_e)}v[4][0].data=Et(N)}d.messages[0].data=Et(v);var xe=gs(f),C=ms(xe);return h.content=C,h.size=h.content.length,u}function HI(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Y0(t){HI([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function VI(t,e){return e.bookType=="ods"?Ew(t,e):e.bookType=="numbers"?WI(t,e):e.bookType=="xlsb"?GI(t,e):KI(t,e)}function GI(t,e){Bs=1024,t&&!t.SSF&&(t.SSF=ar(it)),t&&t.SSF&&(jc(),Bc(t.SSF),e.revssf=Uc(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,fo?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=sw.indexOf(e.bookType)>-1,i=Dy();Y0(e=e||{});var s=F0(),a="",o=0;if(e.cellXfs=[],wi(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Se(s,a,By(t.Props,e)),i.coreprops.push(a),De(e.rels,2,a,Oe.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,Se(s,a,Uy(t.Props)),i.extprops.push(a),De(e.rels,3,a,Oe.EXT_PROPS),t.Custprops!==t.Props&&Ft(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Se(s,a,$y(t.Custprops)),i.custprops.push(a),De(e.rels,4,a,Oe.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var c={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Se(s,a,XF(o-1,a,e,t,c)),i.sheets.push(a),De(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Oe.WS[0])}if(h){var d=h["!comments"],g=!1,p="";d&&d.length>0&&(p="xl/comments"+o+"."+r,Se(s,p,QF(d,p)),i.comments.push(p),De(c,-1,"../comments"+o+"."+r,Oe.CMNT),g=!0),h["!legacy"]&&g&&Se(s,"xl/drawings/vmlDrawing"+o+".vml",nw(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}c["!id"].rId1&&Se(s,Ly(a),Ys(c))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Se(s,a,JF(e.Strings,a,e)),i.strs.push(a),De(e.wbrels,-1,"sharedStrings."+r,Oe.SST)),a="xl/workbook."+r,Se(s,a,YF(t,a)),i.workbooks.push(a),De(e.rels,1,a,Oe.WB),a="xl/theme/theme1.xml",Se(s,a,tw(t.Themes,e)),i.themes.push(a),De(e.wbrels,-1,"theme/theme1.xml",Oe.THEME),a="xl/styles."+r,Se(s,a,qF(t,a,e)),i.styles.push(a),De(e.wbrels,-1,"styles."+r,Oe.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Se(s,a,t.vbaraw),i.vba.push(a),De(e.wbrels,-1,"vbaProject.bin",Oe.VBA)),a="xl/metadata."+r,Se(s,a,ZF(a)),i.metadata.push(a),De(e.wbrels,-1,"metadata."+r,Oe.XLMETA),Se(s,"[Content_Types].xml",Ny(i,e)),Se(s,"_rels/.rels",Ys(e.rels)),Se(s,"xl/_rels/workbook."+r+".rels",Ys(e.wbrels)),delete e.revssf,delete e.ssf,s}function KI(t,e){Bs=1024,t&&!t.SSF&&(t.SSF=ar(it)),t&&t.SSF&&(jc(),Bc(t.SSF),e.revssf=Uc(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,fo?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=sw.indexOf(e.bookType)>-1,i=Dy();Y0(e=e||{});var s=F0(),a="",o=0;if(e.cellXfs=[],wi(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Se(s,a,By(t.Props,e)),i.coreprops.push(a),De(e.rels,2,a,Oe.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,Se(s,a,Uy(t.Props)),i.extprops.push(a),De(e.rels,3,a,Oe.EXT_PROPS),t.Custprops!==t.Props&&Ft(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Se(s,a,$y(t.Custprops)),i.custprops.push(a),De(e.rels,4,a,Oe.CUST_PROPS));var c=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},f=t.Sheets[t.SheetNames[o-1]],d=(f||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Se(s,a,pw(o-1,e,t,h)),i.sheets.push(a),De(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Oe.WS[0])}if(f){var g=f["!comments"],p=!1,m="";if(g&&g.length>0){var v=!1;g.forEach(function(x){x[1].forEach(function(_){_.T==!0&&(v=!0)})}),v&&(m="xl/threadedComments/threadedComment"+o+"."+r,Se(s,m,TP(g,c,e)),i.threadedcomments.push(m),De(h,-1,"../threadedComments/threadedComment"+o+"."+r,Oe.TCMNT)),m="xl/comments"+o+"."+r,Se(s,m,iw(g)),i.comments.push(m),De(h,-1,"../comments"+o+"."+r,Oe.CMNT),p=!0}f["!legacy"]&&p&&Se(s,"xl/drawings/vmlDrawing"+o+".vml",nw(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&Se(s,Ly(a),Ys(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Se(s,a,Xy(e.Strings,e)),i.strs.push(a),De(e.wbrels,-1,"sharedStrings."+r,Oe.SST)),a="xl/workbook."+r,Se(s,a,vw(t)),i.workbooks.push(a),De(e.rels,1,a,Oe.WB),a="xl/theme/theme1.xml",Se(s,a,tw(t.Themes,e)),i.themes.push(a),De(e.wbrels,-1,"theme/theme1.xml",Oe.THEME),a="xl/styles."+r,Se(s,a,Zy(t,e)),i.styles.push(a),De(e.wbrels,-1,"styles."+r,Oe.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Se(s,a,t.vbaraw),i.vba.push(a),De(e.wbrels,-1,"vbaProject.bin",Oe.VBA)),a="xl/metadata."+r,Se(s,a,rw()),i.metadata.push(a),De(e.wbrels,-1,"metadata."+r,Oe.XLMETA),c.length>1&&(a="xl/persons/person.xml",Se(s,a,kP(c)),i.people.push(a),De(e.wbrels,-1,"persons/person.xml",Oe.PEOPLE)),Se(s,"[Content_Types].xml",Ny(i,e)),Se(s,"_rels/.rels",Ys(e.rels)),Se(s,"xl/_rels/workbook."+r+".rels",Ys(e.wbrels)),delete e.revssf,delete e.ssf,s}function YI(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Dn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Tw(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return tl(e.file,je.write(t,{type:Pe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return je.write(t,e)}function XI(t,e){var r=ar(e||{}),n=VI(t,r);return qI(n,r)}function qI(t,e){var r={},n=Pe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?je.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Mc(i))}return e.password&&typeof encrypt_agile<"u"?Tw(encrypt_agile(i,e.password),e):e.type==="file"?tl(e.file,i):e.type=="string"?lo(i):i}function JI(t,e){var r=e||{},n=dI(t,r);return Tw(n,r)}function ln(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return jo($o(n));case"binary":return $o(n);case"string":return t;case"file":return tl(e.file,n,"utf8");case"buffer":return Pe?Mn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ln(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function QI(t,e){switch(e.type){case"base64":return jo(t);case"binary":return t;case"string":return t;case"file":return tl(e.file,t,"binary");case"buffer":return Pe?Mn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Vl(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?jo(r):e.type=="string"?lo(r):r;case"file":return tl(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function kw(t,e){bO(),MF(t);var r=ar(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=kw(t,r);return r.type="array",Mc(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ln(hI(t,r),r);case"slk":case"sylk":return ln(D4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return ln(yw(t.Sheets[t.SheetNames[i]],r),r);case"txt":return QI(bw(t.Sheets[t.SheetNames[i]],r),r);case"csv":return ln(X0(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return ln(N4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return Vl(I4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return ln(L4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return ln(W4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return ln(Yy.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return ln(Ew(t,r),r);case"wk1":return Vl(f1.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return Vl(f1.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Vl(_w(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),JI(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return XI(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function ZI(t,e,r,n,i,s,a,o){var l=Pt(r),u=o.defval,c=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,f=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!a||t[r])for(var d=e.s.c;d<=e.e.c;++d){var g=a?t[r][d]:t[n[d]+l];if(g===void 0||g.t===void 0){if(u===void 0)continue;s[d]!=null&&(f[s[d]]=u);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[d]!=null){if(p==null)if(g.t=="e"&&p===null)f[s[d]]=null;else if(u!==void 0)f[s[d]]=u;else if(c&&p===null)f[s[d]]=null;else continue;else f[s[d]]=c&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?p:Nn(g,p,o);p!=null&&(h=!1)}}return{row:f,isempty:h}}function hc(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},c=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof c){case"string":l=Ke(c);break;case"number":l=Ke(t["!ref"]),l.s.r=c;break;default:l=c}n>0&&(i=0);var h=Pt(l.s.r),f=[],d=[],g=0,p=0,m=Array.isArray(t),v=l.s.r,x=0,_={};m&&!t[v]&&(t[v]=[]);var w=u.skipHidden&&t["!cols"]||[],O=u.skipHidden&&t["!rows"]||[];for(x=l.s.c;x<=l.e.c;++x)if(!(w[x]||{}).hidden)switch(f[x]=Ut(x),r=m?t[v][x]:t[f[x]+h],n){case 1:s[x]=x-l.s.c;break;case 2:s[x]=f[x];break;case 3:s[x]=u.header[x-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Nn(r,null,u),p=_[a]||0,!p)_[a]=1;else{do o=a+"_"+p++;while(_[o]);_[a]=p,_[o]=1}s[x]=o}for(v=l.s.r+i;v<=l.e.r;++v)if(!(O[v]||{}).hidden){var R=ZI(t,l,v,f,n,s,m,u);(R.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(d[g++]=R.row)}return d.length=g,d}var y1=/"/g;function eD(t,e,r,n,i,s,a,o){for(var l=!0,u=[],c="",h=Pt(r),f=e.s.c;f<=e.e.c;++f)if(n[f]){var d=o.dense?(t[r]||[])[f]:t[n[f]+h];if(d==null)c="";else if(d.v!=null){l=!1,c=""+(o.rawNumbers&&d.t=="n"?d.v:Nn(d,null,o));for(var g=0,p=0;g!==c.length;++g)if((p=c.charCodeAt(g))===i||p===s||p===34||o.forceQuotes){c='"'+c.replace(y1,'""')+'"';break}c=="ID"&&(c='"ID"')}else d.f!=null&&!d.F?(l=!1,c="="+d.f,c.indexOf(",")>=0&&(c='"'+c.replace(y1,'""')+'"')):c="";u.push(c)}return o.blankrows===!1&&l?null:u.join(a)}function X0(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Ke(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),c="",h=[];n.dense=Array.isArray(t);for(var f=n.skipHidden&&t["!cols"]||[],d=n.skipHidden&&t["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(f[g]||{}).hidden||(h[g]=Ut(g));for(var p=0,m=i.s.r;m<=i.e.r;++m)(d[m]||{}).hidden||(c=eD(t,i,m,h,a,l,s,n),c!=null&&(n.strip&&(c=c.replace(u,"")),(c||n.blankrows!==!1)&&r.push((p++?o:"")+c)));return delete n.dense,r.join("")}function bw(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=X0(t,e);return r}function tD(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Ke(t["!ref"]),s="",a=[],o,l=[],u=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=Ut(o);for(var c=i.s.r;c<=i.e.r;++c)for(s=Pt(c),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=u?(t[c]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function Aw(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?_t(n.origin):n.origin;a=l.r,o=l.c}var u,c={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=Ke(s["!ref"]);c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),a==-1&&(a=h.e.r+1,c.e.r=a+e.length-1+i)}else a==-1&&(a=0,c.e.r=e.length-1+i);var f=n.header||[],d=0;e.forEach(function(p,m){Ft(p).forEach(function(v){(d=f.indexOf(v))==-1&&(f[d=f.length]=v);var x=p[v],_="z",w="",O=Be({c:o+d,r:a+m+i});u=Ho(s,O),x&&typeof x=="object"&&!(x instanceof Date)?s[O]=x:(typeof x=="number"?_="n":typeof x=="boolean"?_="b":typeof x=="string"?_="s":x instanceof Date?(_="d",n.cellDates||(_="n",x=sr(x)),w=n.dateNF||it[14]):x===null&&n.nullError&&(_="e",x=0),u?(u.t=_,u.v=x,delete u.w,delete u.R,w&&(u.z=w)):s[O]=u={t:_,v:x},w&&(u.z=w))})}),c.e.c=Math.max(c.e.c,o+f.length-1);var g=Pt(a);if(i)for(d=0;d<f.length;++d)s[Ut(d+o)+g]={t:"s",v:f[d]};return s["!ref"]=ct(c),s}function rD(t,e){return Aw(null,t,e)}function Ho(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=_t(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Ho(t,Be(e)):Ho(t,Be({r:e,c:r||0}))}function nD(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function iD(){return{SheetNames:[],Sheets:{}}}function sD(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(mw(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function aD(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=nD(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function oD(t,e){return t.z=e,t}function Ow(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function lD(t,e,r){return Ow(t,"#"+e,r)}function uD(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function cD(t,e,r,n){for(var i=typeof e!="string"?e:Ke(e),s=typeof e=="string"?e:ct(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Ho(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Hh={encode_col:Ut,encode_row:Pt,encode_cell:Be,encode_range:ct,decode_col:B0,decode_row:M0,split_cell:bC,decode_cell:_t,decode_range:xr,format_cell:Nn,sheet_add_aoa:Oy,sheet_add_json:Aw,sheet_add_dom:ww,aoa_to_sheet:ga,json_to_sheet:rD,table_to_sheet:Sw,table_to_book:NI,sheet_to_csv:X0,sheet_to_txt:bw,sheet_to_json:hc,sheet_to_html:yw,sheet_to_formulae:tD,sheet_to_row_object_array:hc,sheet_get_cell:Ho,book_new:iD,book_append_sheet:sD,book_set_sheet_visibility:aD,cell_set_number_format:oD,cell_set_hyperlink:Ow,cell_set_internal_link:lD,cell_add_comment:uD,sheet_set_array_formula:cD,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function w1({ratings:t,students:e,subjects:r,filename:n}){const i=new Map(e.map(d=>[d.id,d.name])),s=new Map(r.map(d=>[d.id,d.name])),a=t.map(d=>({Year:d.year,Term:d.term,Student:i.get(d.student_id)??"Unknown student",Subject:s.get(d.subject_id)??"Unknown subject",Rating:d.level}));a.sort((d,g)=>d.Year!==g.Year?d.Year-g.Year:d.Term!==g.Term?d.Term.localeCompare(g.Term):d.Student!==g.Student?d.Student.localeCompare(g.Student):d.Subject.localeCompare(g.Subject));const o=Hh.json_to_sheet(a),l=Hh.book_new();Hh.book_append_sheet(l,o,"Ratings");const u=kw(l,{bookType:"xlsx",type:"array"}),c=new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),h=URL.createObjectURL(c),f=document.createElement("a");return f.href=h,f.download=n,f.click(),URL.revokeObjectURL(h),c}const hD=({filteredRatings:t,allRatings:e,students:r,subjects:n,year:i,term:s,busy:a})=>{const o=()=>{if(t.length===0){alert(`No ratings stored for ${ro[s]} ${i}.`);return}w1({ratings:t,students:r,subjects:n,filename:`ratings_export_${i}_${s}_${Date.now()}.xlsx`})},l=()=>{if(e.length===0){alert("No ratings to export yet.");return}w1({ratings:e,students:r,subjects:n,filename:`ratings_export_all_${Date.now()}.xlsx`})};return z.jsxs("section",{className:"panel","aria-labelledby":"export-heading",children:[z.jsx("header",{className:"panel__header",children:z.jsxs("div",{children:[z.jsx("h2",{id:"export-heading",children:"Export"}),z.jsx("p",{className:"panel__subtitle",children:"Download the ratings grid as Excel (SheetJS). Includes year, term, student, subject, and rating."})]})}),z.jsxs("div",{className:"export-actions",children:[z.jsx("button",{type:"button",onClick:o,disabled:a,children:"Export current view"}),z.jsx("button",{type:"button",className:"button--ghost",onClick:l,disabled:a,children:"Export all years"})]}),z.jsx("p",{className:"helper-text",children:"Filenames are timestamped automatically. Use your spreadsheet tool to pivot, mail merge, or archive."})]})};var od=function(t,e){return od=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},od(t,e)};function Cw(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");od(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var fc=function(){return fc=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},fc.apply(this,arguments)};function xa(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Pw(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(s=(i<3?a(s):i>3?a(e,r,s):a(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Rw(t,e){return function(r,n){e(r,n,t)}}function Fw(t,e,r,n,i,s){function a(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var o=n.kind,l=o==="getter"?"get":o==="setter"?"set":"value",u=!e&&t?n.static?t:t.prototype:null,c=e||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),h,f=!1,d=r.length-1;d>=0;d--){var g={};for(var p in n)g[p]=p==="access"?{}:n[p];for(var p in n.access)g.access[p]=n.access[p];g.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(v||null))};var m=(0,r[d])(o==="accessor"?{get:c.get,set:c.set}:c[l],g);if(o==="accessor"){if(m===void 0)continue;if(m===null||typeof m!="object")throw new TypeError("Object expected");(h=a(m.get))&&(c.get=h),(h=a(m.set))&&(c.set=h),(h=a(m.init))&&i.unshift(h)}else(h=a(m))&&(o==="field"?i.unshift(h):c[l]=h)}u&&Object.defineProperty(u,n.name,c),f=!0}function Iw(t,e,r){for(var n=arguments.length>2,i=0;i<e.length;i++)r=n?e[i].call(t,r):e[i].call(t);return n?r:void 0}function Dw(t){return typeof t=="symbol"?t:"".concat(t)}function Nw(t,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function Lw(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function pe(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(h){a(h)}}function l(c){try{u(n.throw(c))}catch(h){a(h)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(t,e||[])).next())})}function Mw(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(r=0)),r;)try{if(n=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(c){u=[6,c],i=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var Vc=Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]};function Bw(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Vc(e,t,r)}function dc(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function q0(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function jw(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(q0(arguments[e]));return t}function Uw(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],a=0,o=s.length;a<o;a++,i++)n[i]=s[a];return n}function $w(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}function la(t){return this instanceof la?(this.v=t,this):new la(t)}function zw(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(d){return function(g){return Promise.resolve(g).then(d,h)}}function o(d,g){n[d]&&(i[d]=function(p){return new Promise(function(m,v){s.push([d,p,m,v])>1||l(d,p)})},g&&(i[d]=g(i[d])))}function l(d,g){try{u(n[d](g))}catch(p){f(s[0][3],p)}}function u(d){d.value instanceof la?Promise.resolve(d.value.v).then(c,h):f(s[0][2],d)}function c(d){l("next",d)}function h(d){l("throw",d)}function f(d,g){d(g),s.shift(),s.length&&l(s[0][0],s[0][1])}}function Ww(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(a){return(r=!r)?{value:la(t[i](a)),done:!1}:s?s(a):a}:s}}function Hw(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof dc=="function"?dc(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(a){return new Promise(function(o,l){a=t[s](a),i(o,l,a.done,a.value)})}}function i(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}}function Vw(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var fD=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e},ld=function(t){return ld=Object.getOwnPropertyNames||function(e){var r=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[r.length]=n);return r},ld(t)};function Gw(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r=ld(t),n=0;n<r.length;n++)r[n]!=="default"&&Vc(e,t,r[n]);return fD(e,t),e}function Kw(t){return t&&t.__esModule?t:{default:t}}function Yw(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)}function Xw(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r}function qw(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function Jw(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var n,i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose],r&&(i=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),t.stack.push({value:e,dispose:n,async:r})}else r&&t.stack.push({async:!0});return e}var dD=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var n=new Error(r);return n.name="SuppressedError",n.error=t,n.suppressed=e,n};function Qw(t){function e(s){t.error=t.hasError?new dD(s,t.error,"An error was suppressed during disposal."):s,t.hasError=!0}var r,n=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&n===1)return n=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(s).then(i,function(a){return e(a),i()})}else n|=1}catch(a){e(a)}if(n===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}function Zw(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,i,s,a){return n?e?".jsx":".js":i&&(!s||!a)?r:i+s+"."+a.toLowerCase()+"js"}):t}const pD={__extends:Cw,__assign:fc,__rest:xa,__decorate:Pw,__param:Rw,__esDecorate:Fw,__runInitializers:Iw,__propKey:Dw,__setFunctionName:Nw,__metadata:Lw,__awaiter:pe,__generator:Mw,__createBinding:Vc,__exportStar:Bw,__values:dc,__read:q0,__spread:jw,__spreadArrays:Uw,__spreadArray:$w,__await:la,__asyncGenerator:zw,__asyncDelegator:Ww,__asyncValues:Hw,__makeTemplateObject:Vw,__importStar:Gw,__importDefault:Kw,__classPrivateFieldGet:Yw,__classPrivateFieldSet:Xw,__classPrivateFieldIn:qw,__addDisposableResource:Jw,__disposeResources:Qw,__rewriteRelativeImportExtension:Zw},gD=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Jw,get __assign(){return fc},__asyncDelegator:Ww,__asyncGenerator:zw,__asyncValues:Hw,__await:la,__awaiter:pe,__classPrivateFieldGet:Yw,__classPrivateFieldIn:qw,__classPrivateFieldSet:Xw,__createBinding:Vc,__decorate:Pw,__disposeResources:Qw,__esDecorate:Fw,__exportStar:Bw,__extends:Cw,__generator:Mw,__importDefault:Kw,__importStar:Gw,__makeTemplateObject:Vw,__metadata:Lw,__param:Rw,__propKey:Dw,__read:q0,__rest:xa,__rewriteRelativeImportExtension:Zw,__runInitializers:Iw,__setFunctionName:Nw,__spread:jw,__spreadArray:$w,__spreadArrays:Uw,__values:dc,default:pD},Symbol.toStringTag,{value:"Module"})),mD=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class J0 extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class vD extends J0{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class S1 extends J0{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class E1 extends J0{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ud;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ud||(ud={}));class xD{constructor(e,{headers:r={},customFetch:n,region:i=ud.Any}={}){this.url=e,this.headers=r,this.region=i,this.fetch=mD(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return pe(this,arguments,void 0,function*(r,n={}){var i;let s,a;try{const{headers:o,method:l,body:u,signal:c,timeout:h}=n;let f={},{region:d}=n;d||(d=this.region);const g=new URL(`${this.url}/${r}`);d&&d!=="any"&&(f["x-region"]=d,g.searchParams.set("forceFunctionRegion",d));let p;u&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",p=u):typeof u=="string"?(f["Content-Type"]="text/plain",p=u):typeof FormData<"u"&&u instanceof FormData?p=u:(f["Content-Type"]="application/json",p=JSON.stringify(u)):p=u;let m=c;h&&(a=new AbortController,s=setTimeout(()=>a.abort(),h),c?(m=a.signal,c.addEventListener("abort",()=>a.abort())):m=a.signal);const v=yield this.fetch(g.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),o),body:p,signal:m}).catch(O=>{throw new vD(O)}),x=v.headers.get("x-relay-error");if(x&&x==="true")throw new S1(v);if(!v.ok)throw new E1(v);let _=((i=v.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),w;return _==="application/json"?w=yield v.json():_==="application/octet-stream"||_==="application/pdf"?w=yield v.blob():_==="text/event-stream"?w=v:_==="multipart/form-data"?w=yield v.formData():w=yield v.text(),{data:w,error:null,response:v}}catch(o){return{data:null,error:o,response:o instanceof E1||o instanceof S1?o.context:void 0}}finally{s&&clearTimeout(s)}})}}var Gt={};const _a=Z2(gD);var Gl={},Kl={},Yl={},Xl={},ql={},Jl={},T1;function e2(){if(T1)return Jl;T1=1,Object.defineProperty(Jl,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Jl.default=t,Jl}var k1;function t2(){if(k1)return ql;k1=1,Object.defineProperty(ql,"__esModule",{value:!0});const e=_a.__importDefault(e2());class r{constructor(i){var s,a;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(s=i.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=i.signal,this.isMaybeSingle=(a=i.isMaybeSingle)!==null&&a!==void 0?a:!1,i.fetch?this.fetch=i.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,s){return this.headers=new Headers(this.headers),this.headers.set(i,s),this}then(i,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let o=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var u,c,h,f;let d=null,g=null,p=null,m=l.status,v=l.statusText;if(l.ok){if(this.method!=="HEAD"){const O=await l.text();O===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?g=O:g=JSON.parse(O))}const _=(c=this.headers.get("Prefer"))===null||c===void 0?void 0:c.match(/count=(exact|planned|estimated)/),w=(h=l.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");_&&w&&w.length>1&&(p=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(d={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,p=null,m=406,v="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const _=await l.text();try{d=JSON.parse(_),Array.isArray(d)&&l.status===404&&(g=[],d=null,m=200,v="OK")}catch{l.status===404&&_===""?(m=204,v="No Content"):d={message:_}}if(d&&this.isMaybeSingle&&(!((f=d==null?void 0:d.details)===null||f===void 0)&&f.includes("0 rows"))&&(d=null,m=200,v="OK"),d&&this.shouldThrowOnError)throw new e.default(d)}return{error:d,data:g,count:p,status:m,statusText:v}});return this.shouldThrowOnError||(o=o.catch(l=>{var u,c,h;return{error:{message:`${(u=l==null?void 0:l.name)!==null&&u!==void 0?u:"FetchError"}: ${l==null?void 0:l.message}`,details:`${(c=l==null?void 0:l.stack)!==null&&c!==void 0?c:""}`,hint:"",code:`${(h=l==null?void 0:l.code)!==null&&h!==void 0?h:""}`},data:null,count:null,status:0,statusText:""}})),o.then(i,s)}returns(){return this}overrideTypes(){return this}}return ql.default=r,ql}var b1;function r2(){if(b1)return Xl;b1=1,Object.defineProperty(Xl,"__esModule",{value:!0});const e=_a.__importDefault(t2());class r extends e.default{select(i){let s=!1;const a=(i??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:s=!0,nullsFirst:a,foreignTable:o,referencedTable:l=o}={}){const u=l?`${l}.order`:"order",c=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${c?`${c},`:""}${i}.${s?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:s,referencedTable:a=s}={}){const o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(o,`${i}`),this}range(i,s,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"offset":`${o}.offset`,u=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${i}`),this.url.searchParams.set(u,`${s-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:s=!1,settings:a=!1,buffers:o=!1,wal:l=!1,format:u="text"}={}){var c;const h=[i?"analyze":null,s?"verbose":null,a?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),f=(c=this.headers.get("Accept"))!==null&&c!==void 0?c:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${f}"; options=${h};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}}return Xl.default=r,Xl}var A1;function Q0(){if(A1)return Yl;A1=1,Object.defineProperty(Yl,"__esModule",{value:!0});const e=_a.__importDefault(r2()),r=new RegExp("[,()]");class n extends e.default{eq(s,a){return this.url.searchParams.append(s,`eq.${a}`),this}neq(s,a){return this.url.searchParams.append(s,`neq.${a}`),this}gt(s,a){return this.url.searchParams.append(s,`gt.${a}`),this}gte(s,a){return this.url.searchParams.append(s,`gte.${a}`),this}lt(s,a){return this.url.searchParams.append(s,`lt.${a}`),this}lte(s,a){return this.url.searchParams.append(s,`lte.${a}`),this}like(s,a){return this.url.searchParams.append(s,`like.${a}`),this}likeAllOf(s,a){return this.url.searchParams.append(s,`like(all).{${a.join(",")}}`),this}likeAnyOf(s,a){return this.url.searchParams.append(s,`like(any).{${a.join(",")}}`),this}ilike(s,a){return this.url.searchParams.append(s,`ilike.${a}`),this}ilikeAllOf(s,a){return this.url.searchParams.append(s,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(s,a){return this.url.searchParams.append(s,`ilike(any).{${a.join(",")}}`),this}is(s,a){return this.url.searchParams.append(s,`is.${a}`),this}in(s,a){const o=Array.from(new Set(a)).map(l=>typeof l=="string"&&r.test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(s,`in.(${o})`),this}contains(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cs.{${a.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(a)}`),this}containedBy(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cd.{${a.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(a)}`),this}rangeGt(s,a){return this.url.searchParams.append(s,`sr.${a}`),this}rangeGte(s,a){return this.url.searchParams.append(s,`nxl.${a}`),this}rangeLt(s,a){return this.url.searchParams.append(s,`sl.${a}`),this}rangeLte(s,a){return this.url.searchParams.append(s,`nxr.${a}`),this}rangeAdjacent(s,a){return this.url.searchParams.append(s,`adj.${a}`),this}overlaps(s,a){return typeof a=="string"?this.url.searchParams.append(s,`ov.${a}`):this.url.searchParams.append(s,`ov.{${a.join(",")}}`),this}textSearch(s,a,{config:o,type:l}={}){let u="";l==="plain"?u="pl":l==="phrase"?u="ph":l==="websearch"&&(u="w");const c=o===void 0?"":`(${o})`;return this.url.searchParams.append(s,`${u}fts${c}.${a}`),this}match(s){return Object.entries(s).forEach(([a,o])=>{this.url.searchParams.append(a,`eq.${o}`)}),this}not(s,a,o){return this.url.searchParams.append(s,`not.${a}.${o}`),this}or(s,{foreignTable:a,referencedTable:o=a}={}){const l=o?`${o}.or`:"or";return this.url.searchParams.append(l,`(${s})`),this}filter(s,a,o){return this.url.searchParams.append(s,`${a}.${o}`),this}}return Yl.default=n,Yl}var O1;function n2(){if(O1)return Kl;O1=1,Object.defineProperty(Kl,"__esModule",{value:!0});const e=_a.__importDefault(Q0());class r{constructor(i,{headers:s={},schema:a,fetch:o}){this.url=i,this.headers=new Headers(s),this.schema=a,this.fetch=o}select(i,s){const{head:a=!1,count:o}=s??{},l=a?"HEAD":"GET";let u=!1;const c=(i??"*").split("").map(h=>/\s/.test(h)&&!u?"":(h==='"'&&(u=!u),h)).join("");return this.url.searchParams.set("select",c),o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:s,defaultToNull:a=!0}={}){var o;const l="POST";if(s&&this.headers.append("Prefer",`count=${s}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const u=i.reduce((c,h)=>c.concat(Object.keys(h)),[]);if(u.length>0){const c=[...new Set(u)].map(h=>`"${h}"`);this.url.searchParams.set("columns",c.join(","))}}return new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(i,{onConflict:s,ignoreDuplicates:a=!1,count:o,defaultToNull:l=!0}={}){var u;const c="POST";if(this.headers.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),o&&this.headers.append("Prefer",`count=${o}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const h=i.reduce((f,d)=>f.concat(Object.keys(d)),[]);if(h.length>0){const f=[...new Set(h)].map(d=>`"${d}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(i,{count:s}={}){var a;const o="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:i}={}){var s;const a="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}}return Kl.default=r,Kl}var C1;function _D(){if(C1)return Gl;C1=1,Object.defineProperty(Gl,"__esModule",{value:!0});const t=_a,e=t.__importDefault(n2()),r=t.__importDefault(Q0());class n{constructor(s,{headers:a={},schema:o,fetch:l}={}){this.url=s,this.headers=new Headers(a),this.schemaName=o,this.fetch=l}from(s){const a=new URL(`${this.url}/${s}`);return new e.default(a,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new n(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,a={},{head:o=!1,get:l=!1,count:u}={}){var c;let h;const f=new URL(`${this.url}/rpc/${s}`);let d;o||l?(h=o?"HEAD":"GET",Object.entries(a).filter(([p,m])=>m!==void 0).map(([p,m])=>[p,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([p,m])=>{f.searchParams.append(p,m)})):(h="POST",d=a);const g=new Headers(this.headers);return u&&g.set("Prefer",`count=${u}`),new r.default({method:h,url:f,headers:g,schema:this.schemaName,body:d,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}}return Gl.default=n,Gl}Object.defineProperty(Gt,"__esModule",{value:!0});var i2=Gt.PostgrestError=p2=Gt.PostgrestBuilder=f2=Gt.PostgrestTransformBuilder=c2=Gt.PostgrestFilterBuilder=l2=Gt.PostgrestQueryBuilder=a2=Gt.PostgrestClient=void 0;const ya=_a,s2=ya.__importDefault(_D());var a2=Gt.PostgrestClient=s2.default;const o2=ya.__importDefault(n2());var l2=Gt.PostgrestQueryBuilder=o2.default;const u2=ya.__importDefault(Q0());var c2=Gt.PostgrestFilterBuilder=u2.default;const h2=ya.__importDefault(r2());var f2=Gt.PostgrestTransformBuilder=h2.default;const d2=ya.__importDefault(t2());var p2=Gt.PostgrestBuilder=d2.default;const g2=ya.__importDefault(e2());i2=Gt.PostgrestError=g2.default;var m2=Gt.default={PostgrestClient:s2.default,PostgrestQueryBuilder:o2.default,PostgrestFilterBuilder:u2.default,PostgrestTransformBuilder:h2.default,PostgrestBuilder:d2.default,PostgrestError:g2.default};const yD=J2({__proto__:null,get PostgrestBuilder(){return p2},get PostgrestClient(){return a2},get PostgrestError(){return i2},get PostgrestFilterBuilder(){return c2},get PostgrestQueryBuilder(){return l2},get PostgrestTransformBuilder(){return f2},default:m2},[Gt]),{PostgrestClient:wD,PostgrestQueryBuilder:L8,PostgrestFilterBuilder:M8,PostgrestTransformBuilder:B8,PostgrestBuilder:j8,PostgrestError:U8}=m2||yD;class SD{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const n=this.getWebSocketConstructor();return new n(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const ED="2.81.1",TD=`realtime-js/${ED}`,v2="1.0.0",kD="2.0.0",P1=v2,cd=1e4,bD=1e3,AD=100;var Mi;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Mi||(Mi={}));var ft;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(ft||(ft={}));var br;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(br||(br={}));var hd;(function(t){t.websocket="websocket"})(hd||(hd={}));var Bi;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Bi||(Bi={}));class OD{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(e,r){if(this._isArrayBuffer(e.payload))return r(this._binaryEncodePush(e));if(e.event===this.BROADCAST&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(n))}_binaryEncodePush(e){const{join_ref:r,ref:n,event:i,topic:s,payload:a}=e,o=this.META_LENGTH+r.length+n.length+s.length+i.length,l=new ArrayBuffer(this.HEADER_LENGTH+o);let u=new DataView(l),c=0;u.setUint8(c++,this.KINDS.push),u.setUint8(c++,r.length),u.setUint8(c++,n.length),u.setUint8(c++,s.length),u.setUint8(c++,i.length),Array.from(r,f=>u.setUint8(c++,f.charCodeAt(0))),Array.from(n,f=>u.setUint8(c++,f.charCodeAt(0))),Array.from(s,f=>u.setUint8(c++,f.charCodeAt(0))),Array.from(i,f=>u.setUint8(c++,f.charCodeAt(0)));var h=new Uint8Array(l.byteLength+a.byteLength);return h.set(new Uint8Array(l),0),h.set(new Uint8Array(a),l.byteLength),h.buffer}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,n;const{join_ref:i,ref:s,topic:a}=e,o=e.payload.event,l=(n=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0),u=this.USER_BROADCAST_PUSH_META_LENGTH+i.length+s.length+a.length+o.length,c=new ArrayBuffer(this.HEADER_LENGTH+u);let h=new DataView(c),f=0;h.setUint8(f++,this.KINDS.userBroadcastPush),h.setUint8(f++,i.length),h.setUint8(f++,s.length),h.setUint8(f++,a.length),h.setUint8(f++,o.length),h.setUint8(f++,this.BINARY_ENCODING),Array.from(i,g=>h.setUint8(f++,g.charCodeAt(0))),Array.from(s,g=>h.setUint8(f++,g.charCodeAt(0))),Array.from(a,g=>h.setUint8(f++,g.charCodeAt(0))),Array.from(o,g=>h.setUint8(f++,g.charCodeAt(0)));var d=new Uint8Array(c.byteLength+l.byteLength);return d.set(new Uint8Array(c),0),d.set(new Uint8Array(l),c.byteLength),d.buffer}_encodeJsonUserBroadcastPush(e){var r,n;const{join_ref:i,ref:s,topic:a}=e,o=e.payload.event,l=(n=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},c=new TextEncoder().encode(JSON.stringify(l)).buffer,h=this.USER_BROADCAST_PUSH_META_LENGTH+i.length+s.length+a.length+o.length,f=new ArrayBuffer(this.HEADER_LENGTH+h);let d=new DataView(f),g=0;d.setUint8(g++,this.KINDS.userBroadcastPush),d.setUint8(g++,i.length),d.setUint8(g++,s.length),d.setUint8(g++,a.length),d.setUint8(g++,o.length),d.setUint8(g++,this.JSON_ENCODING),Array.from(i,m=>d.setUint8(g++,m.charCodeAt(0))),Array.from(s,m=>d.setUint8(g++,m.charCodeAt(0))),Array.from(a,m=>d.setUint8(g++,m.charCodeAt(0))),Array.from(o,m=>d.setUint8(g++,m.charCodeAt(0)));var p=new Uint8Array(f.byteLength+c.byteLength);return p.set(new Uint8Array(f),0),p.set(new Uint8Array(c),f.byteLength),p.buffer}decode(e,r){if(this._isArrayBuffer(e)){let n=this._binaryDecode(e);return r(n)}if(typeof e=="string"){const n=JSON.parse(e),[i,s,a,o,l]=n;return r({join_ref:i,ref:s,topic:a,event:o,payload:l})}return r({})}_binaryDecode(e){const r=new DataView(e),n=r.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.push:return this._decodePush(e,r,i);case this.KINDS.reply:return this._decodeReply(e,r,i);case this.KINDS.broadcast:return this._decodeBroadcast(e,r,i);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,i)}}_decodePush(e,r,n){const i=r.getUint8(1),s=r.getUint8(2),a=r.getUint8(3);let o=this.HEADER_LENGTH+this.META_LENGTH-1;const l=n.decode(e.slice(o,o+i));o=o+i;const u=n.decode(e.slice(o,o+s));o=o+s;const c=n.decode(e.slice(o,o+a));o=o+a;const h=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{join_ref:l,ref:null,topic:u,event:c,payload:h}}_decodeReply(e,r,n){const i=r.getUint8(1),s=r.getUint8(2),a=r.getUint8(3),o=r.getUint8(4);let l=this.HEADER_LENGTH+this.META_LENGTH;const u=n.decode(e.slice(l,l+i));l=l+i;const c=n.decode(e.slice(l,l+s));l=l+s;const h=n.decode(e.slice(l,l+a));l=l+a;const f=n.decode(e.slice(l,l+o));l=l+o;const d=JSON.parse(n.decode(e.slice(l,e.byteLength))),g={status:f,response:d};return{join_ref:u,ref:c,topic:h,event:br.reply,payload:g}}_decodeBroadcast(e,r,n){const i=r.getUint8(1),s=r.getUint8(2);let a=this.HEADER_LENGTH+2;const o=n.decode(e.slice(a,a+i));a=a+i;const l=n.decode(e.slice(a,a+s));a=a+s;const u=JSON.parse(n.decode(e.slice(a,e.byteLength)));return{join_ref:null,ref:null,topic:o,event:l,payload:u}}_decodeUserBroadcast(e,r,n){const i=r.getUint8(1),s=r.getUint8(2),a=r.getUint8(3),o=r.getUint8(4);let l=this.HEADER_LENGTH+4;const u=n.decode(e.slice(l,l+i));l=l+i;const c=n.decode(e.slice(l,l+s));l=l+s;const h=n.decode(e.slice(l,l+a));l=l+a;const f=e.slice(l,e.byteLength),d=o===this.JSON_ENCODING?JSON.parse(n.decode(f)):f,g={type:this.BROADCAST,event:c,payload:d};return a>0&&(g.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST,payload:g}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e==null?void 0:e.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}}class x2{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ze;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(ze||(ze={}));const R1=(t,e,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((s,a)=>(s[a]=CD(a,t,e,i),s),{}):{}},CD=(t,e,r,n)=>{const i=e.find(o=>o.name===t),s=i==null?void 0:i.type,a=r[t];return s&&!n.includes(s)?_2(s,a):fd(a)},_2=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return ID(e,r)}switch(t){case ze.bool:return PD(e);case ze.float4:case ze.float8:case ze.int2:case ze.int4:case ze.int8:case ze.numeric:case ze.oid:return RD(e);case ze.json:case ze.jsonb:return FD(e);case ze.timestamp:return DD(e);case ze.abstime:case ze.date:case ze.daterange:case ze.int4range:case ze.int8range:case ze.money:case ze.reltime:case ze.text:case ze.time:case ze.timestamptz:case ze.timetz:case ze.tsrange:case ze.tstzrange:return fd(e);default:return fd(e)}},fd=t=>t,PD=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},RD=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},FD=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},ID=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let s;const a=t.slice(1,r);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>_2(e,o))}return t},DD=t=>typeof t=="string"?t.replace(" ","T"):t,y2=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Vh{constructor(e,r,n={},i=cd){this.channel=e,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var F1;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(F1||(F1={}));class po{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=po.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=po.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=po.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,i){const s=this.cloneDeep(e),a=this.transformState(r),o={},l={};return this.map(s,(u,c)=>{a[u]||(l[u]=c)}),this.map(a,(u,c)=>{const h=s[u];if(h){const f=c.map(m=>m.presence_ref),d=h.map(m=>m.presence_ref),g=c.filter(m=>d.indexOf(m.presence_ref)<0),p=h.filter(m=>f.indexOf(m.presence_ref)<0);g.length>0&&(o[u]=g),p.length>0&&(l[u]=p)}else o[u]=c}),this.syncDiff(s,{joins:o,leaves:l},n,i)}static syncDiff(e,r,n,i){const{joins:s,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var u;const c=(u=e[o])!==null&&u!==void 0?u:[];if(e[o]=this.cloneDeep(l),c.length>0){const h=e[o].map(d=>d.presence_ref),f=c.filter(d=>h.indexOf(d.presence_ref)<0);e[o].unshift(...f)}n(o,c,l)}),this.map(a,(o,l)=>{let u=e[o];if(!u)return;const c=l.map(h=>h.presence_ref);u=u.filter(h=>c.indexOf(h.presence_ref)<0),e[o]=u,i(o,u,l),u.length===0&&delete e[o]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const i=e[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var I1;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(I1||(I1={}));var go;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(go||(go={}));var wn;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(wn||(wn={}));class Z0{constructor(e,r={config:{}},n){var i,s;if(this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=ft.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Vh(this,br.join,this.params,this.timeout),this.rejoinTimer=new x2(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ft.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ft.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=ft.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ft.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=ft.errored,this.rejoinTimer.scheduleTimeout())}),this._on(br.reply,{},(a,o)=>{this._trigger(this._replyEventName(o),a)}),this.presence=new po(this),this.broadcastEndpointURL=y2(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var n,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==ft.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,u=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&i!==void 0?i:[],c=!!this.bindings[go.PRESENCE]&&this.bindings[go.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,h={},f={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:c}),postgres_changes:u,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(d=>e==null?void 0:e(wn.CHANNEL_ERROR,d)),this._onClose(()=>e==null?void 0:e(wn.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var g;if(this.socket.setAuth(),d===void 0){e==null||e(wn.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,m=(g=p==null?void 0:p.length)!==null&&g!==void 0?g:0,v=[];for(let x=0;x<m;x++){const _=p[x],{filter:{event:w,schema:O,table:R,filter:T}}=_,P=d&&d[x];if(P&&P.event===w&&P.schema===O&&P.table===R&&P.filter===T)v.push(Object.assign(Object.assign({},_),{id:P.id}));else{this.unsubscribe(),this.state=ft.errored,e==null||e(wn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(wn.SUBSCRIBED);return}}).receive("error",d=>{this.state=ft.errored,e==null||e(wn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(wn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this.state===ft.joined&&e===go.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,n)}async httpSend(e,r,n={}){var i;const s=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const a={method:"POST",headers:{Authorization:s,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const u=await o.json();l=u.error||u.message||l}catch{}return Promise.reject(new Error(l))}async send(e,r={}){var n,i;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const u=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ft.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(br.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Vh(this,br.leave,{},e),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ft.closed,this.bindings={}}async _fetchWithTimeout(e,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),a}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Vh(this,e,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>AD){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var i,s;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:u,join:c}=br;if(n&&[o,l,u,c].indexOf(a)>=0&&n!==this._joinRef())return;let f=this._onMessage(a,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(d=>{var g,p,m;return((g=d.filter)===null||g===void 0?void 0:g.event)==="*"||((m=(p=d.filter)===null||p===void 0?void 0:p.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===a}).map(d=>d.callback(f,n)):(s=this.bindings[a])===null||s===void 0||s.filter(d=>{var g,p,m,v,x,_;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in d){const w=d.id,O=(g=d.filter)===null||g===void 0?void 0:g.event;return w&&((p=r.ids)===null||p===void 0?void 0:p.includes(w))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((m=r.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const w=(x=(v=d==null?void 0:d.filter)===null||v===void 0?void 0:v.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return w==="*"||w===((_=r==null?void 0:r.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return d.type.toLocaleLowerCase()===a}).map(d=>{if(typeof f=="object"&&"ids"in f){const g=f.data,{schema:p,table:m,commit_timestamp:v,type:x,errors:_}=g;f=Object.assign(Object.assign({},{schema:p,table:m,commit_timestamp:v,eventType:x,new:{},old:{},errors:_}),this._getPayloadRecords(g))}d.callback(f,n)})}_isClosed(){return this.state===ft.closed}_isJoined(){return this.state===ft.joined}_isJoining(){return this.state===ft.joining}_isLeaving(){return this.state===ft.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const i=e.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Z0.isEqual(i.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(br.close,{},e)}_onError(e){this._on(br.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ft.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=R1(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=R1(e.columns,e.old_record)),r}}const Gh=()=>{},Ql={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},ND=[1e3,2e3,5e3,1e4],LD=1e4,MD=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class BD{constructor(e,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=cd,this.transport=null,this.heartbeatIntervalMs=Ql.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Gh,this.ref=0,this.reconnectTimer=null,this.vsn=P1,this.logger=Gh,this.conn=null,this.sendBuffer=[],this.serializer=new OD,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${hd.websocket}`,this.httpEndpoint=y2(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=SD.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Mi.connecting:return Bi.Connecting;case Mi.open:return Bi.Open;case Mi.closing:return Bi.Closing;default:return Bi.Closed}}isConnected(){return this.connectionState()===Bi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const n=`realtime:${e}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new Z0(`realtime:${e}`,r,this);return this.channels.push(s),s}}push(e){const{topic:r,event:n,payload:i,ref:s}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(bD,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Ql.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:s,ref:a}=r,o=a?`(${a})`:"",l=s.status||"";this.log("receive",`${l} ${n} ${i} ${o}`.trim(),s),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(i,s,a)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Mi.open||this.conn.readyState===Mi.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(br.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${e}${n}${i}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([MD],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:TD};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(br.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new x2(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ql.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,i,s,a,o,l,u,c,h,f,d;switch(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:cd,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:Ql.HEARTBEAT_INTERVAL,this.worker=(s=e==null?void 0:e.worker)!==null&&s!==void 0?s:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(o=e==null?void 0:e.heartbeatCallback)!==null&&o!==void 0?o:Gh,this.vsn=(l=e==null?void 0:e.vsn)!==null&&l!==void 0?l:P1,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:g=>ND[g-1]||LD,this.vsn){case v2:this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(g,p)=>p(JSON.stringify(g)),this.decode=(h=e==null?void 0:e.decode)!==null&&h!==void 0?h:(g,p)=>p(JSON.parse(g));break;case kD:this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class ep extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Qe(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class jD extends ep{constructor(e,r,n){super(e),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class dd extends ep{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}const tp=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),UD=()=>Response,pd=t=>{if(Array.isArray(t))return t.map(r=>pd(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=pd(n)}),e},$D=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Kh=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},zD=(t,e,r)=>pe(void 0,void 0,void 0,function*(){const n=yield UD();t instanceof n&&!(r!=null&&r.noResolveJson)?t.json().then(i=>{const s=t.status||500,a=(i==null?void 0:i.statusCode)||s+"";e(new jD(Kh(i),s,a))}).catch(i=>{e(new dd(Kh(i),i))}):e(new dd(Kh(t),t))}),WD=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!n?i:($D(n)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n)):i.body=n,e!=null&&e.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),r))};function al(t,e,r,n,i,s){return pe(this,void 0,void 0,function*(){return new Promise((a,o)=>{t(r,WD(e,n,i,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>zD(l,o,n))})})}function Vo(t,e,r,n){return pe(this,void 0,void 0,function*(){return al(t,"GET",e,r,n)})}function Hr(t,e,r,n,i){return pe(this,void 0,void 0,function*(){return al(t,"POST",e,n,i,r)})}function gd(t,e,r,n,i){return pe(this,void 0,void 0,function*(){return al(t,"PUT",e,n,i,r)})}function HD(t,e,r,n){return pe(this,void 0,void 0,function*(){return al(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function rp(t,e,r,n,i){return pe(this,void 0,void 0,function*(){return al(t,"DELETE",e,n,i,r)})}class VD{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}execute(){return pe(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Qe(e))return{data:null,error:e};throw e}})}}var w2;class GD{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[w2]="BlobDownloadBuilder",this.promise=null}asStream(){return new VD(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.getPromise().then(e,r)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return pe(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Qe(e))return{data:null,error:e};throw e}})}}w2=Symbol.toStringTag;const KD={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},D1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class YD{constructor(e,r={},n,i){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=n,this.fetch=tp(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,n,i){return pe(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},D1),i);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.has("cacheControl")||s.append("cacheControl",a.cacheControl),l&&!s.has("metadata")&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!a.duplex&&(a.duplex="half")),i!=null&&i.headers&&(o=Object.assign(Object.assign({},o),i.headers));const u=this._removeEmptyFolders(r),c=this._getFinalPath(u),h=yield(e=="PUT"?gd:Hr)(this.fetch,`${this.url}/object/${c}`,s,Object.assign({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Qe(s))return{data:null,error:s};throw s}})}upload(e,r,n){return pe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,i){return pe(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",r);try{let l;const u=Object.assign({upsert:D1.upsert},i),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",u.cacheControl)):(l=n,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const h=yield gd(this.fetch,o.toString(),l,{headers:c});return{data:{path:s,fullPath:h.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Qe(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,r){return pe(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const s=yield Hr(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new ep("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qe(n))return{data:null,error:n};throw n}})}update(e,r,n){return pe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return pe(this,void 0,void 0,function*(){try{return{data:yield Hr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Qe(i))return{data:null,error:i};throw i}})}copy(e,r,n){return pe(this,void 0,void 0,function*(){try{return{data:{path:(yield Hr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Qe(i))return{data:null,error:i};throw i}})}createSignedUrl(e,r,n){return pe(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield Hr(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Qe(i))return{data:null,error:i};throw i}})}createSignedUrls(e,r,n){return pe(this,void 0,void 0,function*(){try{const i=yield Hr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Qe(i))return{data:null,error:i};throw i}})}download(e,r){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=s?`?${s}`:"",o=this._getFinalPath(e),l=()=>Vo(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0});return new GD(l,this.shouldThrowOnError)}info(e){return pe(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield Vo(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:pd(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qe(n))return{data:null,error:n};throw n}})}exists(e){return pe(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield HD(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qe(n)&&n instanceof dd){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),i=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&i.push(l);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${u}`)}}}remove(e){return pe(this,void 0,void 0,function*(){try{return{data:yield rp(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qe(r))return{data:null,error:r};throw r}})}list(e,r,n){return pe(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},KD),r),{prefix:e||""});return{data:yield Hr(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Qe(i))return{data:null,error:i};throw i}})}listV2(e,r){return pe(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield Hr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qe(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const S2="2.81.1",E2={"X-Client-Info":`storage-js/${S2}`};class XD{constructor(e,r={},n,i){this.shouldThrowOnError=!1;const s=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},E2),r),this.fetch=tp(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return pe(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(e);return{data:yield Vo(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qe(r))return{data:null,error:r};throw r}})}getBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:yield Vo(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qe(r))return{data:null,error:r};throw r}})}createBucket(e){return pe(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield Hr(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Qe(i))return{data:null,error:i};throw i}})}updateBucket(e,r){return pe(this,void 0,void 0,function*(){try{return{data:yield gd(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qe(n))return{data:null,error:n};throw n}})}emptyBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:yield Hr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qe(r))return{data:null,error:r};throw r}})}deleteBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:yield rp(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qe(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(e){const r={};return e&&("limit"in e&&(r.limit=String(e.limit)),"offset"in e&&(r.offset=String(e.offset)),e.search&&(r.search=e.search),e.sortColumn&&(r.sortColumn=e.sortColumn),e.sortOrder&&(r.sortOrder=e.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class qD{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},E2),r),this.fetch=tp(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:yield Hr(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qe(r))return{data:null,error:r};throw r}})}listBuckets(e){return pe(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),i=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield Vo(this.fetch,i,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qe(r))return{data:null,error:r};throw r}})}deleteBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:yield rp(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qe(r))return{data:null,error:r};throw r}})}}const np={"X-Client-Info":`storage-js/${S2}`,"Content-Type":"application/json"};class T2 extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function dr(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class Yh extends T2{constructor(e,r,n){super(e),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class JD extends T2{constructor(e,r){super(e),this.name="StorageVectorsUnknownError",this.originalError=r}}var N1;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(N1||(N1={}));const ip=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),QD=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},L1=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),ZD=(t,e,r)=>pe(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(r!=null&&r.noResolveJson)){const i=t.status||500,s=t;if(typeof s.json=="function")s.json().then(a=>{const o=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||i+"";e(new Yh(L1(a),i,o))}).catch(()=>{const a=i+"",o=s.statusText||`HTTP ${i} error`;e(new Yh(o,i,a))});else{const a=i+"",o=s.statusText||`HTTP ${i} error`;e(new Yh(o,i,a))}}else e(new JD(L1(t),t))}),eN=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return n?(QD(n)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n)):i.body=n,Object.assign(Object.assign({},i),r)):i};function tN(t,e,r,n,i,s){return pe(this,void 0,void 0,function*(){return new Promise((a,o)=>{t(r,eN(e,n,i,s)).then(l=>{if(!l.ok)throw l;if(n!=null&&n.noResolveJson)return l;const u=l.headers.get("content-type");return!u||!u.includes("application/json")?{}:l.json()}).then(l=>a(l)).catch(l=>ZD(l,o,n))})})}function pr(t,e,r,n,i){return pe(this,void 0,void 0,function*(){return tN(t,"POST",e,n,i,r)})}class rN{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},np),r),this.fetch=ip(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return pe(this,void 0,void 0,function*(){try{return{data:(yield pr(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dr(r))return{data:null,error:r};throw r}})}getIndex(e,r){return pe(this,void 0,void 0,function*(){try{return{data:yield pr(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(dr(n))return{data:null,error:n};throw n}})}listIndexes(e){return pe(this,void 0,void 0,function*(){try{return{data:yield pr(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dr(r))return{data:null,error:r};throw r}})}deleteIndex(e,r){return pe(this,void 0,void 0,function*(){try{return{data:(yield pr(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(dr(n))return{data:null,error:n};throw n}})}}class nN{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},np),r),this.fetch=ip(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return pe(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield pr(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dr(r))return{data:null,error:r};throw r}})}getVectors(e){return pe(this,void 0,void 0,function*(){try{return{data:yield pr(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dr(r))return{data:null,error:r};throw r}})}listVectors(e){return pe(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield pr(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dr(r))return{data:null,error:r};throw r}})}queryVectors(e){return pe(this,void 0,void 0,function*(){try{return{data:yield pr(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dr(r))return{data:null,error:r};throw r}})}deleteVectors(e){return pe(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield pr(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dr(r))return{data:null,error:r};throw r}})}}class iN{constructor(e,r={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},np),r),this.fetch=ip(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:(yield pr(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dr(r))return{data:null,error:r};throw r}})}getBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:yield pr(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dr(r))return{data:null,error:r};throw r}})}listBuckets(){return pe(this,arguments,void 0,function*(e={}){try{return{data:yield pr(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dr(r))return{data:null,error:r};throw r}})}deleteBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:(yield pr(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(dr(r))return{data:null,error:r};throw r}})}}class sN extends iN{constructor(e,r={}){super(e,r.headers||{},r.fetch)}from(e){return new aN(this.url,this.headers,e,this.fetch)}}class aN extends rN{constructor(e,r,n,i){super(e,r,i),this.vectorBucketName=n}createIndex(e){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return pe(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return pe(this,arguments,void 0,function*(r={}){return e.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return pe(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return pe(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new oN(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class oN extends nN{constructor(e,r,n,i,s){super(e,r,s),this.vectorBucketName=n,this.indexName=i}putVectors(e){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return pe(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return pe(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return pe(this,arguments,void 0,function*(r={}){return e.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return pe(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return pe(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class lN extends XD{constructor(e,r={},n,i){super(e,r,n,i)}from(e){return new YD(this.url,this.headers,e,this.fetch)}get vectors(){return new sN(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new qD(this.url+"/iceberg",this.headers,this.fetch)}}const uN="2.81.1";let Ga="";typeof Deno<"u"?Ga="deno":typeof document<"u"?Ga="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ga="react-native":Ga="node";const cN={"X-Client-Info":`supabase-js-${Ga}/${uN}`},hN={headers:cN},fN={schema:"public"},dN={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},pN={},gN=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),mN=()=>Headers,vN=(t,e,r)=>{const n=gN(r),i=mN();return async(s,a)=>{var o;const l=(o=await e())!==null&&o!==void 0?o:t;let u=new i(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},a),{headers:u}))}};function xN(t){return t.endsWith("/")?t:t+"/"}function _N(t,e){var r,n;const{db:i,auth:s,realtime:a,global:o}=t,{db:l,auth:u,realtime:c,global:h}=e,f={db:Object.assign(Object.assign({},l),i),auth:Object.assign(Object.assign({},u),s),realtime:Object.assign(Object.assign({},c),a),storage:{},global:Object.assign(Object.assign(Object.assign({},h),o),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function yN(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(xN(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const k2="2.81.1",Es=30*1e3,md=3,Xh=md*Es,wN="http://localhost:9999",SN="supabase.auth.token",EN={"X-Client-Info":`gotrue-js/${k2}`},vd="X-Supabase-Api-Version",b2={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},TN=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,kN=10*60*1e3;class Go extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function ge(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class bN extends Go{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function AN(t){return ge(t)&&t.name==="AuthApiError"}class ji extends Go{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Si extends Go{constructor(e,r,n,i){super(e,n,i),this.name=r,this.status=n}}class $r extends Si{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ON(t){return ge(t)&&t.name==="AuthSessionMissingError"}class vs extends Si{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Zl extends Si{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class eu extends Si{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function CN(t){return ge(t)&&t.name==="AuthImplicitGrantRedirectError"}class M1 extends Si{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class xd extends Si{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function qh(t){return ge(t)&&t.name==="AuthRetryableFetchError"}class B1 extends Si{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class _d extends Si{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const pc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),j1=` 	
\r=`.split(""),PN=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<j1.length;e+=1)t[j1[e].charCodeAt(0)]=-2;for(let e=0;e<pc.length;e+=1)t[pc[e].charCodeAt(0)]=e;return t})();function U1(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(pc[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(pc[n]),e.queuedBits-=6}}function A2(t,e,r){const n=PN[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function $1(t){const e=[],r=a=>{e.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{IN(a,n,r)};for(let a=0;a<t.length;a+=1)A2(t.charCodeAt(a),i,s);return e.join("")}function RN(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function FN(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}RN(n,e)}}function IN(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if(!(t>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Js(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)A2(t.charCodeAt(i),r,n);return new Uint8Array(e)}function DN(t){const e=[];return FN(t,r=>e.push(r)),new Uint8Array(e)}function Hi(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};return t.forEach(i=>U1(i,r,n)),U1(null,r,n),e.join("")}function NN(t){return Math.round(Date.now()/1e3)+t}function LN(){return Symbol("auth-callback")}const Tt=()=>typeof window<"u"&&typeof document<"u",Pi={tested:!1,writable:!1},O2=()=>{if(!Tt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Pi.tested)return Pi.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Pi.tested=!0,Pi.writable=!0}catch{Pi.tested=!0,Pi.writable=!1}return Pi.writable};function MN(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{e[i]=n}),e}const C2=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),BN=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Ts=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Ri=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Un=async(t,e)=>{await t.removeItem(e)};class Gc{constructor(){this.promise=new Gc.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Gc.promiseConstructor=Promise;function Jh(t){const e=t.split(".");if(e.length!==3)throw new _d("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!TN.test(e[n]))throw new _d("JWT not in base64url format");return{header:JSON.parse($1(e[0])),payload:JSON.parse($1(e[1])),signature:Js(e[2]),raw:{header:e[0],payload:e[1]}}}async function jN(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function UN(t,e){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await t(s);if(!e(s,null,a)){n(a);return}}catch(a){if(!e(s,a)){i(a);return}}})()})}function $N(t){return("0"+t.toString(16)).substr(-2)}function zN(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,$N).join("")}async function WN(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function HN(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await WN(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function xs(t,e,r=!1){const n=zN();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Ts(t,`${e}-code-verifier`,i);const s=await HN(n);return[s,n===s?"plain":"s256"]}const VN=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function GN(t){const e=t.headers.get(vd);if(!e||!e.match(VN))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function KN(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function YN(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const XN=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function _s(t){if(!XN.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Qh(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function qN(t,e){return new Proxy(t,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,n,i)}})}function z1(t){return JSON.parse(JSON.stringify(t))}const Ni=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),JN=[502,503,504];async function W1(t){var e;if(!BN(t))throw new xd(Ni(t),0);if(JN.includes(t.status))throw new xd(Ni(t),t.status);let r;try{r=await t.json()}catch(s){throw new ji(Ni(s),s)}let n;const i=GN(t);if(i&&i.getTime()>=b2["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new B1(Ni(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new $r}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new B1(Ni(r),t.status,r.weak_password.reasons);throw new bN(Ni(r),t.status||500,n)}const QN=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function me(t,e,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[vd]||(s[vd]=b2["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const a=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await ZN(t,e,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function ZN(t,e,r,n,i,s){const a=QN(e,n,i,s);let o;try{o=await t(r,Object.assign({},a))}catch(l){throw console.error(l),new xd(Ni(l),0)}if(o.ok||await W1(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await W1(l)}}function zr(t){var e;let r=null;r8(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=NN(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function H1(t){const e=zr(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Gn(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function e8(t){return{data:t,error:null}}function t8(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=t,a=xa(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function V1(t){return t}function r8(t){return t.access_token&&t.refresh_token&&t.expires_in}const Zh=["global","local","others"];class n8{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=C2(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=Zh[0]){if(Zh.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Zh.join(", ")}`);try{return await me(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ge(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await me(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Gn})}catch(n){if(ge(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=xa(e,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:t8,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(ge(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await me(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Gn})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,i,s,a,o,l;try{const u={nextPage:null,lastPage:0,total:0},c=await me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:V1});if(c.error)throw c.error;const h=await c.json(),f=(a=c.headers.get("x-total-count"))!==null&&a!==void 0?a:0,d=(l=(o=c.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(g=>{const p=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(g.split(";")[1].split("=")[1]);u[`${m}Page`]=p}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(ge(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){_s(e);try{return await me(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Gn})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){_s(e);try{return await me(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Gn})}catch(n){if(ge(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){_s(e);try{return await me(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Gn})}catch(n){if(ge(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){_s(e.userId);try{const{data:r,error:n}=await me(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _deleteFactor(e){_s(e.userId),_s(e.id);try{return{data:await me(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,n,i,s,a,o,l;try{const u={nextPage:null,lastPage:0,total:0},c=await me(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:V1});if(c.error)throw c.error;const h=await c.json(),f=(a=c.headers.get("x-total-count"))!==null&&a!==void 0?a:0,d=(l=(o=c.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(g=>{const p=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(g.split(";")[1].split("=")[1]);u[`${m}Page`]=p}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(ge(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(e){try{return await me(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await me(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await me(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ge(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await me(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await me(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}}function G1(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const ys={debug:!!(globalThis&&O2()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class P2 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class i8 extends P2{}async function s8(t,e,r){ys.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),ys.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){ys.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await r()}finally{ys.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw ys.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new i8(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(ys.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function a8(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function R2(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function o8(t){return parseInt(t,16)}function l8(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function u8(t){var e;const{chainId:r,domain:n,expirationTime:i,issuedAt:s=new Date,nonce:a,notBefore:o,requestId:l,resources:u,scheme:c,uri:h,version:f}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const d=R2(t.address),g=c?`${c}://${n}`:n,p=t.statement?`${t.statement}
`:"",m=`${g} wants you to sign in with your Ethereum account:
${d}

${p}`;let v=`URI: ${h}
Version: ${f}
Chain ID: ${r}${a?`
Nonce: ${a}`:""}
Issued At: ${s.toISOString()}`;if(i&&(v+=`
Expiration Time: ${i.toISOString()}`),o&&(v+=`
Not Before: ${o.toISOString()}`),l&&(v+=`
Request ID: ${l}`),u){let x=`
Resources:`;for(const _ of u){if(!_||typeof _!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${_}`);x+=`
- ${_}`}v+=x}return`${m}
${v}`}class lt extends Error{constructor({message:e,code:r,cause:n,name:i}){var s;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=i??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class gc extends lt{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function c8({error:t,options:e}){var r,n,i;const{publicKey:s}=e;if(!s)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new lt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new lt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new lt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new lt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new lt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new lt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return s.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new lt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new lt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const a=window.location.hostname;if(F2(a)){if(s.rp.id!==a)return new lt({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new lt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new lt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new lt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new lt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function h8({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new lt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new lt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const n=window.location.hostname;if(F2(n)){if(r.rpId!==n)return new lt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new lt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new lt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new lt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class f8{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const d8=new f8;function p8(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:n}=t,i=xa(t,["challenge","user","excludeCredentials"]),s=Js(e).buffer,a=Object.assign(Object.assign({},r),{id:Js(r.id).buffer}),o=Object.assign(Object.assign({},i),{challenge:s,user:a});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const u=n[l];o.excludeCredentials[l]=Object.assign(Object.assign({},u),{id:Js(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return o}function g8(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,n=xa(t,["challenge","allowCredentials"]),i=Js(e).buffer,s=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let a=0;a<r.length;a++){const o=r[a];s.allowCredentials[a]=Object.assign(Object.assign({},o),{id:Js(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return s}function m8(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:Hi(new Uint8Array(t.response.attestationObject)),clientDataJSON:Hi(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function v8(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,n=t.getClientExtensionResults(),i=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Hi(new Uint8Array(i.authenticatorData)),clientDataJSON:Hi(new Uint8Array(i.clientDataJSON)),signature:Hi(new Uint8Array(i.signature)),userHandle:i.userHandle?Hi(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function F2(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function K1(){var t,e;return!!(Tt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function x8(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new gc("Browser returned unexpected credential type",e)}:{data:null,error:new gc("Empty credential response",e)}}catch(e){return{data:null,error:c8({error:e,options:t})}}}async function _8(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new gc("Browser returned unexpected credential type",e)}:{data:null,error:new gc("Empty credential response",e)}}catch(e){return{data:null,error:h8({error:e,options:t})}}}const y8={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},w8={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function mc(...t){const e=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of t)if(i)for(const s in i){const a=i[s];if(a!==void 0)if(Array.isArray(a))n[s]=a;else if(r(a))n[s]=a;else if(e(a)){const o=n[s];e(o)?n[s]=mc(o,a):n[s]=mc(a)}else n[s]=a}return n}function S8(t,e){return mc(y8,t,e||{})}function E8(t,e){return mc(w8,t,e||{})}class T8{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:n,signal:i},s){try{const{data:a,error:o}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!a)return{data:null,error:o};const l=i??d8.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:u}=a.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${n}`),u.displayName||(u.displayName=u.name)}switch(a.webauthn.type){case"create":{const u=S8(a.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:c,error:h}=await x8({publicKey:u,signal:l});return c?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:c}},error:null}:{data:null,error:h}}case"request":{const u=E8(a.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:c,error:h}=await _8(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:u,signal:l}));return c?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:c}},error:null}:{data:null,error:h}}}}catch(a){return ge(a)?{data:null,error:a}:{data:null,error:new ji("Unexpected error in challenge",a)}}}async _verify({challengeId:e,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new Go("rpId is required for WebAuthn authentication")};try{if(!K1())return{data:null,error:new ji("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:s});if(!a)return{data:null,error:o};const{webauthn:l}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:n,credential_response:l.credential_response}})}catch(a){return ge(a)?{data:null,error:a}:{data:null,error:new ji("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new Go("rpId is required for WebAuthn registration")};try{if(!K1())return{data:null,error:new ji("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(c=>{var h;return(h=c.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(c=>c?this.client.mfa.unenroll({factorId:c==null?void 0:c.id}):void 0),{data:null,error:o};const{data:l,error:u}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:s});return l?this._verify({factorId:a.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:u}}catch(a){return ge(a)?{data:null,error:a}:{data:null,error:new ji("Unexpected error in register",a)}}}}a8();const k8={url:wN,storageKey:SN,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:EN,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Y1(t,e,r){return await r()}const ws={};class Ko{get jwks(){var e,r;return(r=(e=ws[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){ws[this.storageKey]=Object.assign(Object.assign({},ws[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=ws[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){ws[this.storageKey]=Object.assign(Object.assign({},ws[this.storageKey]),{cachedAt:e})}constructor(e){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},k8),e);if(this.storageKey=s.storageKey,this.instanceID=(r=Ko.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Ko.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&Tt()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new n8({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=C2(s.fetch),this.lock=s.lock||Y1,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,s.lock?this.lock=s.lock:Tt()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=s8:this.lock=Y1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new T8(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:O2()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=G1(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=G1(this.memoryStorage)),Tt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${k2}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},n="none";if(Tt()&&(r=MN(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),Tt()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),CN(s)){const l=(e=s.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ge(r)?this._returnResult({error:r}):this._returnResult({error:new ji("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,i;try{const s=await me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:zr}),{data:a,error:o}=s;if(o||!a)return this._returnResult({data:{user:null,session:null},error:o});const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(s){if(ge(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(e){var r,n,i;try{let s;if("email"in e){const{email:c,password:h,options:f}=e;let d=null,g=null;this.flowType==="pkce"&&([d,g]=await xs(this.storage,this.storageKey)),s=await me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:c,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:d,code_challenge_method:g},xform:zr})}else if("phone"in e){const{phone:c,password:h,options:f}=e;s=await me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(i=f==null?void 0:f.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:zr})}else throw new Zl("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return this._returnResult({data:{user:null,session:null},error:o});const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(s){if(ge(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(e){try{let r;if("email"in e){const{email:s,password:a,options:o}=e;r=await me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:H1})}else if("phone"in e){const{phone:s,password:a,options:o}=e;r=await me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:H1})}else throw new Zl("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const s=new vs;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(ge(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,n,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,n,i,s,a,o,l,u,c,h,f;let d,g;if("message"in e)d=e.message,g=e.signature;else{const{chain:p,wallet:m,statement:v,options:x}=e;let _;if(Tt())if(typeof m=="object")_=m;else{const F=window;if("ethereum"in F&&typeof F.ethereum=="object"&&"request"in F.ethereum&&typeof F.ethereum.request=="function")_=F.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof m!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=m}const w=new URL((r=x==null?void 0:x.url)!==null&&r!==void 0?r:window.location.href),O=await _.request({method:"eth_requestAccounts"}).then(F=>F).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!O||O.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const R=R2(O[0]);let T=(n=x==null?void 0:x.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!T){const F=await _.request({method:"eth_chainId"});T=o8(F)}const P={domain:w.host,address:R,statement:v,uri:w.href,version:"1",chainId:T,nonce:(i=x==null?void 0:x.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(a=(s=x==null?void 0:x.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(o=x==null?void 0:x.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=x==null?void 0:x.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(u=x==null?void 0:x.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(c=x==null?void 0:x.signInWithEthereum)===null||c===void 0?void 0:c.resources};d=u8(P),g=await _.request({method:"personal_sign",params:[l8(d),R]})}try{const{data:p,error:m}=await me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:d,signature:g},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:zr});if(m)throw m;if(!p||!p.session||!p.user){const v=new vs;return this._returnResult({data:{user:null,session:null},error:v})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:Object.assign({},p),error:m})}catch(p){if(ge(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async signInWithSolana(e){var r,n,i,s,a,o,l,u,c,h,f,d;let g,p;if("message"in e)g=e.message,p=e.signature;else{const{chain:m,wallet:v,statement:x,options:_}=e;let w;if(Tt())if(typeof v=="object")w=v;else{const R=window;if("solana"in R&&typeof R.solana=="object"&&("signIn"in R.solana&&typeof R.solana.signIn=="function"||"signMessage"in R.solana&&typeof R.solana.signMessage=="function"))w=R.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=v}const O=new URL((r=_==null?void 0:_.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in w&&w.signIn){const R=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_==null?void 0:_.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),x?{statement:x}:null));let T;if(Array.isArray(R)&&R[0]&&typeof R[0]=="object")T=R[0];else if(R&&typeof R=="object"&&"signedMessage"in R&&"signature"in R)T=R;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)g=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),p=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${O.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...x?["",x,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(i=(n=_==null?void 0:_.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=_==null?void 0:_.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((a=_==null?void 0:_.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((o=_==null?void 0:_.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((l=_==null?void 0:_.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((u=_==null?void 0:_.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((h=(c=_==null?void 0:_.signInWithSolana)===null||c===void 0?void 0:c.resources)===null||h===void 0)&&h.length?["Resources",..._.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const R=await w.signMessage(new TextEncoder().encode(g),"utf8");if(!R||!(R instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=R}}try{const{data:m,error:v}=await me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:Hi(p)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(d=e.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:zr});if(v)throw v;if(!m||!m.session||!m.user){const x=new vs;return this._returnResult({data:{user:null,session:null},error:x})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:v})}catch(m){if(ge(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async _exchangeCodeForSession(e){const r=await Ri(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:s,error:a}=await me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:zr});if(await Un(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!s||!s.session||!s.user){const o=new vs;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(ge(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(e){try{const{options:r,provider:n,token:i,access_token:s,nonce:a}=e,o=await me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:zr}),{data:l,error:u}=o;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const c=new vs;return this._returnResult({data:{user:null,session:null},error:c})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:u})}catch(r){if(ge(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,n,i,s,a;try{if("email"in e){const{email:o,options:l}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await xs(this.storage,this.storageKey));const{error:h}=await me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:o,options:l}=e,{data:u,error:c}=await me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c})}throw new Zl("You must provide either an email or phone number.")}catch(o){if(ge(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(e){var r,n;try{let i,s;"options"in e&&(i=(r=e.options)===null||r===void 0?void 0:r.redirectTo,s=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:zr});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,u=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(i){if(ge(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(e){var r,n,i,s,a;try{let o=null,l=null;this.flowType==="pkce"&&([o,l]=await xs(this.storage,this.storageKey));const u=await me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:e8});return!((s=u.data)===null||s===void 0)&&s.url&&Tt()&&!(!((a=e.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(o){if(ge(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new $r;const{error:i}=await me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(e){if(ge(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:s}=e,{error:a}=await me(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in e){const{phone:n,type:i,options:s}=e,{data:a,error:o}=await me(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o})}throw new Zl("You must provide either an email or phone number and a type")}catch(r){if(ge(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Ri(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Xh:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const a=await Ri(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=Qh()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};e.user=qN(e.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Gn}):await this._useSession(async r=>{var n,i,s;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new $r}:await me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:Gn})})}catch(r){if(ge(r))return ON(r)&&(await this._removeSession(),await Un(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new $r;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await xs(this.storage,this.storageKey));const{data:u,error:c}=await me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:Gn});if(c)throw c;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(n){if(ge(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new $r;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:a}=Jh(e.access_token);if(a.exp&&(n=a.exp,i=n<=r),i){const{data:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(ge(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:a,error:o}=r;if(o)throw o;e=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new $r;const{data:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(ge(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!Tt())throw new eu("No browser detected.");if(e.error||e.error_description||e.error_code)throw new eu(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new M1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new eu("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new M1("No code detected.");const{data:x,error:_}=await this._exchangeCodeForSession(e.code);if(_)throw _;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:u}=e;if(!s||!o||!a||!u)throw new eu("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(o);let f=c+h;l&&(f=parseInt(l));const d=f-c;d*1e3<=Es&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${h}s`);const g=f-h;c-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,f,c):c-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,f,c);const{data:p,error:m}=await this._getUser(s);if(m)throw m;const v={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:h,expires_at:f,refresh_token:a,token_type:u,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:v,redirectType:e.type},error:null})}catch(n){if(ge(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Ri(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({error:s});const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(AN(o)&&(o.status===404||o.status===401||o.status===403)))return this._returnResult({error:o})}return e!=="others"&&(await this._removeSession(),await Un(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=LN(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await xs(this.storage,this.storageKey,!0));try{return await me(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(ge(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(ge(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var a,o,l,u,c;const{data:h,error:f}=s;if(f)throw f;const d=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await me(this.fetch,"GET",d,{headers:this.headers,jwt:(c=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(i)throw i;return Tt()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:e.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(ge(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:s}}=r;if(i)throw i;const{options:a,provider:o,token:l,access_token:u,nonce:c}=e,h=await me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s==null?void 0:s.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:l,access_token:u,nonce:c,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:zr}),{data:f,error:d}=h;return d?this._returnResult({data:{user:null,session:null},error:d}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new vs}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:d}))}catch(i){if(ge(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)throw a;return await me(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(ge(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await UN(async i=>(i>0&&await jN(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:zr})),(i,s)=>{const a=200*Math.pow(2,i);return s&&qh(s)&&Date.now()+a-n<Es})}catch(n){if(this._debug(r,"error",n),ge(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),Tt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await Ri(this.storage,this.storageKey);if(i&&this.userStorage){let a=await Ri(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await Ts(this.userStorage,this.storageKey+"-user",a)),i.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:Qh()}else if(i&&!i.user&&!i.user){const a=await Ri(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(i.user=a.user,await Un(this.storage,this.storageKey+"-user"),await Ts(this.storage,this.storageKey,i)):i.user=Qh()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Xh;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Xh}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),qh(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(i.access_token);!o&&(a!=null&&a.user)?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new $r;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Gc;const{data:s,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!s.session)throw new $r;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={data:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),ge(s)){const a={data:null,error:s};return qh(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,r,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,r)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Ts(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=z1(i);await Ts(this.storage,this.storageKey,s)}else{const i=z1(r);await Ts(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Un(this.storage,this.storageKey),await Un(this.storage,this.storageKey+"-code-verifier"),await Un(this.storage,this.storageKey+"-user"),this.userStorage&&await Un(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Tt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Es);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/Es);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Es}ms, refresh threshold is ${md} ticks`),i<=md&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof P2)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Tt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,a]=await xs(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?this._returnResult({data:null,error:s}):await me(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(ge(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:u}=await me(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(e.factorType==="totp"&&l.type==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(ge(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?m8(e.webauthn.credential_response):v8(e.webauthn.credential_response)})}:{code:e.code}),{data:o,error:l}=await me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(r){if(ge(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const a=await me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(a.error)return a;const{data:o}=a;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:p8(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:g8(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(ge(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(e=r==null?void 0:r.factors)!==null&&e!==void 0?e:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:n},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=Jh(n.access_token);let a=null;s.aal&&(a=s.aal);let o=a;((r=(e=n.user.factors)===null||e===void 0?void 0:e.filter(c=>c.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(o="aal2");const u=s.amr||[];return{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await me(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new $r})})}catch(r){if(ge(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new $r});const a=await me(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&Tt()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(n){if(ge(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new $r});const a=await me(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&Tt()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(n){if(ge(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(o=>o.kid===e);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(o=>o.kid===e),n&&this.jwks_cached_at+kN>i)return n;const{data:s,error:a}=await me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(o=>o.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:d,error:g}=await this.getSession();if(g||!d.session)return this._returnResult({data:null,error:g});n=d.session.access_token}const{header:i,payload:s,signature:a,raw:{header:o,payload:l}}=Jh(n);r!=null&&r.allowExpired||KN(s.exp);const u=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:d}=await this.getUser(n);if(d)throw d;return{data:{claims:s,header:i,signature:a},error:null}}const c=YN(i.alg),h=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,a,DN(`${o}.${l}`)))throw new _d("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(n){if(ge(n))return this._returnResult({data:null,error:n});throw n}}}Ko.nextInstanceID={};const b8=Ko;class A8 extends b8{constructor(e){super(e)}}class O8{constructor(e,r,n){var i,s,a;this.supabaseUrl=e,this.supabaseKey=r;const o=yN(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,u={db:fN,realtime:pN,auth:Object.assign(Object.assign({},dN),{storageKey:l}),global:hN},c=_N(n??{},u);this.storageKey=(i=c.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=c.global.headers)!==null&&s!==void 0?s:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=c.auth)!==null&&a!==void 0?a:{},this.headers,c.global.fetch),this.fetch=vN(r,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&this.accessToken().then(h=>this.realtime.setAuth(h)).catch(h=>console.warn("Failed to set initial Realtime auth token:",h)),this.rest=new wD(new URL("rest/v1",o).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new lN(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new xD(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,r;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:s,storageKey:a,flowType:o,lock:l,debug:u,throwOnError:c},h,f){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new A8({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),h),storageKey:a,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:s,flowType:o,lock:l,debug:u,throwOnError:c,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new BD(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const C8=(t,e,r)=>new O8(t,e,r);function P8(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}P8()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const R8="https://tbbeyrttutcdwdqxqasz.supabase.co",F8="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRiYmV5cnR0dXRjZHdkcXhxYXN6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI4NTkwNDMsImV4cCI6MjA3ODQzNTA0M30.MST-_7L-hxIJdjciS38qls_4P3oXwvcTHGK4TcfukQI",Er=C8(R8,F8),X1=["Students","Subjects","Ratings","Dashboard","Export"],tu=new Date().getFullYear(),I8=()=>{const[t,e]=Ue.useState(X1[0]),[r,n]=Ue.useState([]),[i,s]=Ue.useState([]),[a,o]=Ue.useState([]),[l,u]=Ue.useState(tu),[c,h]=Ue.useState(Yf[0]),[f,d]=Ue.useState(!0),[g,p]=Ue.useState(!1),[m,v]=Ue.useState(null),x=Ue.useRef();Ue.useEffect(()=>(T(),()=>window.clearTimeout(x.current)),[]);const _=Ue.useCallback((Y,q="info")=>{window.clearTimeout(x.current),v({text:Y,type:q}),x.current=window.setTimeout(()=>v(null),4e3)},[]),w=Ue.useCallback(async()=>{const{data:Y,error:q}=await Er.from("students").select("*").order("name");if(q)throw q;return n(Y??[]),Y??[]},[]),O=Ue.useCallback(async()=>{const{data:Y,error:q}=await Er.from("subjects").select("*").order("name");if(q)throw q;return s(Y??[]),Y??[]},[]),R=Ue.useCallback(async()=>{const{data:Y,error:q}=await Er.from("ratings").select("*").order("year",{ascending:!1}).order("term",{ascending:!1});if(q)throw q;return o(Y??[]),Y??[]},[]),T=Ue.useCallback(async()=>{d(!0);try{await Promise.all([w(),O(),R()])}catch(Y){_(`Failed to fetch data: ${Y.message}`,"error")}finally{d(!1)}},[_,R,w,O]),P=async Y=>{p(!0);try{await Er.from("students").insert({name:Y}),await w(),_(`Added student "${Y}".`,"success")}catch(q){_(`Unable to add student: ${q.message}`,"error")}finally{p(!1)}},F=async Y=>{p(!0);try{await Er.from("students").delete().eq("id",Y),await Promise.all([w(),R()]),_("Student removed.","success")}catch(q){_(`Unable to delete student: ${q.message}`,"error")}finally{p(!1)}},N=async Y=>{if(i.some(q=>q.name.toLowerCase()===Y.toLowerCase())){_("Subject already exists.","error");return}p(!0);try{await Er.from("subjects").insert({name:Y}),await O(),_(`Added subject "${Y}".`,"success")}catch(q){_(`Unable to add subject: ${q.message}`,"error")}finally{p(!1)}},U=async Y=>{p(!0);try{await Er.from("subjects").delete().eq("id",Y),await Promise.all([O(),R()]),_("Subject removed.","success")}catch(q){_(`Unable to delete subject: ${q.message}`,"error")}finally{p(!1)}},H=async(Y,q,he)=>{const xe=Number(l);if(!Number.isFinite(xe)){_("Set a valid year before updating ratings.","error");return}p(!0);try{he?await Er.from("ratings").upsert({student_id:Y,subject_id:q,year:xe,term:c,level:he},{onConflict:"student_id,subject_id,year,term"}):await Er.from("ratings").delete().eq("student_id",Y).eq("subject_id",q).eq("year",xe).eq("term",c),await R()}catch(C){_(`Unable to update rating: ${C.message}`,"error")}finally{p(!1)}},Z=async()=>{p(!0);try{const Y=["Ada Lovelace","Alan Turing","Grace Hopper","Mary Jackson","Katherine Johnson","Edsger Dijkstra"],q=["Mathematics","Science","History","Art","Literature","Technology"],he=new Set(r.map(ae=>ae.name.toLowerCase())),xe=Y.filter(ae=>!he.has(ae.toLowerCase())).map(ae=>({name:ae}));xe.length&&await Er.from("students").insert(xe),await w();const C=await w(),L=new Set(i.map(ae=>ae.name.toLowerCase())),I=q.filter(ae=>!L.has(ae.toLowerCase())).map(ae=>({name:ae}));I.length&&await Er.from("subjects").insert(I),await O();const D=await O();if(C.length===0||D.length===0){_("Need at least one student and subject to seed ratings.","error");return}const G=[tu-1,tu],le=[];C.forEach((ae,fe)=>{D.forEach((ie,Fe)=>{G.forEach((Te,St)=>{Yf.forEach((Ae,Mr)=>{const Ye=(fe+Fe+St+Mr)%Kr.length;le.push({student_id:ae.id,subject_id:ie.id,year:Te,term:Ae,level:Kr[Ye]})})})})}),await Er.from("ratings").upsert(le,{onConflict:"student_id,subject_id,year,term"}),await R(),_("Demo data seeded.","success")}catch(Y){_(`Unable to seed demo data: ${Y.message}`,"error")}finally{p(!1)}},ve=Ue.useMemo(()=>p0(a,{year:l,term:c}),[a,l,c]),oe=Ue.useMemo(()=>{const Y=new Map;return ve.forEach(q=>{Y.set(`${q.student_id}-${q.subject_id}`,q.level)}),Y},[ve]),we=Ue.useMemo(()=>{const Y=CT(a);return Y.length===0?[tu]:Y.includes(l)?Y:[...Y,l].sort((q,he)=>q-he)},[a,l]),_e=g||f;return z.jsxs("div",{className:"app",children:[z.jsxs("header",{className:"app__header",children:[z.jsxs("div",{children:[z.jsx("h1",{children:"Class Progress Tracker"}),z.jsx("p",{children:"Minimal React + Supabase app for managing students, subjects, and twice-yearly ratings."})]}),z.jsxs("div",{className:"actions",children:[z.jsx("button",{type:"button",className:"button--ghost",onClick:T,disabled:_e,children:"Refresh all"}),z.jsx("button",{type:"button",onClick:Z,disabled:_e,children:"Seed demo data"})]})]}),z.jsx(bT,{tabs:X1,activeTab:t,onSelect:e}),m&&z.jsxs("div",{className:`alert alert--${m.type}`,children:[z.jsx("span",{children:m.text}),z.jsx("button",{type:"button",onClick:()=>v(null),"aria-label":"Dismiss message",children:""})]}),f&&z.jsx("div",{className:"helper-text",children:"Loading data from Supabase"}),t==="Students"&&z.jsx(AT,{students:r,onAdd:P,onDelete:F,busy:_e}),t==="Subjects"&&z.jsx(OT,{subjects:i,onAdd:N,onDelete:U,busy:_e}),t==="Ratings"&&z.jsxs(z.Fragment,{children:[z.jsx(IT,{year:l,term:c,onYearChange:u,onTermChange:h,onRefresh:T,availableYears:we,busy:_e}),z.jsx(DT,{students:r,subjects:i,ratingLookup:oe,onChange:H,year:l,term:c,busy:_e,filteredRatings:ve})]}),t==="Dashboard"&&z.jsx(EO,{students:r,subjects:i,ratings:a,year:l,term:c}),t==="Export"&&z.jsx(hD,{filteredRatings:ve,allRatings:a,students:r,subjects:i,year:l,term:c,busy:_e})]})};ef.createRoot(document.getElementById("root")).render(z.jsx(Ue.StrictMode,{children:z.jsx(I8,{})}));
